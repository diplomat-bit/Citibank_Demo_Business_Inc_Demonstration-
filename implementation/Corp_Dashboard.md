
# Engineering Vision Specification: Corp Dashboard

## 1. Core Philosophy: "The View From the Throne"

This is the command center for the entire enterprise. Its purpose is to provide a high-level, strategic overview of the organization's financial health and operational tempo. It surfaces the most critical information requiring the sovereign's attention, with an AI Vizier to provide a concise summary of the state of the kingdom.

## 2. Key Features & Functionality

*   **KPI Stat Cards:** At-a-glance metrics for critical items like pending approvals, overdue invoices, and new anomalies.
*   **AI Controller Summary:** A single, concise strategic recommendation or observation generated by the AI based on all the dashboard data.
*   **Spending Analysis:** A chart visualizing corporate spending by category.
*   **Recent Transaction Feed:** A live-updating list of the most recent corporate card transactions.
*   **Integration Codex:** An embedded component revealing the APIs and integrations powering the corporate suite.

## 3. AI Integration (Gemini API)

*   **AI Controller Summary:** On view load, the system compiles a text summary of all the key metrics on the dashboard (e.g., "Pending Approvals: 5, Overdue Invoices: 2, New Anomalies: 1"). This summary is sent to `gemini-2.5-flash` with a prompt instructing it to act as a corporate finance AI controller and provide a single, strategic recommendation. This transforms raw numbers into actionable intelligence.

## 4. Primary Data Models

*   **`PaymentOrder`:** Used to calculate pending approvals.
*   **`Invoice`:** Used to calculate overdue invoices.
*   **`CorporateTransaction`:** Used for the transaction feed and spending chart.
*   **`FinancialAnomaly`:** Used for the new anomalies count.

## 5. Technical Architecture

*   **Frontend:**
    *   **Component:** `CorporateDashboardView.tsx`
    *   **State Management:** Consumes multiple data types from `DataContext`. Uses `useMemo` extensively to calculate the summary statistics efficiently.
    *   **Key Libraries:** `recharts` for the spending chart.
*   **Backend:**
    *   **Primary Service:** `corporate-aggregator-api`
    *   **Key Endpoints:**
        *   `GET /api/corporate/dashboard`: An endpoint that gathers all necessary data from the underlying microservices (`payments-api`, `invoices-api`, etc.) to populate the dashboard in a single call.
