openapi: 3.0.0
info:
  title: System and Method for Automated Semantically-Aligned Pervasive Marketing Asset Synthesis and Optimization API
  description: |
    A comprehensive RESTful API for the autonomous generation, iterative refinement, and optimization of sophisticated marketing and advertising copy. This API facilitates the seamless integration of AI-driven content synthesis capabilities into external marketing platforms, CRM systems, and content management solutions, redefining the paradigm of marketing content creation with unparalleled precision and adaptive intelligence.

    **Key Claims (10 of 10):**
    1.  **Hyper-Precision Targeting:** Our advanced algorithms ensure every generated copy variant is meticulously aligned with specified product attributes and granular prompt directives, achieving unparalleled relevance.
    2.  **Adaptive Learning Loop:** The integrated feedback mechanism establishes a continuous reinforcement learning cycle, constantly refining generative models based on real-world performance metrics.
    3.  **Scalable Content Velocity:** Dramatically accelerates the content creation workflow, enabling marketing teams to deploy campaigns with unprecedented speed and efficiency across diverse channels.
    4.  **Semantic Nuance Capture:** Beyond keywords, the system comprehends and synthesizes deep semantic meaning, reflecting brand voice and emotional tone with sophisticated accuracy.
    5.  **Bias Mitigation Framework:** Proactively identifies and reduces unintended biases in generated content, promoting inclusive and ethical marketing communications.
    6.  **Multimodal Integration Mastery:** Seamlessly incorporates diverse input modalities (images, video, audio) to enrich semantic context and generate visually-aligned copy.
    7.  **Real-time Contextual Adaptability:** Dynamically adjusts copy generation based on live market trends, seasonal shifts, and competitive intelligence, ensuring optimal timeliness.
    8.  **Explainable AI for Marketing:** Provides transparent insights into the generative process, empowering marketers to understand *why* certain copy variants were produced and iterate effectively.
    9.  **Decoupled Optimization Strategies:** Allows for the definition and application of diverse, measurable optimization goals, from CTR maximization to bounce rate minimization.
    10. **Enterprise-Grade Security & Auditability:** Built with robust security protocols and comprehensive audit trails to ensure data integrity, compliance, and operational transparency.

    **Core System Architecture Overview (Mermaid Diagram 1 of 10):**
    ```mermaid
    graph TD
        A[External Marketing Platform] --> B(API Gateway);
        B --> C{Authentication & Rate Limiting};
        C --> D[Copy Generation Service];
        C --> E[Feedback & Optimization Service];
        C --> F[Configuration & Management Service];
        D --> G[Generative AI Core];
        D --> H[Prompt Engineering Module];
        E --> I[Feedback Loop Processor];
        E --> J[Reinforcement Learning Agent];
        F --> K[Brand Voice Repository];
        G --> M(Output: Copy Variants);
        H --> G;
        I --> J;
        J --> H;
        K --> H;
        B -- Webhooks --> A;
        subgraph Data Stores
            L[Product Knowledge Base] --> H;
            N[Performance Metrics DB] --> I;
            O[Model Weights Storage] --> J;
        end
    ```
  version: 1.0.0
servers:
  - url: https://api.aimarketingcore.com/v1
    description: Production server for AI Marketing Copy Generation System API
  - url: https://api.staging.aimarketingcore.com/v1
    description: Staging environment for development and testing

security:
  - ApiKeyAuth: []

tags:
  - name: Copy Generation
    description: Operations related to generating marketing and advertising copy.
  - name: Feedback and Optimization
    description: Endpoints for submitting user feedback and performance metrics to drive adaptive learning and system optimization.
  - name: System Configuration
    description: Management of system-wide configurations such as brand voices, semantic graphs, and explainability settings.
  - name: Analytics and Reporting
    description: Access to aggregated performance data, detailed analytics reports, and A/B testing results.
  - name: AI Model Management
    description: Operations for monitoring and fine-tuning the underlying generative AI models.
  - name: Audit and Compliance
    description: Endpoints for retrieving system audit logs and ensuring operational transparency.

paths:
  /generate-copy:
    post:
      summary: Generate AI-synthesized marketing copy
      operationId: generateMarketingCopy
      tags:
        - Copy Generation
      description: |
        Initiates the core process of generating a diverse plurality of marketing assets based on a granular product description and meticulously engineered prompt directives. This endpoint empowers users to rapidly synthesize high-fidelity, strategically aligned creative options. The generative process involves complex interplay between various AI modules, governed by an overarching utility maximization function to ensure optimal output.

        **Generative Process Flow (Mermaid Diagram 2 of 10):**
        ```mermaid
        graph LR
            A[Input: Product Description, Prompt Directives] --> B(Prompt Engineering Module);
            B --> C{Contextual Integration: Brand Voice, Real-time Data, Semantic Graph};
            C --> D[Generative AI Core (LLM)];
            D --> E[Post-processing & Filtering: Bias Mitigation, Quality Assurance];
            E --> F[Output: Copy Variants, Explainability Insights];
        ```

        **Optimization Goal Claim:** Each variant aims to maximize a composite utility score `U`, defined by:
        `U = \sum_{i=1}^{n} w_i \cdot M_i(\text{variant}, \text{context})`
        where `M_i` are individual metric functions (e.g., semantic relevance, rhetorical alignment), and `w_i` are dynamically adjusted weights.
      requestBody:
        description: Input payload containing the product description and explicit prompt directives for the generative AI model.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CopyGenerationRequest'
      responses:
        '200':
          description: Successfully generated marketing copy variants.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CopyGenerationResponse'
        '400':
          description: Invalid request payload or missing required parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized access. Missing or invalid API key.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Too many requests. Rate limit exceeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error during copy generation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /feedback:
    post:
      summary: Submit user feedback and performance metrics
      operationId: submitFeedback
      tags:
        - Feedback and Optimization
      description: |
        Captures user interactions and real-world performance data for previously generated marketing assets. This feedback is critical for the Feedback Loop Processor to continuously refine prompt engineering strategies and adapt the generative AI model through reinforcement learning. The system utilizes this data to update its internal reward functions and adjust model parameters, driving an iterative improvement cycle.

        **Feedback Loop System (Mermaid Diagram 3 of 10):**
        ```mermaid
        graph TD
            A[Generated Copy] --> B(User Interaction / Platform Deployment);
            B --> C{Feedback Submission: Selected Variant, Metrics, Rating};
            C --> D[Feedback Processing Service];
            D --> E[Reinforcement Learning Agent];
            E --> F[Update Prompt Engineering & Model Parameters];
            F --> A;
        ```

        **Reinforcement Learning Update Equation:**
        The Q-value for a given state-action pair `(s, a)` is updated using the temporal difference learning rule:
        `Q(s_t, a_t) \leftarrow Q(s_t, a_t) + \alpha [r_{t+1} + \gamma \max_a Q(s_{t+1}, a) - Q(s_t, a_t)]`
        where `s` is the current context/prompt, `a` is the generated copy, `r` is the reward (derived from feedback), `\alpha` is the learning rate, and `\gamma` is the discount factor.
      requestBody:
        description: Payload containing feedback data linked to a specific copy generation event.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackSubmission'
      responses:
        '200':
          description: Feedback successfully received and processed for optimization.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Feedback successfully recorded for generationId: gen-xyz-789."
                  processedTimestamp:
                    type: string
                    format: date-time
                    description: Timestamp when the feedback was processed.
                    example: "2023-10-27T10:30:00Z"
        '400':
          description: Invalid feedback payload or missing generation identifier.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized access. Missing or invalid API key.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error during feedback processing.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /brand-voices:
    post:
      summary: Create a new brand voice profile
      operationId: createBrandVoice
      tags:
        - System Configuration
      description: |
        Establishes a new comprehensive brand voice profile, including preferred tone, vocabulary, grammatical rules, and stylistic directives. This profile will guide the Prompt Engineering Module to ensure consistent brand identity across generated copy. Each brand voice acts as a sophisticated constraint layer within the generative process, significantly influencing lexical choice and stylistic presentation.

        **Brand Voice Impact Model:**
        The probability of generating a token `w` given context `c` and brand voice `BV` is modulated by:
        `P(w | c, BV) = P(w | c) \cdot \exp(\lambda \cdot S(w, BV))`
        where `S(w, BV)` is a semantic compatibility score of `w` with `BV`, and `\lambda` is a scalar influence factor.
      requestBody:
        description: Detailed specification of the new brand voice.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BrandVoiceProfile'
      responses:
        '201':
          description: Brand voice profile successfully created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  brandVoiceId:
                    type: string
                    format: uuid
                    description: Unique identifier for the newly created brand voice profile.
                    example: "bv-abc-123"
                  message:
                    type: string
                    example: "Brand voice 'InnovateTech Tone' created successfully."
        '400':
          description: Invalid brand voice definition.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: A brand voice with the specified name already exists.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error during brand voice creation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /brand-voices/{brandVoiceId}:
    get:
      summary: Retrieve a specific brand voice profile
      operationId: getBrandVoice
      tags:
        - System Configuration
      description: |
        Fetches the detailed configuration for a specific brand voice profile identified by its unique ID. This allows for auditing and inspection of the intricate stylistic and lexical rules that govern content generation for a particular brand identity.
      parameters:
        - name: brandVoiceId
          in: path
          description: Unique identifier of the brand voice profile to retrieve.
          required: true
          schema:
            type: string
            format: uuid
            example: "bv-abc-123"
      responses:
        '200':
          description: Brand voice profile retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandVoiceProfile'
        '401':
          description: Unauthorized access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Brand voice not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update an existing brand voice profile
      operationId: updateBrandVoice
      tags:
        - System Configuration
      description: |
        Modifies an existing brand voice profile, allowing for dynamic adjustments to stylistic guidelines and parameters. Updates to a brand voice propagate through the system, influencing subsequent copy generation requests. This enables agile adaptation to evolving brand identities or campaign-specific stylistic requirements.
      parameters:
        - name: brandVoiceId
          in: path
          description: Unique identifier of the brand voice profile to update.
          required: true
          schema:
            type: string
            format: uuid
            example: "bv-abc-123"
      requestBody:
        description: Updated detailed specification of the brand voice.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BrandVoiceProfile'
      responses:
        '200':
          description: Brand voice profile updated successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  brandVoiceId:
                    type: string
                    format: uuid
                    example: "bv-abc-123"
                  message:
                    type: string
                    example: "Brand voice 'InnovateTech Tone' updated successfully."
        '400':
          description: Invalid brand voice definition.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Brand voice not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error during brand voice update.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /brand-voices/{brandVoiceId}/activate:
    post:
      summary: Activate a specific brand voice profile
      operationId: activateBrandVoice
      tags:
        - System Configuration
      description: Activates a brand voice profile, making it available for use in copy generation.
      parameters:
        - name: brandVoiceId
          in: path
          description: Unique identifier of the brand voice profile to activate.
          required: true
          schema:
            type: string
            format: uuid
            example: "bv-abc-123"
      responses:
        '200':
          description: Brand voice profile activated successfully.
        '404':
          description: Brand voice not found.

  /optimization-strategies:
    post:
      summary: Create a new optimization strategy
      operationId: createOptimizationStrategy
      tags:
        - Feedback and Optimization
      description: |
        Defines a new, custom strategy for optimizing generated marketing copy based on specific business objectives. These strategies are crucial for guiding the reinforcement learning agent towards desired performance outcomes. A strategy encapsulates target metrics, acceptable trade-offs, and temporal considerations.
        **Strategy Impact Score:**
        `S_impact = \sum_{k=1}^{m} \omega_k \cdot \text{MetricPerformance}(M_k)`
        where `M_k` are the target metrics (e.g., CTR, Conversion Rate), and `\omega_k` are their respective weights.
      requestBody:
        description: Detailed specification of the new optimization strategy.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OptimizationStrategy'
      responses:
        '201':
          description: Optimization strategy successfully created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  strategyId:
                    type: string
                    format: uuid
                    example: "opt-strat-001"
                  message:
                    type: string
                    example: "Optimization strategy 'Maximize Conversions' created."
        '400':
          description: Invalid strategy definition.
        '401':
          description: Unauthorized access.

  /optimization-strategies/{strategyId}:
    get:
      summary: Retrieve an optimization strategy
      operationId: getOptimizationStrategy
      tags:
        - Feedback and Optimization
      description: Fetches the details of a specific optimization strategy by its ID.
      parameters:
        - name: strategyId
          in: path
          description: Unique identifier of the optimization strategy.
          required: true
          schema:
            type: string
            format: uuid
            example: "opt-strat-001"
      responses:
        '200':
          description: Optimization strategy retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OptimizationStrategy'
        '404':
          description: Strategy not found.

  /analytics/performance:
    get:
      summary: Retrieve aggregated performance analytics
      operationId: getPerformanceAnalytics
      tags:
        - Analytics and Reporting
      description: |
        Provides comprehensive, aggregated performance analytics for generated copy across various campaigns and timeframes. This endpoint is crucial for data-driven decision-making and understanding the efficacy of AI-generated content in real-world scenarios. Includes metrics like average CTR, conversion rates, and engagement scores, with filtering capabilities.

        **Performance Metrics Aggregation (Mermaid Diagram 4 of 10):**
        ```mermaid
        graph LR
            A[Raw Performance Data] --> B(Data Aggregation Service);
            B --> C{Filtering & Grouping: Date Range, Campaign, Copy Type};
            C --> D[Metric Calculation Engine];
            D --> E[Output: Aggregated AnalyticsReport];
        ```

        **Weighted Average Conversion Rate Calculation:**
        `\text{AvgConversionRate} = \frac{\sum_{j=1}^{N} (\text{Conversions}_j \cdot \text{Impressions}_j)}{\sum_{j=1}^{N} \text{Impressions}_j}`
        where `N` is the number of campaigns/copies, `Conversions_j` is the conversion rate for item `j`, and `Impressions_j` is its impressions count.
      parameters:
        - name: startDate
          in: query
          description: Start date for the analytics period (ISO 8601 format).
          required: false
          schema:
            type: string
            format: date
            example: "2023-01-01"
        - name: endDate
          in: query
          description: End date for the analytics period (ISO 8601 format).
          required: false
          schema:
            type: string
            format: date
            example: "2023-10-26"
        - name: campaignId
          in: query
          description: Filter analytics by a specific campaign ID.
          required: false
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Aggregated performance analytics successfully retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyticsReport'
        '400':
          description: Invalid date range or parameters.

  /ai-models:
    get:
      summary: List available AI models and their versions
      operationId: listAIModels
      tags:
        - AI Model Management
      description: |
        Retrieves a list of all deployed generative AI models, their versions, and current status. This allows for transparency regarding the underlying intelligence powering the copy generation. Each model is characterized by its training data, architecture, and performance benchmarks.
      responses:
        '200':
          description: List of AI models.
          content:
            application/json:
              schema:
                type: object
                properties:
                  models:
                    type: array
                    items:
                      $ref: '#/components/schemas/AIModelDetails'

  /ai-models/{modelId}/fine-tune:
    post:
      summary: Initiate fine-tuning for a specific AI model
      operationId: fineTuneAIModel
      tags:
        - AI Model Management
      description: |
        Triggers a fine-tuning process for a specified AI model using custom datasets (e.g., brand-specific copy, high-performing historical data). This allows for deep customization and adaptation of the generative AI to unique brand requirements and evolving marketing landscapes. Fine-tuning enhances model performance on specific domains, often reducing perplexity and improving fluency.

        **Fine-Tuning Workflow (Mermaid Diagram 5 of 10):**
        ```mermaid
        sequenceDiagram
            participant User
            participant API
            participant FineTuneService
            participant ModelTrainingInfra
            User->>API: POST /ai-models/{modelId}/fine-tune
            API->>FineTuneService: Request Fine-tune (modelId, datasetRef, hyperparameters)
            FineTuneService->>ModelTrainingInfra: Provision Resources, Load Data & Model
            ModelTrainingInfra->>ModelTrainingInfra: Execute Training Loop (Gradient Descent)
            ModelTrainingInfra-->>FineTuneService: Training Progress Updates
            FineTuneService->>API: Acknowledge, Provide Job ID
            API-->>User: 202 Accepted (jobId)
            ModelTrainingInfra->>FineTuneService: Training Complete, Store New Weights
            FineTuneService->>API: Notify Completion (jobId, newModelVersion)
            API->>User: Webhook (optional): newModelVersion available
        ```

        **Fine-tuning Loss Function:**
        During fine-tuning, the model minimizes a cross-entropy loss `L`:
        `L(\theta) = - \frac{1}{N} \sum_{i=1}^{N} \sum_{t=1}^{T_i} \log P(y_{i,t} | y_{i,<t}, x_i; \theta)`
        where `\theta` are model parameters, `N` is dataset size, `T_i` is sequence length, `y_{i,t}` is target token, `y_{i,<t}` are previous tokens, and `x_i` is the input context.
      parameters:
        - name: modelId
          in: path
          description: Unique identifier of the AI model to fine-tune.
          required: true
          schema:
            type: string
            format: uuid
            example: "llm-core-v3"
      requestBody:
        description: Fine-tuning configuration, including dataset references and hyperparameters.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FineTuningRequest'
      responses:
        '202':
          description: Fine-tuning process initiated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  jobId:
                    type: string
                    format: uuid
                    description: Unique identifier for the asynchronous fine-tuning job.
                    example: "ft-job-456"
                  message:
                    type: string
                    example: "Fine-tuning job started successfully."
        '400':
          description: Invalid fine-tuning request.

  /ab-tests:
    post:
      summary: Create a new A/B test for marketing copy
      operationId: createABTest
      tags:
        - Analytics and Reporting
      description: |
        Sets up an A/B test to empirically evaluate the performance of different marketing copy variants generated by the AI system. This enables scientific validation of AI-generated content and informs optimal strategies. The test can compare a control (human-generated or baseline AI) against multiple AI-generated variants.
        **A/B Test Statistical Significance:**
        The p-value `p` for comparing conversion rates `\hat{p}_A` and `\hat{p}_B` with sample sizes `n_A` and `n_B` is derived from a Z-score:
        `Z = \frac{\hat{p}_A - \hat{p}_B}{\sqrt{\hat{p} (1-\hat{p}) (\frac{1}{n_A} + \frac{1}{n_B})}}`, where `\hat{p} = \frac{X_A + X_B}{n_A + n_B}`.
        A variant is declared superior if `p < \alpha`, where `\alpha` is the significance level.
      requestBody:
        description: Configuration details for the A/B test.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ABTestConfiguration'
      responses:
        '201':
          description: A/B test successfully created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  testId:
                    type: string
                    format: uuid
                    example: "ab-test-789"
                  message:
                    type: string
                    example: "A/B test 'Homepage Headline Test' created."
        '400':
          description: Invalid A/B test configuration.

  /ab-tests/{testId}:
    get:
      summary: Get results of an A/B test
      operationId: getABTestResults
      tags:
        - Analytics and Reporting
      description: |
        Retrieves the current or final results of a specific A/B test, including statistical significance, confidence intervals, and performance metrics for each variant. This endpoint provides actionable insights derived from empirical testing, validating the effectiveness of generated copy.

        **A/B Test Results Flow (Mermaid Diagram 6 of 10):**
        ```mermaid
        graph LR
            A[AB Test Configuration] --> B(Copy Generation (Variants A, B, C));
            B --> C{External Deployment to Marketing Channel};
            C --> D[Collect Real-time Performance Data (Impressions, Clicks, Conversions)];
            D --> E[Statistical Analysis Engine (P-values, Confidence Intervals)];
            E --> F[Output: ABTestResult];
        ```

        **Confidence Interval for Difference in Proportions:**
        The `(1 - \alpha)` confidence interval for `p_A - p_B` is given by:
        `(\hat{p}_A - \hat{p}_B) \pm Z_{1-\alpha/2} \sqrt{\frac{\hat{p}_A(1-\hat{p}_A)}{n_A} + \frac{\hat{p}_B(1-\hat{p}_B)}{n_B}}`
        where `Z_{1-\alpha/2}` is the critical value from the standard normal distribution.
      parameters:
        - name: testId
          in: path
          description: Unique identifier of the A/B test.
          required: true
          schema:
            type: string
            format: uuid
            example: "ab-test-789"
      responses:
        '200':
          description: A/B test results retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ABTestResult'
        '404':
          description: A/B test not found.

  /semantic-graphs:
    post:
      summary: Create a new semantic knowledge graph
      operationId: createSemanticGraph
      tags:
        - System Configuration
      description: |
        Establishes a new semantic knowledge graph (SKG) to provide factual accuracy, contextual depth, and specific domain knowledge to the generative AI. SKGs enhance the model's ability to reason and produce factually correct, coherent content. This allows for precise control over the semantic landscape the AI operates within.

        **Semantic Graph Construction Process:**
        `G = (V, E)` where `V` is the set of nodes (entities, concepts) and `E` is the set of edges (relationships).
        Each edge `e \in E` is a triplet `(head, relation, tail)`.
        The relevance score for a concept `c` to a query `q` is often computed using embedding similarities:
        `\text{Relevance}(c, q) = \text{cosine_similarity}(\text{Embed}(c), \text{Embed}(q))`
      requestBody:
        description: Definition of the new semantic knowledge graph.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SemanticGraphDefinition'
      responses:
        '201':
          description: Semantic knowledge graph created successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  graphId:
                    type: string
                    format: uuid
                    example: "skg-prod-001"
                  message:
                    type: string
                    example: "Semantic graph 'Product Features SKG' created."
        '400':
          description: Invalid graph definition.

  /semantic-graphs/{graphId}:
    get:
      summary: Retrieve a specific semantic knowledge graph
      operationId: getSemanticGraph
      tags:
        - System Configuration
      description: Fetches the details of a specific semantic knowledge graph by its ID.
      parameters:
        - name: graphId
          in: path
          description: Unique identifier of the semantic knowledge graph.
          required: true
          schema:
            type: string
            format: uuid
            example: "skg-prod-001"
      responses:
        '200':
          description: Semantic graph retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SemanticGraphDefinition'
        '404':
          description: Graph not found.

  /explainability-config:
    get:
      summary: Get global explainability configuration
      operationId: getExplainabilityConfig
      tags:
        - System Configuration
      description: |
        Retrieves the system-wide configuration for explainability features, including the default level of detail, visualization preferences, and data retention policies for explanatory artifacts. This allows for standardized and consistent transparency across all AI-generated content.
      responses:
        '200':
          description: Explainability configuration retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExplainabilityConfiguration'

    put:
      summary: Update global explainability configuration
      operationId: updateExplainabilityConfig
      tags:
        - System Configuration
      description: Updates the system-wide configuration for explainability features.
      requestBody:
        description: Updated explainability configuration.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExplainabilityConfiguration'
      responses:
        '200':
          description: Explainability configuration updated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExplainabilityConfiguration'

  /auditing/logs:
    get:
      summary: Retrieve system audit logs
      operationId: getAuditLogs
      tags:
        - Audit and Compliance
      description: |
        Retrieves a chronological record of all significant system events, API calls, and model decisions. This audit trail is essential for compliance, debugging, security analysis, and understanding system behavior over time. The logs capture user actions, system responses, and critical state changes.
        **Audit Log Structure:**
        Each log entry `L_i` has fields `{Timestamp, Actor, Action, Target, Outcome, Details}`.
        The system ensures `log_integrity = HASH(\text{concat_all}(L_i, L_{i-1}, ...))` for tamper detection.
      parameters:
        - name: startDate
          in: query
          description: Filter logs from this date (ISO 8601).
          required: false
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: Filter logs up to this date (ISO 8601).
          required: false
          schema:
            type: string
            format: date
        - name: userId
          in: query
          description: Filter logs by user ID.
          required: false
          schema:
            type: string
            format: uuid
        - name: eventType
          in: query
          description: Filter logs by event type (e.g., 'COPY_GENERATE', 'FEEDBACK_SUBMIT').
          required: false
          schema:
            type: string
      responses:
        '200':
          description: A list of audit log entries.
          content:
            application/json:
              schema:
                type: object
                properties:
                  logs:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuditLogEntry'

  /custom-metrics:
    post:
      summary: Define a new custom performance metric
      operationId: createCustomMetric
      tags:
        - System Configuration
      description: |
        Allows users to define and track custom business-specific performance metrics beyond the standard set. This enables highly tailored optimization and reporting, aligning the AI's learning objectives directly with unique organizational KPIs. A custom metric can be derived from raw platform data via a specified formula.
        **Custom Metric Definition (Mermaid Diagram 7 of 10):**
        ```mermaid
        graph TD
            A[User Input: Metric Name, Description, Formula] --> B(Validation & Parsing Service);
            B --> C{Data Source Mapping: Raw Event Types, Fields};
            C --> D[Metric Calculation Engine Integration];
            D --> E[Store CustomMetricDefinition];
        ```

        **Example Custom Metric Formula (Weighted Engagement Score):**
        `\text{EngagementScore} = w_1 \cdot \text{Clicks} + w_2 \cdot \text{Shares} + w_3 \cdot \log(\text{TimeOnPage})`
        where `w_i` are configurable weights and `\log` normalizes `TimeOnPage`.
      requestBody:
        description: Definition of the new custom metric.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomMetricDefinition'
      responses:
        '201':
          description: Custom metric defined successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  metricId:
                    type: string
                    format: uuid
                    example: "kpi-sales-001"
                  message:
                    type: string
                    example: "Custom metric 'Sales Qualified Leads' created."
        '400':
          description: Invalid metric definition.

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key required for authentication with the AI Marketing Copy Generation System.

  schemas:
    CopyGenerationRequest:
      type: object
      required:
        - productDescription
      properties:
        productDescription:
          type: string
          description: |
            A granular, descriptive articulation of the product, service, or conceptual offering for which marketing copy is to be generated. This serves as the fundamental semantic input, forming the initial embedding space for the generative process.
            **Example Semantic Embedding:**
            `\vec{P} = \frac{1}{N_P} \sum_{k=1}^{N_P} \text{Embed}(\text{token}_k)`
            where `\text{Embed}` is a word embedding function and `N_P` is the number of tokens in the description.
          example: "Our novel AI-powered financial optimization tool autonomously scrutinizes individual expenditure patterns and proactively identifies latent opportunities for capital savings, enhancing fiscal efficiency and personal wealth accumulation."
        promptDirectives:
          $ref: '#/components/schemas/PromptDirectives'
        multimodalInputReferences:
          type: array
          description: References to non-textual inputs e.g. image URLs, video IDs that provide supplementary semantic context for copy generation. These inputs contribute to a richer contextual embedding.
          items:
            $ref: '#/components/schemas/MultimodalInputReference'
        callbackUrl:
          type: string
          format: uri
          description: Optional URL for asynchronous result notification in case of long-running generation tasks. Upon completion, a POST request will be sent to this URL with the `CopyGenerationResponse`.
          example: "https://your-system.com/webhook/copy-generated"
        explainabilityRequested:
          type: boolean
          description: If true, the response will include insights into the generative process for interpretability, such as feature importance scores or semantic journey visualizations.
          default: false
        priorityLevel:
          type: string
          description: Specifies the processing priority for the generation task. Higher priority tasks may incur additional costs.
          enum:
            - low
            - standard
            - high
            - urgent
          default: "standard"
          example: "high"
        customMetadata:
          type: object
          description: Arbitrary key-value pairs for attaching additional metadata to the generation request, useful for internal tracking.
          additionalProperties:
            type: string
          example:
            campaignTag: "Q4-Holiday-Sale"
            projectId: "financial-ai-launch"
        versionTag:
          type: string
          description: An optional tag to specify a particular version of the generative model to use. If omitted, the latest stable version is used.
          example: "gpt-4-turbo-v2.1"

    PromptDirectives:
      type: object
      description: |
        A set of explicit instructions and parameters to meticulously engineer the prompt for the generative AI model, guiding its synthesis towards desired characteristics and typology of marketing assets. These directives act as critical constraints and amplifiers within the AI's latent space, steering the generation trajectory.

        **Prompt Construction Algorithm (Mermaid Diagram 8 of 10):**
        ```mermaid
        graph TD
            A[Product Description Embeddings] --> B(Directive Embeddings: Tone, Length, Audience);
            C[Contextual Embeddings: Brand Voice, Real-time Data, SKG] --> B;
            B --> D(Combined Prompt Vector `\vec{P}_{final}`);
            D --> E[Pre-processing & Tokenization];
            E --> F[Generative Model Input];
        ```

        **Directive Influence Function:**
        The overall influence of directives `D` on the generated output `O` can be modeled as:
        `\text{Influence}(D, O) = \sum_{j=1}^{K} \beta_j \cdot \text{AlignmentScore}(\text{Directive}_j, O)`
        where `\beta_j` are weights reflecting the importance of each directive, and `\text{AlignmentScore}` measures how well the output adheres to the directive.
      properties:
        outputFormat:
          type: string
          description: The specific typology of marketing asset desired. Each format implies a distinct structural and linguistic schema.
          enum:
            - headline
            - paragraph
            - social_media_post
            - call_to_action
            - email_subject_line
            - meta_description
            - video_script_outline
            - long_form_article_outline
            - landing_page_hero
            - blog_post_introduction
            - product_description_short
            - ad_creative_tagline
          example: "social_media_post"
        numVariants:
          type: integer
          description: The number of distinct marketing copy variations to generate. More variants increase diversity but also processing time.
          minimum: 1
          maximum: 20 # Increased maximum
          default: 3
          example: 5
        tone:
          type: string
          description: The desired emotional and rhetorical tone of the generated copy. This influences word choice, sentence structure, and overall sentiment.
          enum:
            - authoritative
            - humorous
            - empathetic
            - playful
            - professional
            - urgent
            - inspirational
            - casual
            - luxurious
            - minimalist
            - avant_garde
            - reassuring
          example: "humorous"
        length:
          type: string
          description: The desired verbosity or conciseness of the generated copy. This can be directly mapped to token count targets.
          enum:
            - ultra_concise # new
            - concise
            - standard
            - verbose
            - extensive # new
          example: "concise"
        targetAudience:
          type: string
          description: A detailed description of the intended target demographic or audience segment for the copy. This helps in tailoring language, cultural references, and benefit emphasis.
          example: "millennials interested in sustainable living who value ethical consumption and digital-native solutions"
        keywordsToInclude:
          type: array
          description: A list of specific keywords or phrases that MUST be present in the generated copy to enhance SEO, thematic relevance, or compliance requirements.
          items:
            type: string
          example: ["sustainable", "eco-friendly", "zero waste", "circular economy"]
        keywordsToExclude:
          type: array
          description: A list of words or phrases that should NOT appear in the generated copy, often due to brand guidelines, legal restrictions, or competitive reasons.
          items:
            type: string
          example: ["expensive", "complicated", "competitorX"]
        brandVoiceId:
          type: string
          format: uuid
          description: A unique identifier referencing a predefined brand style guide and voice profile to ensure consistent brand identity. This acts as a powerful prior for the generative model.
          example: "bv-abc-123"
        emotionalToneProfile:
          $ref: '#/components/schemas/EmotionalToneProfile'
        linguisticComplexity:
          type: string
          description: The desired reading level or syntactic complexity of the output. This is often measured by readability scores like Flesch-Kincaid.
          enum:
            - rudimentary_childish # new
            - simple_conversational
            - intermediate_informative
            - advanced_technical
            - academic_expert # new
          example: "intermediate_informative"
        culturalAdaptationTarget:
          type: string
          description: BCP 47 language tag for cultural localization e.g. en-US es-MX fr-CA. This ensures not just translation but culturally appropriate messaging.
          example: "es-MX"
        realtimeContext:
          $ref: '#/components/schemas/RealtimeContext'
        semanticConstraintGraphId:
          type: string
          format: uuid
          description: Identifier for a semantic knowledge graph to inform factual accuracy and precision, preventing hallucination and ensuring thematic coherence.
          example: "skg-prod-001"
        biasMitigationLevel:
          type: string
          description: Level of bias detection and mitigation to apply during generation. Strict levels may trade off some creativity for ethical robustness.
          enum:
            - default
            - strict
            - disabled
            - experimental_unbiased # new
          default: "default"
          example: "strict"
        targetSentimentScore:
          type: number
          format: float
          description: A desired aggregate sentiment score for the generated copy, ranging from -1.0 (very negative) to 1.0 (very positive).
          minimum: -1.0
          maximum: 1.0
          example: 0.75
        creativityLevel:
          type: number
          format: float
          description: Controls the divergence from common linguistic patterns. Higher values encourage more novel and surprising outputs (e.g., higher temperature in sampling).
          minimum: 0.0
          maximum: 1.0
          default: 0.5
          example: 0.8
          x-mermaid-diagram: |
            graph TD
                A[Creativity Level 0.0] --> B[Deterministic, Repetitive];
                A --> C[Creativity Level 0.5] --> D[Balanced, Standard];
                A --> E[Creativity Level 1.0] --> F[Novel, Unconventional];
        complianceRequirements:
          type: array
          items:
            type: string
          description: Specific compliance standards or regulations that the generated copy must adhere to (e.g., "GDPR", "HIPAA", "FCC_Advertising_Guidelines").
          example: ["GDPR", "CCPA"]

    MultimodalInputReference:
      type: object
      description: A reference to a non-textual input asset that provides additional context for the generative AI. These inputs are processed by dedicated multimodal encoders to create enriched contextual embeddings.
      required:
        - type
        - url
      properties:
        type:
          type: string
          enum: [image, video, audio, 3d_model, document_pdf] # Expanded types
          description: The type of multimodal asset.
          example: "image"
        url:
          type: string
          format: uri
          description: The publicly accessible URL of the multimodal asset. For security, URLs are validated against allowed domains.
          example: "https://example.com/product_image.jpg"
        description:
          type: string
          description: An optional textual description of the multimodal asset. This can supplement the AI's understanding, especially for abstract or complex visuals.
          example: "Product hero shot showing elegant design, metallic finish, and soft ambient lighting."
        hashChecksum:
          type: string
          description: Optional hash checksum (e.g., MD5, SHA256) of the asset content for integrity verification.
          example: "e4d7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7"

    EmotionalToneProfile:
      type: object
      description: |
        Granular control over the emotional valence, arousal, and dominance (VAD) profile of the generated copy. This enables precise emotional targeting, ensuring the copy resonates with the desired psychological state of the audience. The VAD model provides a robust, tripartite representation of sentiment.

        **VAD Model and Target State Convergence (Mermaid Diagram 9 of 10):**
        ```mermaid
        graph TD
            A[Desired VAD Profile] --> B{Generative AI's Internal State};
            B --> C[Generate Copy Candidates];
            C --> D[Evaluate VAD of Candidates];
            D -- Feedback --> B;
            style A fill:#f9f,stroke:#333,stroke-width:2px
            style B fill:#bbf,stroke:#333,stroke-width:2px
            style D fill:#fb9,stroke:#333,stroke-width:2px
        ```

        **Combined Emotional Score `E_score`:**
        `E_{score} = w_V \cdot (\text{Valence} - \text{Valence}_{target})^2 + w_A \cdot (\text{Arousal} - \text{Arousal}_{target})^2 + w_D \cdot (\text{Dominance} - \text{Dominance}_{target})^2`
        The AI aims to minimize this squared error, where `w_V, w_A, w_D` are adjustable weights.
      properties:
        valence:
          type: number
          format: float
          minimum: -1.0
          maximum: 1.0
          description: Emotional positivity/negativity score (-1.0 for very negative, 1.0 for very positive).
          example: 0.8
        arousal:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          description: Emotional excitement/calmness score (0.0 for very calm, 1.0 for very excited).
          example: 0.7
        dominance:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          description: Emotional sense of control (0.0 for submissive, 1.0 for dominant).
          example: 0.5
      example:
        valence: 0.7
        arousal: 0.6
        dominance: 0.55

    RealtimeContext:
      type: object
      description: |
        Dynamic integration of real-time data to ensure temporal and situational relevance of generated assets. This includes transient market conditions, ongoing promotions, and competitor insights, providing the AI with the freshest possible understanding of the operating environment.

        **Real-time Contextualization Process:**
        `\text{ContextualEmbedding} = f(\text{MarketTrendsEmbed}, \text{SeasonalEmbed}, \text{CompetitorEmbed}, \text{GlobalEventsEmbed})`
        where `f` is a fusion network (e.g., attention mechanism) combining diverse temporal embeddings.
      properties:
        marketTrends:
          type: array
          items:
            type: string
          description: Keywords or themes representing current market trends and popular cultural narratives.
          example: ["AI innovation", "sustainability movement", "remote work culture"]
        seasonalPromotions:
          type: string
          description: Description of any current seasonal or holiday promotions, allowing the AI to integrate relevant urgency or festive themes.
          example: "Summer sale discounts of up to 30% off on eco-friendly products ending soon"
        competitorActivity:
          type: array
          items:
            type: string
          description: Information about recent competitor marketing activities, product launches, or price changes, enabling strategic counter-positioning.
          example: ["competitor X launched new feature in CRM with free trial", "competitor Y announced 15% price drop on premium subscription"]
        globalEvents:
          type: array
          items:
            type: string
          description: Relevant global events that might influence consumer sentiment, purchasing behavior, or brand perception (e.g., economic shifts, major news events).
          example: ["economic recovery after pandemic", "digital transformation acceleration", "supply chain disruptions"]
        currentInventoryLevel:
          type: string
          description: Real-time information on product inventory, allowing for 'limited stock' messaging or highlighting abundance.
          enum:
            - high_stock
            - medium_stock
            - low_stock
            - out_of_stock
          example: "low_stock"
        socialMediaTrendingTopics:
          type: array
          items:
            type: string
          description: Current trending topics on major social media platforms, for hyper-relevant social copy.
          example: ["#TechTuesday", "#FutureOfAI", "#SustainableLiving"]

    CopyGenerationResponse:
      type: object
      description: |
        The output structure containing the generated marketing copy variants, along with metadata for tracking and explainability. This response encapsulates the AI's best efforts to fulfill the prompt directives, providing a rich set of options for human review and selection.
      required:
        - generationId
        - copyVariants
      properties:
        generationId:
          type: string
          format: uuid
          description: A unique identifier for this specific copy generation request, used for tracking, feedback submission, and auditing.
          example: "gen-xyz-789"
        copyVariants:
          type: array
          description: A diverse plurality of distinct marketing copy permutations synthesized by the generative AI model, each uniquely identified and scored.
          items:
            $ref: '#/components/schemas/GeneratedCopyVariant'
        explainabilityInsights:
          $ref: '#/components/schemas/ExplainabilityInsights'
          description: Optional insights into the generative process if requested, aiding in understanding the AI's reasoning.
        timestamp:
          type: string
          format: date-time
          description: The UTC timestamp when the copy generation was completed.
          example: "2023-10-27T11:00:00Z"
        requestedPromptDirectives:
          $ref: '#/components/schemas/PromptDirectives'
          description: The exact prompt directives that were used for this generation, for complete transparency and reproducibility.

    GeneratedCopyVariant:
      type: object
      description: |
        A single piece of marketing copy generated by the AI, including its content and a unique identifier. Each variant also provides rich metadata, including rhetorical vectors and semantic similarity scores, for objective evaluation.
      required:
        - variantId
        - content
      properties:
        variantId:
          type: string
          format: uuid
          description: A unique identifier for this specific copy variant within the generation batch.
          example: "var-123-abc"
        content:
          type: string
          description: The actual text content of the generated marketing copy. This is the primary output artifact.
          example: "Breathe Smarter. Live Healthier. AuraSync Pro."
        rhetoricalVector:
          $ref: '#/components/schemas/EmotionalToneProfile'
          description: The estimated rhetorical vector of this specific variant in the VAD (Valence-Arousal-Dominance) space, including emotional valence, arousal, and dominance. This allows for quantitative comparison against target emotional profiles.
        semanticSimilarityScore:
          type: number
          format: float
          description: |
            A normalized score indicating how semantically similar this variant's content is to the original product description. Calculated using cosine similarity of embedding vectors.
            `\text{SimilarityScore} = \text{cosine_similarity}(\text{Embed}(\text{variant}), \text{Embed}(\text{productDescription}))`
          minimum: 0.0
          maximum: 1.0
          example: 0.92
        keywordCoverageScore:
          type: number
          format: float
          description: A score indicating the percentage of `keywordsToInclude` that are present in the variant.
          minimum: 0.0
          maximum: 1.0
          example: 0.85
        readabilityScore:
          type: number
          format: float
          description: The Flesch-Kincaid grade level score for the variant, indicating its linguistic complexity.
          minimum: 0.0
          example: 7.2
        estimatedCTR:
          type: number
          format: float
          description: An AI-predicted Click-Through Rate for this variant, based on historical data and model confidence.
          minimum: 0.0
          maximum: 1.0
          example: 0.045
        estimatedConversionRate:
          type: number
          format: float
          description: An AI-predicted Conversion Rate for this variant.
          minimum: 0.0
          maximum: 1.0
          example: 0.0018
        complianceRiskScore:
          type: number
          format: float
          description: A score indicating the estimated risk of the copy violating specified compliance guidelines (0.0 for low risk, 1.0 for high risk).
          minimum: 0.0
          maximum: 1.0
          example: 0.15

    ExplainabilityInsights:
      type: object
      description: |
        Provides insights into the generative process to enhance user trust and facilitate informed refinement. This includes a breakdown of influential input factors, rhetorical attributions, and a visual representation of the AI's internal decision-making.

        **Explainability Insights Flow (Mermaid Diagram 10 of 10):**
        ```mermaid
        graph TD
            A[Generative Model Output] --> B(Attribution Module: SHAP/LIME);
            B --> C[Semantic Trajectory Analyzer];
            C --> D[Visualization Engine];
            D --> E[Output: ExplainabilityInsights];
        ```

        **SHAP (SHapley Additive exPlanations) Values:**
        The contribution `\phi_i` of a feature `i` (e.g., a keyword) to the prediction `f(x)` is:
        `\phi_i(f, x) = \sum_{S \subseteq N \setminus \{i\}} \frac{|S|!(|N| - |S| - 1)!}{|N|!} [f_x(S \cup \{i\}) - f_x(S)]`
        where `N` is the set of all features, `S` is a subset of features, and `f_x(S)` is the prediction with features in `S` present.
      properties:
        keyInputPhrases:
          type: array
          items:
            type: string
          description: Phrases from the input description that were highly influential in generating the output, ranked by their contribution score.
          example: ["AI-powered financial optimization", "capital savings", "wealth accumulation", "expenditure patterns"]
        rhetoricalStyleAttribution:
          type: object
          additionalProperties:
            type: string
          description: Attribution of rhetorical styles and emotional tones to specific prompt directives or underlying model biases.
          example:
            tone: "Emphatic and concise style due to 'urgent' tone directive, amplified by 'high_stock' real-time context."
            keywords: "Inclusion of 'sustainable' and 'eco-friendly' driven by both prompt directives and activated brand voice rules."
        semanticJourneyVisualizationLink:
          type: string
          format: uri
          description: A link to an interactive visualization depicting the 'semantic journey' of the generated copy within the latent space, illustrating how concepts evolved.
          example: "https://dashboard.aimarketingcore.com/visualize/gen-xyz-789"
        biasDetectionReportLink:
          type: string
          format: uri
          description: A link to a detailed report on any detected biases in the generated copy, including the nature and severity of the bias.
          example: "https://dashboard.aimarketingcore.com/bias_report/gen-xyz-789"
        modelConfidenceScore:
          type: number
          format: float
          description: A quantifiable measure of the generative model's confidence in the quality and relevance of the produced variant.
          minimum: 0.0
          maximum: 1.0
          example: 0.95

    FeedbackSubmission:
      type: object
      description: |
        Details of user interaction and performance for a generated copy. This structured feedback is crucial for closing the reinforcement learning loop, enabling the AI to adapt and improve its future generations.
      required:
        - generationId
      properties:
        generationId:
          type: string
          format: uuid
          description: The unique identifier of the copy generation event to which this feedback pertains.
          example: "gen-xyz-789"
        selectedVariantId:
          type: string
          format: uuid
          description: The unique identifier of the specific copy variant chosen by the user for deployment, if applicable.
          example: "var-123-abc"
        editedContent:
          type: string
          description: The final content after user modifications, if the generated copy was edited. This provides valuable human-in-the-loop insights.
          example: "Breathe Smarter, Live Healthier, Achieve More. AuraSync Pro is here."
        explicitRating:
          type: integer
          description: A qualitative rating provided by the user (e.g., 1-5 stars), directly reflecting satisfaction.
          minimum: 1
          maximum: 5
          example: 5
        comments:
          type: string
          description: Additional textual comments or qualitative feedback from the user, offering nuanced insights.
          example: "Loved the punchy headlines, especially variant 1! The call to action could be stronger."
        implicitEngagementMetrics:
          $ref: '#/components/schemas/ImplicitEngagementMetrics'
        realWorldPerformance:
          $ref: '#/components/schemas/RealWorldPerformanceMetrics'
        detectedBias:
          type: boolean
          description: Indicates if the user detected any bias in the generated copy, triggering further investigation.
          example: false
        biasDescription:
          type: string
          description: A detailed description of the detected bias, if any, to inform specific bias mitigation strategies.
        sentimentAnalysis:
          type: object
          description: Automated sentiment analysis of the user's comments.
          properties:
            score:
              type: number
              format: float
              minimum: -1.0
              maximum: 1.0
              example: 0.9
            magnitude:
              type: number
              format: float
              minimum: 0.0
              maximum: 1.0
              example: 0.7

    ImplicitEngagementMetrics:
      type: object
      description: |
        Metrics capturing implicit user behavior with the generated copy, providing non-declarative signals of content quality and relevance. These are often collected via analytics integrations.
        **Engagement Score `E`:**
        `E = k_1 \cdot \text{TimeOnPage} + k_2 \cdot \text{ScrollDepth} + k_3 \cdot \text{CopyPasteCount}`
        where `k_i` are normalized weights for different engagement signals.
      properties:
        timeOnPageSeconds:
          type: integer
          description: Duration in seconds the user spent reviewing the copy on a preview or editing interface.
          minimum: 0
          example: 45
        scrollDepthPercentage:
          type: integer
          description: The percentage of the content scrolled by the user, indicating thoroughness of review.
          minimum: 0
          maximum: 100
          example: 90
        copyPasteActions:
          type: integer
          description: Number of times sections of the copy were copied, suggesting direct utility or appeal.
          minimum: 0
          example: 1
        regenerationRequests:
          type: integer
          description: Number of times the user requested regeneration *after* seeing this particular output, indicating dissatisfaction.
          minimum: 0
          example: 0
        editCount:
          type: integer
          description: The number of distinct edits made by the user to the generated copy.
          minimum: 0
          example: 3
        timeToEditSeconds:
          type: integer
          description: The time taken by the user to start editing the copy after it was presented.
          minimum: 0
          example: 12
        viewCount:
          type: integer
          description: How many times the variant was viewed in the UI.
          minimum: 0
          example: 10

    RealWorldPerformanceMetrics:
      type: object
      description: |
        Empirical data from external marketing platforms validating copy effectiveness, directly influencing the reinforcement learning reward signal. These are the ultimate KPIs for marketing success.
      properties:
        clickThroughRate:
          type: number
          format: float
          description: |
            The percentage of users who clicked on the advertisement or link containing the copy.
            `\text{CTR} = \frac{\text{Clicks}}{\text{Impressions}}`
          minimum: 0.0
          maximum: 1.0
          example: 0.05
        conversionRate:
          type: number
          format: float
          description: |
            The percentage of users who completed a desired action (e.g., purchase, sign-up) after engaging with the copy.
            `\text{CR} = \frac{\text{Conversions}}{\text{Clicks}}`
          minimum: 0.0
          maximum: 1.0
          example: 0.002
        impressions:
          type: integer
          description: The number of times the copy was displayed to users.
          minimum: 0
          example: 100000
        bounceRate:
          type: number
          format: float
          description: |
            The percentage of visitors who navigate away from the site after viewing only one page (for landing page copy).
            `\text{BR} = \frac{\text{SinglePageSessions}}{\text{TotalSessions}}`
          minimum: 0.0
          maximum: 1.0
          example: 0.35
        roiMetric:
          type: number
          format: float
          description: Custom Return on Investment (ROI) metric for the campaign associated with this copy.
          example: 1.25 # 125% return
        averageTimeOnPageSeconds:
          type: integer
          description: Average duration users spent on the page where the copy was displayed.
          minimum: 0
          example: 180
        socialShares:
          type: integer
          description: Number of times the content (containing the copy) was shared on social media.
          minimum: 0
          example: 250
        leadGenerationCount:
          type: integer
          description: Number of leads generated by this copy.
          minimum: 0
          example: 50

    BrandVoiceProfile:
      type: object
      description: |
        Defines the stylistic and lexical characteristics for a specific brand's voice. This profile is a critical input to the prompt engineering module, ensuring consistent brand identity and messaging across all AI-generated content. It acts as a set of guardrails and stylistic preferences for the generative model.
      required:
        - name
        - description
        - toneCharacteristics
      properties:
        brandVoiceId:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier for the brand voice profile. Generated by the system upon creation.
          example: "bv-abc-123"
        name:
          type: string
          description: A human-readable, descriptive name for the brand voice (e.g., "InnovateTech Tone", "Playful Startup Voice").
          example: "InnovateTech Tone"
        description:
          type: string
          description: A detailed description of the brand voice and its intended application, including the brand's persona and communication goals.
          example: "A professional, authoritative yet approachable tone suitable for B2B technology communication, emphasizing clarity, innovation, and thought leadership. Avoids jargon where possible but embraces industry-specific terminology when appropriate."
        toneCharacteristics:
          type: array
          items:
            type: string
          description: Key adjectives describing the desired emotional and rhetorical tone. These are high-level guidance for the AI.
          example: ["professional", "innovative", "trustworthy", "concise", "forward-looking", "customer-centric"]
        preferredVocabulary:
          type: array
          items:
            type: string
          description: A list of specific words or phrases that should be frequently used and reinforced in the generated copy.
          example: ["innovate", "solution", "transform", "optimize", "cutting-edge", "synergy"]
        avoidedVocabulary:
          type: array
          items:
            type: string
          description: A list of words or phrases that should be actively avoided due to brand perception, competitive positioning, or legal reasons.
          example: ["gimmick", "complicated", "mediocre", "cheap", "outdated"]
        grammaticalRules:
          type: array
          items:
            type: string
          description: Specific grammatical or stylistic rules to adhere to (e.g., "always use active voice", "no contractions", "prefer Oxford comma").
          example: ["use active voice exclusively", "avoid contractions in formal contexts", "capitalize product names always", "use the Oxford comma"]
        semanticConstructs:
          type: string
          description: Guidelines for how specific concepts or value propositions should be framed or expressed to align with brand philosophy.
          example: "Always frame challenges as opportunities for our solutions, highlighting user empowerment rather than problem avoidance."
        ethicalGuidelines:
          type: array
          items:
            type: string
          description: Specific ethical or compliance guidelines for content generation, ensuring responsible and inclusive messaging.
          example: ["avoid gender stereotypes", "ensure factual accuracy and cite sources where appropriate", "comply with GDPR and CCPA data privacy communication standards", "promote diversity and inclusion"]
        competitorToneAnalysis:
          type: object
          description: An optional reference to analysis of competitor brand voices to differentiate.
          properties:
            competitorName:
              type: string
              example: "CompetitorA"
            differentiationStrategy:
              type: string
              example: "More authoritative and less playful than CompetitorA."

    ErrorResponse:
      type: object
      properties:
        code:
          type: string
          description: A unique error code for programmatic identification.
          example: "ERR_INVALID_INPUT"
        message:
          type: string
          description: A human-readable error message explaining the issue.
          example: "The productDescription field is required and cannot be empty."
        details:
          type: object
          description: Optional additional details about the error, e.g., validation errors.
          additionalProperties: true
          example:
            invalidFields:
              - field: "productDescription"
                reason: "cannot be empty"
              - field: "promptDirectives.numVariants"
                reason: "must be between 1 and 20"
            traceId: "trace-xyz-789"

    OptimizationStrategy:
      type: object
      description: Defines a specific strategy for the AI to optimize generated copy, focusing on a primary metric and potentially secondary considerations.
      required:
        - name
        - primaryOptimizationGoal
      properties:
        strategyId:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier for the optimization strategy.
          example: "opt-strat-001"
        name:
          type: string
          description: A human-readable name for the strategy.
          example: "Maximize Conversions for Q4"
        description:
          type: string
          description: Detailed explanation of what this strategy aims to achieve.
          example: "Prioritize copy variants that have historically shown the highest conversion rates, with a secondary focus on high CTR, for the upcoming Q4 period."
        primaryOptimizationGoal:
          type: string
          enum:
            - MAXIMIZE_CTR
            - MAXIMIZE_CONVERSION
            - MINIMIZE_BOUNCE_RATE
            - MAXIMIZE_ENGAGEMENT
            - CUSTOM_METRIC_OPTIMIZATION
          description: The primary metric this strategy aims to optimize.
          example: "MAXIMIZE_CONVERSION"
        customMetricId:
          type: string
          format: uuid
          description: Required if `primaryOptimizationGoal` is `CUSTOM_METRIC_OPTIMIZATION`. References a predefined custom metric.
          example: "kpi-sales-001"
        secondaryOptimizationGoals:
          type: array
          items:
            type: object
            properties:
              metric:
                type: string
                enum:
                  - CTR
                  - CONVERSION_RATE
                  - BOUNCE_RATE
                  - TIME_ON_PAGE
                description: Secondary metric to consider.
              weight:
                type: number
                format: float
                minimum: 0.0
                maximum: 1.0
                description: Importance weight for this secondary metric relative to others.
          description: Optional secondary metrics and their weights for multi-objective optimization.
        audienceSegments:
          type: array
          items:
            type: string
          description: Target audience segments for this strategy, if applicable.
          example: ["new_customers", "repeat_purchasers"]
        activePeriod:
          type: object
          properties:
            startDate:
              type: string
              format: date
            endDate:
              type: string
              format: date
          description: The time period during which this strategy should be active.

    AnalyticsReport:
      type: object
      description: A comprehensive report detailing aggregated performance metrics over a specified period.
      properties:
        reportId:
          type: string
          format: uuid
          readOnly: true
          example: "rep-2023-10-daily"
        periodStart:
          type: string
          format: date-time
          example: "2023-10-01T00:00:00Z"
        periodEnd:
          type: string
          format: date-time
          example: "2023-10-26T23:59:59Z"
        overallMetrics:
          type: object
          properties:
            totalGenerations:
              type: integer
              example: 5000
            averageCTR:
              type: number
              format: float
              example: 0.048
            averageConversionRate:
              type: number
              format: float
              example: 0.0021
            totalImpressions:
              type: integer
              example: 5000000
            totalConversions:
              type: integer
              example: 10500
            averageExplicitRating:
              type: number
              format: float
              example: 4.2
        metricsByCopyType:
          type: array
          items:
            type: object
            properties:
              copyType:
                type: string
                example: "social_media_post"
              averageCTR:
                type: number
                format: float
              averageConversionRate:
                type: number
                format: float
        topPerformingVariants:
          type: array
          items:
            type: object
            properties:
              variantId:
                type: string
                format: uuid
              content:
                type: string
              actualCTR:
                type: number
                format: float
              actualConversionRate:
                type: number
                format: float
          description: List of highest performing copy variants during the period.

    AIModelDetails:
      type: object
      description: Detailed information about a deployed generative AI model, including its version, training data, and key performance indicators.
      properties:
        modelId:
          type: string
          format: uuid
          readOnly: true
          example: "llm-core-v3"
        name:
          type: string
          example: "Core Generative Model"
        version:
          type: string
          example: "v3.1.2-stable"
        description:
          type: string
          example: "Third generation large language model, fine-tuned for marketing copy generation with enhanced semantic understanding."
        trainingDataSources:
          type: array
          items:
            type: string
          example: ["CommonCrawl-2023", "ProprietaryMarketingCorpus-v2"]
        lastFineTuned:
          type: string
          format: date-time
          example: "2023-10-20T09:00:00Z"
        status:
          type: string
          enum:
            - active
            - deprecated
            - in_training
            - error
          example: "active"
        performanceMetrics:
          type: object
          properties:
            perplexity:
              type: number
              format: float
              description: Perplexity score on a held-out validation set, indicating how well the model predicts samples. Lower is better.
              example: 12.5
            bleuScore:
              type: number
              format: float
              description: BLEU score for text generation quality against reference translations/summaries.
              example: 0.78
            f1ScoreSemanticMatch:
              type: number
              format: float
              description: F1 score for semantic relevance and keyword inclusion.
              example: 0.89
        availablePromptParameters:
          type: array
          items:
            type: string
          description: List of prompt parameters this model natively supports.

    FineTuningRequest:
      type: object
      description: Configuration for initiating an AI model fine-tuning job.
      required:
        - fineTuningDatasetUrl
      properties:
        fineTuningDatasetUrl:
          type: string
          format: uri
          description: URL to the dataset (e.g., JSONL format) to be used for fine-tuning.
          example: "https://your-data-store.com/brand-specific-copy-2023.jsonl"
        hyperparameters:
          type: object
          description: Optional fine-tuning hyperparameters.
          properties:
            learningRate:
              type: number
              format: float
              example: 1.0e-5
            epochs:
              type: integer
              example: 3
            batchSize:
              type: integer
              example: 8
        newModelVersionTag:
          type: string
          description: A desired tag for the new model version that will result from this fine-tuning.
          example: "llm-core-v3.1-custom-brandX"
        callbackUrl:
          type: string
          format: uri
          description: Optional URL for asynchronous notification upon job completion or failure.

    ABTestConfiguration:
      type: object
      description: Defines the parameters for a new A/B test comparing different copy variants.
      required:
        - name
        - primaryMetric
        - variants
      properties:
        testId:
          type: string
          format: uuid
          readOnly: true
          example: "ab-test-789"
        name:
          type: string
          description: A descriptive name for the A/B test.
          example: "Homepage Headline Test - Product Launch Q4"
        description:
          type: string
          description: Detailed description of the test's objective and hypothesis.
          example: "To determine which AI-generated headline performs best in terms of CTR and conversion rate on the new product landing page."
        primaryMetric:
          type: string
          enum:
            - CTR
            - CONVERSION_RATE
            - BOUNCE_RATE
            - TIME_ON_PAGE
          description: The main metric to optimize and measure statistical significance against.
          example: "CTR"
        variants:
          type: array
          minItems: 2
          items:
            type: object
            required:
              - variantName
              - content
            properties:
              variantName:
                type: string
                description: A label for this specific variant (e.g., "Control", "AI Variant 1").
                example: "AI Variant A"
              content:
                type: string
                description: The actual copy text for this variant.
                example: "Unlock Your Financial Future with AI."
              generationId:
                type: string
                format: uuid
                description: Optional reference to the `generationId` if this copy came from a previous AI generation.
              variantId:
                type: string
                format: uuid
                description: Optional reference to the `variantId` if this copy came from a previous AI generation.
          description: An array of copy variants to be tested. The first variant is typically the control.
        targetAudienceCriteria:
          type: string
          description: Description of the specific audience segment for this A/B test.
          example: "Website visitors from organic search interested in financial tools."
        durationDays:
          type: integer
          description: Suggested duration for the A/B test in days. The system may provide recommendations for sufficient sample size.
          minimum: 1
          example: 14
        trafficDistributionPercentage:
          type: object
          description: Distribution of traffic among variants. Sum must be 100.
          additionalProperties:
            type: integer
            minimum: 0
            maximum: 100
          example:
            "AI Variant A": 50
            "AI Variant B": 50
        confidenceLevel:
          type: number
          format: float
          minimum: 0.80
          maximum: 0.999
          default: 0.95
          description: The statistical confidence level (e.g., 0.95 for 95%) required to declare a winner.

    ABTestResult:
      type: object
      description: The statistical results and performance metrics for a completed or ongoing A/B test.
      properties:
        testId:
          type: string
          format: uuid
          example: "ab-test-789"
        testName:
          type: string
          example: "Homepage Headline Test - Product Launch Q4"
        status:
          type: string
          enum:
            - running
            - completed
            - inconclusive
            - error
          example: "completed"
        startDate:
          type: string
          format: date-time
          example: "2023-10-10T00:00:00Z"
        endDate:
          type: string
          format: date-time
          example: "2023-10-24T23:59:59Z"
        primaryMetric:
          type: string
          enum:
            - CTR
            - CONVERSION_RATE
            - BOUNCE_RATE
            - TIME_ON_PAGE
          example: "CTR"
        variantResults:
          type: array
          items:
            type: object
            properties:
              variantName:
                type: string
                example: "AI Variant A"
              content:
                type: string
                example: "Unlock Your Financial Future with AI."
              impressions:
                type: integer
                example: 50000
              clicks:
                type: integer
                example: 2500
              conversions:
                type: integer
                example: 100
              metricValue:
                type: number
                format: float
                description: The value of the primary metric for this variant.
                example: 0.05 # For CTR
              confidenceInterval:
                type: array
                items:
                  type: number
                  format: float
                description: [lower_bound, upper_bound] for the metric.
                example: [0.048, 0.052]
              statisticalSignificancePValue:
                type: number
                format: float
                description: P-value comparing this variant against the control. Lower indicates stronger significance.
                example: 0.015
              upliftPercentage:
                type: number
                format: float
                description: Percentage uplift compared to the control variant (if available).
                example: 15.0 # 15% better than control
        winningVariant:
          type: string
          description: Name of the statistically significant winning variant, if any.
          example: "AI Variant A"
        conclusion:
          type: string
          description: A summary of the test findings and recommendations.
          example: "AI Variant A showed a statistically significant 15% increase in CTR compared to the control, with a 95% confidence level. Recommend deploying Variant A."

    SemanticGraphDefinition:
      type: object
      description: Defines a semantic knowledge graph, including its nodes (entities) and edges (relationships).
      required:
        - name
        - nodes
        - edges
      properties:
        graphId:
          type: string
          format: uuid
          readOnly: true
          example: "skg-prod-001"
        name:
          type: string
          description: A human-readable name for the semantic graph.
          example: "Product Features SKG"
        description:
          type: string
          description: A detailed description of the graph's purpose and domain coverage.
          example: "A knowledge graph detailing features, benefits, and technical specifications of our product lines, used to ensure factual accuracy in copy."
        nodes:
          type: array
          items:
            $ref: '#/components/schemas/SemanticGraphNode'
          description: A list of nodes (entities or concepts) in the graph.
        edges:
          type: array
          items:
            $ref: '#/components/schemas/SemanticGraphEdge'
          description: A list of edges (relationships) connecting the nodes.
        version:
          type: string
          example: "1.0.0"
        lastUpdated:
          type: string
          format: date-time
          example: "2023-09-15T14:30:00Z"

    SemanticGraphNode:
      type: object
      description: A single node (entity or concept) within a semantic knowledge graph.
      required:
        - id
        - label
        - type
      properties:
        id:
          type: string
          example: "node-ai-optimizer"
          description: Unique identifier for the node.
        label:
          type: string
          example: "AI-powered Financial Optimizer"
          description: Human-readable name of the node.
        type:
          type: string
          enum: [product, feature, benefit, concept, entity, industry_term]
          example: "product"
          description: The type or category of the node.
        description:
          type: string
          description: Detailed description of the node.
          example: "A software tool that uses artificial intelligence to analyze financial data and optimize spending."
        aliases:
          type: array
          items:
            type: string
          description: Alternative names or synonyms for the node.
          example: ["Financial AI Tool", "Smart Money Saver"]

    SemanticGraphEdge:
      type: object
      description: A directed edge (relationship) between two nodes in a semantic knowledge graph.
      required:
        - source
        - target
        - relationship
      properties:
        source:
          type: string
          description: The ID of the source node.
          example: "node-ai-optimizer"
        target:
          type: string
          description: The ID of the target node.
          example: "node-capital-savings"
        relationship:
          type: string
          enum: [HAS_FEATURE, PROVIDES_BENEFIT, IS_A, RELATED_TO, AFFECTS, USES_TECHNOLOGY]
          example: "PROVIDES_BENEFIT"
          description: The type of relationship between the source and target nodes.
        weight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 1.0
          description: Strength of the relationship. Higher weight indicates stronger relevance.
          example: 0.9

    ExplainabilityConfiguration:
      type: object
      description: Global settings for how explainability insights are generated and presented.
      properties:
        defaultLevel:
          type: string
          enum:
            - basic
            - detailed
            - verbose
            - disabled
          default: "basic"
          description: The default level of detail for explainability insights.
        enableSemanticJourneyVisualization:
          type: boolean
          default: true
          description: Whether to generate and provide links to semantic journey visualizations by default.
        dataRetentionDays:
          type: integer
          minimum: 1
          maximum: 365
          default: 90
          description: Number of days to retain explainability artifacts and visualizations.
        attributionMethod:
          type: string
          enum:
            - SHAP
            - LIME
            - integrated_gradients
          default: "SHAP"
          description: The primary method used for feature attribution in explanations.

    AuditLogEntry:
      type: object
      description: A single entry in the system's audit log, capturing a significant event.
      properties:
        logId:
          type: string
          format: uuid
          readOnly: true
          example: "log-event-12345"
        timestamp:
          type: string
          format: date-time
          description: The UTC timestamp when the event occurred.
          example: "2023-10-27T11:15:30.123Z"
        actorId:
          type: string
          format: uuid
          description: The ID of the user or system component that initiated the event.
          example: "user-abc-456"
        eventType:
          type: string
          description: The type of event that occurred.
          example: "COPY_GENERATION_REQUEST"
        targetResource:
          type: string
          description: The API endpoint or resource affected by the event.
          example: "/generate-copy"
        outcome:
          type: string
          enum: [success, failure, partial_success]
          example: "success"
        details:
          type: object
          description: Additional event-specific details, such as request IDs, error messages, or changed values.
          additionalProperties: true
          example:
            generationId: "gen-xyz-789"
            status: "200 OK"
            numVariantsGenerated: 3
        ipAddress:
          type: string
          format: ipv4
          description: IP address from which the request originated.
          example: "192.168.1.100"

    CustomMetricDefinition:
      type: object
      description: Defines a custom performance metric that can be tracked and used for optimization.
      required:
        - name
        - formula
        - unit
      properties:
        metricId:
          type: string
          format: uuid
          readOnly: true
          example: "kpi-sales-001"
        name:
          type: string
          description: A descriptive name for the custom metric.
          example: "Sales Qualified Leads"
        description:
          type: string
          description: A detailed explanation of what the metric measures and its business relevance.
          example: "Measures the number of leads generated by AI copy that have been qualified by the sales team, indicating high intent."
        formula:
          type: string
          description: |
            A mathematical expression or script defining how the metric is calculated from raw event data.
            Supported operators: `+, -, *, /, LOG, EXP, IF, AND, OR`.
            Referencable raw events: `Impressions, Clicks, Conversions, TimeOnPage, Shares, Edits`.
            Example: `(Conversions * 0.5 + Leads * 0.5) / Clicks`
          example: "(Conversions * 0.7 + MQLs * 0.3) / Impressions"
        unit:
          type: string
          description: The unit of measurement for the metric (e.g., "count", "percentage", "USD").
          example: "count"
        isMonetary:
          type: boolean
          default: false
          description: True if the metric represents a monetary value.
        targetValue:
          type: number
          format: float
          description: An optional target value for this metric, used for benchmarking.
          example: 1000.0

    MetricTimeSeriesData:
      type: object
      description: Time series data for a specific metric.
      properties:
        metricId:
          type: string
          format: uuid
          example: "kpi-sales-001"
        metricName:
          type: string
          example: "Sales Qualified Leads"
        dataPoints:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
                example: "2023-10-20T00:00:00Z"
              value:
                type: number
                format: float
                example: 15.5