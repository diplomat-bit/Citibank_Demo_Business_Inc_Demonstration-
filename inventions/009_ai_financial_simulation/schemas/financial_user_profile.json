{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "FinancialUserProfile",
  "description": "Comprehensive schema for a user's financial profile, encapsulating assets, debts, income, expenses, and financial goals. This schema ensures consistent data ingestion and processing across the system. It is designed to support advanced financial simulations, scenario planning, and detailed reporting, including the generation of complex financial models, projections, and visualizations like cash flow charts, net worth trajectories, and debt amortization diagrams. The extensive detail allows for robust claims about financial health and future outcomes, backed by sophisticated mathematical equations.",
  "type": "object",
  "required": [
    "user_id",
    "personal_info",
    "accounts",
    "debts",
    "income_streams",
    "expenses",
    "financial_goals",
    "financial_health_metrics",
    "tax_information",
    "insurance_policies",
    "financial_assumptions",
    "historical_snapshots",
    "scenario_planning_parameters",
    "qualitative_financial_narrative"
  ],
  "properties": {
    "user_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the user. Essential for linking financial data across the entire system. (Supports lookup operations for any financial claim)."
    },
    "personal_info": {
      "type": "object",
      "description": "Personal demographic and risk information influencing financial decisions. These details are crucial inputs for calculating financial needs, risk-adjusted returns, and goal feasibility, often forming the basis for mathematical equations determining life insurance needs or retirement savings targets.",
      "required": [
        "age",
        "marital_status",
        "dependents",
        "risk_tolerance_score",
        "education_level",
        "employment_status",
        "housing_status",
        "retirement_age_target",
        "life_expectancy_projection",
        "financial_literacy_score"
      ],
      "properties": {
        "age": {
          "type": "integer",
          "minimum": 0,
          "description": "Age of the user in years. Used in time-value-of-money equations, retirement planning, and life insurance calculations (e.g., FV = PV * (1+r)^n where n is often related to age)."
        },
        "marital_status": {
          "type": "string",
          "enum": ["single", "married_filing_jointly", "married_filing_separately", "head_of_household", "qualifying_widow", "divorced", "partnered"],
          "description": "Marital status of the user, impacting tax calculations, joint account considerations, and shared financial goals."
        },
        "dependents": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of financial dependents. Directly influences expense calculations, insurance needs, and tax deductions. (Claim: 'More dependents increase required emergency fund size')."
        },
        "dependents_ages": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 0,
            "maximum": 120
          },
          "description": "Ages of each financial dependent, crucial for education planning and child-related expenses over time."
        },
        "risk_tolerance_score": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "User's self-assessed or derived risk tolerance score on a scale of 0 to 100. Higher scores often lead to higher equity allocations in investment portfolios. (Mermaid Chart: Risk Tolerance vs. Asset Allocation)."
        },
        "financial_literacy_score": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "An indicator of the user's understanding of financial concepts. Higher scores might correlate with better financial decisions and less need for detailed guidance."
        },
        "education_level": {
          "type": "string",
          "enum": ["high_school", "associates", "bachelors", "masters", "doctorate", "other"],
          "description": "Highest level of education attained, potentially influencing income potential and financial sophistication."
        },
        "employment_status": {
          "type": "string",
          "enum": ["employed_full_time", "employed_part_time", "self_employed", "unemployed", "retired", "student", "disabled"],
          "description": "Current employment status, critical for income stability and projection."
        },
        "occupation": {
          "type": "string",
          "description": "User's primary occupation. Useful for industry-specific income/expense benchmarks and career growth projections."
        },
        "housing_status": {
          "type": "string",
          "enum": ["owner_mortgage", "owner_no_mortgage", "renter", "living_with_family", "other"],
          "description": "Indicates homeownership status, directly impacting housing expenses and asset calculations."
        },
        "retirement_age_target": {
          "type": "integer",
          "minimum": 50,
          "maximum": 80,
          "description": "The age the user aims to retire. A key variable in retirement savings calculations. (Equation: Years_to_Retirement = Target_Retirement_Age - Current_Age)."
        },
        "life_expectancy_projection": {
          "type": "integer",
          "minimum": 70,
          "maximum": 110,
          "description": "Projected age of death, used for estimating the duration of retirement income needs and estate planning. (Claim: 'Higher life expectancy requires greater retirement savings')."
        },
        "investment_horizon_years": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "The number of years the user plans to invest for major financial goals. Influences asset allocation and risk-taking. (Mermaid Chart: Investment Horizon vs. Recommended Equity Exposure)."
        },
        "health_status_rating": {
          "type": "string",
          "enum": ["excellent", "good", "fair", "poor"],
          "description": "General self-reported health status, potentially impacting future healthcare expenses and insurance needs."
        }
      }
    },
    "accounts": {
      "type": "array",
      "description": "List of the user's financial accounts, including checking, savings, investments, and retirement. Each account represents a distinct pool of assets or a financial instrument. The aggregated data from these accounts forms the basis for net worth calculations and asset allocation charts. (Mermaid Chart: Asset Allocation Breakdown by Account Type).",
      "items": {
        "type": "object",
        "required": [
          "account_id",
          "type",
          "balance",
          "currency",
          "institution"
        ],
        "properties": {
          "account_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this specific financial account."
          },
          "type": {
            "type": "string",
            "enum": [
              "checking",
              "savings",
              "investments",
              "retirement_401k",
              "retirement_ira",
              "brokerage",
              "crypto_exchange",
              "hsa",
              "fsa",
              "educational_529"
            ],
            "description": "Type of financial account. Each type has specific attributes and tax implications. (Claim: 'Retirement accounts have tax advantages')."
          },
          "balance": {
            "type": "number",
            "minimum": 0,
            "description": "Current balance of the account. This is a snapshot value for net worth calculation. (Equation: Total Assets = SUM(Account.balance))."
          },
          "currency": {
            "type": "string",
            "description": "ISO 4217 currency code of the account balance (e.g., 'USD', 'EUR'). Essential for multi-currency profile aggregation."
          },
          "institution": {
            "type": "string",
            "description": "Name of the financial institution holding the account (e.g., 'Bank of America', 'Fidelity')."
          },
          "account_name": {
            "type": "string",
            "description": "User-friendly name for the account (e.g., 'Main Checking', 'Retirement Fund')."
          },
          "interest_rate_apy": {
            "type": "number",
            "minimum": 0,
            "description": "Annual Percentage Yield (APY) for interest-bearing accounts. Used in future value projections. (Equation: Interest_Earned = Balance * (1 + APY)^t - Balance)."
          },
          "last_statement_date": {
            "type": "string",
            "format": "date",
            "description": "Date of the last account statement, useful for data freshness tracking."
          },
          "holdings": {
            "type": "array",
            "description": "Details of investment holdings for investment, retirement, and brokerage accounts. These define the granular asset allocation. (Mermaid Chart: Portfolio Composition by Asset Class).",
            "items": {
              "type": "object",
              "required": [
                "symbol",
                "shares",
                "current_price",
                "asset_class"
              ],
              "properties": {
                "holding_id": {
                  "type": "string",
                  "format": "uuid",
                  "description": "Unique ID for each holding."
                },
                "symbol": {
                  "type": "string",
                  "description": "Ticker symbol or identifier of the holding (e.g., 'SPY', 'AAPL', 'BTC')."
                },
                "name": {
                  "type": "string",
                  "description": "Full name of the holding (e.g., 'S&P 500 ETF')."
                },
                "shares": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Number of shares or units held. Used with current_price to calculate holding value. (Equation: Holding_Value = Shares * Current_Price)."
                },
                "current_price": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Current market price per share/unit. Subject to real-time updates."
                },
                "cost_basis": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Original purchase price per share/unit. Crucial for capital gains calculations."
                },
                "acquisition_date": {
                  "type": "string",
                  "format": "date",
                  "description": "Date of acquisition, determines short-term vs. long-term capital gains."
                },
                "asset_class": {
                  "type": "string",
                  "enum": ["equity", "fixed_income", "real_estate", "commodities", "crypto", "cash_equivalent", "alternative"],
                  "description": "Broad category of the asset, used for asset allocation analysis. (Claim: 'Diversified portfolios reduce risk')."
                },
                "sub_asset_class": {
                  "type": "string",
                  "description": "More specific asset class (e.g., 'large-cap growth', 'investment-grade bonds')."
                },
                "currency": {
                  "type": "string",
                  "description": "Currency of the holding's price, if different from account currency."
                }
              }
            }
          },
          "asset_allocation_target": {
            "type": "object",
            "description": "Target asset allocation for this investment account, used for rebalancing recommendations.",
            "properties": {
              "equity_pct": {"type": "number", "minimum": 0, "maximum": 1},
              "fixed_income_pct": {"type": "number", "minimum": 0, "maximum": 1},
              "cash_pct": {"type": "number", "minimum": 0, "maximum": 1},
              "alternative_pct": {"type": "number", "minimum": 0, "maximum": 1}
            },
            "required": ["equity_pct", "fixed_income_pct", "cash_pct"]
          },
          "portfolio_rebalancing_frequency": {
            "type": "string",
            "enum": ["never", "monthly", "quarterly", "annually", "ad_hoc"],
            "description": "How often the user prefers to rebalance their portfolio."
          },
          "historical_performance_annual_pct": {
            "type": "array",
            "description": "Annualized percentage returns for previous years for this account, used for performance charting. (Mermaid Chart: Account Performance Over Time).",
            "items": {
              "type": "object",
              "properties": {
                "year": {"type": "integer", "minimum": 1900},
                "return_pct": {"type": "number"}
              },
              "required": ["year", "return_pct"]
            }
          },
          "fee_structure": {
            "type": "object",
            "description": "Details about fees associated with the account, impacting net returns. (Equation: Net_Return = Gross_Return - Fees).",
            "properties": {
              "management_fee_annual_pct": {"type": "number", "minimum": 0, "maximum": 0.1},
              "transaction_fees_per_trade": {"type": "number", "minimum": 0},
              "advisory_fee_annual_pct": {"type": "number", "minimum": 0, "maximum": 0.05}
            }
          },
          "tax_advantaged": {
            "type": "boolean",
            "description": "Indicates if the account offers tax advantages (e.g., 401k, IRA, HSA). Affects tax planning models."
          },
          "contributions_monthly": {
            "type": "number",
            "minimum": 0,
            "description": "Regular monthly contributions made to the account, particularly for retirement and savings. (Equation: Future_Value_of_Annuity = P * (((1+r)^n - 1) / r))."
          },
          "employer_match_pct": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Employer match percentage for retirement accounts (e.g., 0.05 for 5%). Represents 'free money' for the user. (Claim: 'Always maximize employer match')."
          },
          "beneficiaries": {
            "type": "array",
            "description": "List of beneficiaries designated for this account, relevant for estate planning.",
            "items": {
              "type": "object",
              "properties": {
                "name": {"type": "string"},
                "relationship": {"type": "string"},
                "percentage": {"type": "number", "minimum": 0, "maximum": 1}
              },
              "required": ["name", "relationship", "percentage"]
            }
          },
          "minimum_balance_requirement": {
            "type": "number",
            "minimum": 0,
            "description": "Minimum balance required to avoid fees or maintain certain benefits for checking/savings."
          },
          "overdraft_protection_enabled": {
            "type": "boolean",
            "description": "Whether overdraft protection is enabled for checking accounts."
          }
        },
        "allOf": [
          {
            "if": { "properties": { "type": { "const": "checking" } } },
            "then": { "required": ["institution", "minimum_balance_requirement", "overdraft_protection_enabled"] }
          },
          {
            "if": { "properties": { "type": { "const": "savings" } } },
            "then": { "required": ["interest_rate_apy"] }
          },
          {
            "if": { "properties": { "type": { "enum": ["investments", "brokerage", "crypto_exchange"] } } },
            "then": { "required": ["holdings"], "properties": {"tax_advantaged": {"const": false}} }
          },
          {
            "if": { "properties": { "type": { "enum": ["retirement_401k", "retirement_ira", "hsa", "fsa", "educational_529"] } } },
            "then": { "required": ["contributions_monthly", "tax_advantaged"], "properties": {"tax_advantaged": {"const": true}} }
          },
          {
            "if": { "properties": { "type": { "const": "retirement_401k" } } },
            "then": { "required": ["employer_match_pct"] }
          }
        ]
      }
    },
    "debts": {
      "type": "array",
      "description": "List of the user's debt obligations, such as mortgages, credit cards, and loans. Detailed debt information is crucial for calculating interest payments, projected payoff dates, and the user's debt-to-income ratio. (Mermaid Chart: Debt Amortization Schedule).",
      "items": {
        "type": "object",
        "required": [
          "debt_id",
          "type",
          "outstanding_balance",
          "monthly_payment",
          "interest_rate",
          "lender"
        ],
        "properties": {
          "debt_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this specific debt."
          },
          "type": {
            "type": "string",
            "enum": [
              "mortgage",
              "credit_card",
              "auto_loan",
              "student_loan",
              "personal_loan",
              "medical_debt",
              "home_equity_loan",
              "line_of_credit"
            ],
            "description": "Type of debt. Different types have varying interest rate structures and repayment terms."
          },
          "outstanding_balance": {
            "type": "number",
            "minimum": 0,
            "description": "Remaining principal balance on the debt. (Equation: Total_Debts = SUM(Debt.outstanding_balance))."
          },
          "monthly_payment": {
            "type": "number",
            "minimum": 0,
            "description": "Required minimum monthly payment. Used in cash flow analysis. (Claim: 'Paying more than the minimum reduces total interest paid')."
          },
          "interest_rate": {
            "type": "number",
            "minimum": 0,
            "description": "Annual interest rate (APR) on the debt. Higher rates increase the cost of debt. (Equation: Monthly_Interest_Payment = Outstanding_Balance * (APR/12))."
          },
          "origination_date": {
            "type": "string",
            "format": "date",
            "description": "Date when the debt was originated. Useful for tracking debt age."
          },
          "term_years": {
            "type": "integer",
            "minimum": 0,
            "description": "Remaining term of the loan in years, relevant for amortized debts like mortgages and auto loans. (Equation: Remaining_Months = Term_Years * 12)."
          },
          "original_loan_amount": {
            "type": "number",
            "minimum": 0,
            "description": "The initial amount borrowed when the debt was taken out."
          },
          "limit": {
            "type": "number",
            "minimum": 0,
            "description": "Credit limit for revolving debts like credit cards or lines of credit."
          },
          "lender": {
            "type": "string",
            "description": "Name of the financial institution or entity that holds the debt."
          },
          "collateral_value": {
            "type": "number",
            "minimum": 0,
            "description": "Value of the asset securing the loan (e.g., home for mortgage, car for auto loan). Important for secured debts."
          },
          "prepayment_penalty": {
            "type": "boolean",
            "description": "Indicates if there is a penalty for paying off the debt early. Affects accelerated repayment strategies."
          },
          "debt_consolidation_potential": {
            "type": "boolean",
            "description": "Flag indicating if this debt is a candidate for consolidation, often based on high interest rates."
          },
          "payment_history_summary": {
            "type": "object",
            "description": "Summary of payment behavior for this debt.",
            "properties": {
              "last_payment_date": {"type": "string", "format": "date"},
              "last_payment_amount": {"type": "number", "minimum": 0},
              "on_time_payment_ratio": {"type": "number", "minimum": 0, "maximum": 1},
              "number_of_late_payments": {"type": "integer", "minimum": 0}
            }
          },
          "repayment_strategy": {
            "type": "string",
            "enum": ["minimum_payment", "snowball", "avalanche", "custom"],
            "description": "Preferred strategy for debt repayment, influencing simulation outcomes. (Claim: 'Avalanche strategy saves the most interest')."
          }
        },
        "allOf": [
          {
            "if": { "properties": { "type": { "const": "mortgage" } } },
            "then": { "required": ["term_years", "collateral_value", "origination_date", "original_loan_amount"] }
          },
          {
            "if": { "properties": { "type": { "const": "credit_card" } } },
            "then": { "required": ["limit"] }
          },
          {
            "if": { "properties": { "type": { "const": "auto_loan" } } },
            "then": { "required": ["term_years", "collateral_value", "origination_date"] }
          },
          {
            "if": { "properties": { "type": { "const": "home_equity_loan" } } },
            "then": { "required": ["term_years", "collateral_value", "origination_date"] }
          },
          {
            "if": { "properties": { "type": { "const": "line_of_credit" } } },
            "then": { "required": ["limit"] }
          }
        ]
      }
    },
    "income_streams": {
      "type": "array",
      "description": "List of the user's various sources of income. Detailed income data is vital for cash flow analysis, budgeting, and future income projections. (Mermaid Chart: Income Breakdown by Source).",
      "items": {
        "type": "object",
        "required": [
          "income_id",
          "source",
          "amount_monthly",
          "frequency",
          "tax_bracket"
        ],
        "properties": {
          "income_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this specific income stream."
          },
          "source": {
            "type": "string",
            "description": "Source of income (e.g., 'salary', 'freelance', 'rental_income', 'dividends', 'social_security', 'pension')."
          },
          "employer_name": {
            "type": "string",
            "description": "Name of the employer if the source is salary/wage."
          },
          "amount_monthly": {
            "type": "number",
            "minimum": 0,
            "description": "Gross amount of income received monthly (pre-tax). Used to calculate total gross income. (Equation: Gross_Annual_Income = SUM(Income.amount_monthly * 12 / Frequency_Factor))."
          },
          "frequency": {
            "type": "string",
            "enum": [
              "monthly",
              "bi-weekly",
              "weekly",
              "annually",
              "quarterly",
              "one-time"
            ],
            "description": "Frequency of income payments, used to normalize to a monthly equivalent."
          },
          "gross_annual_salary": {
            "type": "number",
            "minimum": 0,
            "description": "Total annual gross salary from this source, if applicable. Helps with consistency."
          },
          "bonus_expected_annual": {
            "type": "number",
            "minimum": 0,
            "description": "Expected annual bonus amount, treated as variable income."
          },
          "commission_structure_pct": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Percentage of sales/performance attributed to commission, for sales-based roles."
          },
          "stock_options_details": {
            "type": "object",
            "description": "Details about stock options or restricted stock units (RSUs) if part of compensation.",
            "properties": {
              "company_symbol": {"type": "string"},
              "vesting_schedule_years": {"type": "integer", "minimum": 0},
              "vested_shares_count": {"type": "integer", "minimum": 0},
              "unvested_shares_count": {"type": "integer", "minimum": 0},
              "strike_price": {"type": "number", "minimum": 0}
            }
          },
          "pension_details": {
            "type": "object",
            "description": "Details for pension income, if applicable.",
            "properties": {
              "start_age": {"type": "integer", "minimum": 0},
              "annual_payout_amount": {"type": "number", "minimum": 0},
              "cost_of_living_adjustment_pct": {"type": "number", "minimum": 0, "maximum": 0.1}
            }
          },
          "tax_bracket": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "User's estimated marginal tax bracket (as a decimal, e.g., 0.22) for this income source. Used in net income calculations. (Equation: Net_Income = Gross_Income * (1 - Tax_Rate))."
          },
          "deductions_monthly": {
            "type": "object",
            "description": "Pre-tax and post-tax deductions from this income stream.",
            "properties": {
              "federal_taxes": {"type": "number", "minimum": 0},
              "state_taxes": {"type": "number", "minimum": 0},
              "social_security": {"type": "number", "minimum": 0},
              "medicare": {"type": "number", "minimum": 0},
              "health_insurance_premium": {"type": "number", "minimum": 0},
              "retirement_contributions": {"type": "number", "minimum": 0},
              "other_deductions": {"type": "number", "minimum": 0}
            }
          },
          "net_amount_monthly": {
            "type": "number",
            "minimum": 0,
            "description": "Calculated net amount of income received monthly after all deductions. (Equation: Net_Amount = Gross_Amount - SUM(Deductions))."
          },
          "volatility_factor": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Factor indicating the volatility or unpredictability of this income source (0 for stable, 1 for highly volatile). Higher volatility implies greater need for emergency funds. (Claim: 'Highly volatile income requires larger cash reserves')."
          },
          "growth_projection_annual_pct": {
            "type": "number",
            "description": "Projected annual growth rate for this income stream (e.g., 0.05 for 5% growth). Used for long-term income projections. (Equation: Future_Income = Current_Income * (1 + Growth_Rate)^Years)."
          },
          "inflation_adjusted_growth": {
            "type": "boolean",
            "description": "If true, the growth projection is assumed to be above inflation."
          }
        }
      }
    },
    "expenses": {
      "type": "object",
      "description": "Categorized monthly expenses for budgeting and simulation. Accurate expense tracking is paramount for cash flow analysis, identifying savings opportunities, and projecting future financial needs. (Mermaid Chart: Monthly Expense Breakdown).",
      "required": [
        "housing",
        "food",
        "transportation",
        "utilities",
        "healthcare_monthly",
        "discretionary",
        "fixed_monthly_expenses",
        "variable_monthly_expenses",
        "total_monthly_net"
      ],
      "properties": {
        "housing": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly housing expenses (rent/mortgage payment, property taxes, HOA fees). Usually a fixed expense."
        },
        "food": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly food expenses (groceries, dining out). Often a variable expense."
        },
        "transportation": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly transportation costs (car payments, fuel, public transit, insurance, maintenance). Can be a mix of fixed and variable."
        },
        "utilities": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly utility bills (electricity, water, internet, gas, garbage). Often variable based on usage."
        },
        "discretionary": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly discretionary spending (entertainment, hobbies, shopping, travel). Highly variable and often targeted for savings."
        },
        "healthcare_monthly": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly healthcare-related expenses (premiums, co-pays, prescriptions not covered by insurance). Can fluctuate."
        },
        "education": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly education expenses (tuition, student loan payments for self or dependents, school supplies)."
        },
        "childcare": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly childcare costs (daycare, babysitters, after-school programs)."
        },
        "pets": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly expenses related to pets (food, vet, grooming)."
        },
        "personal_care": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly personal care expenses (haircuts, cosmetics, gym memberships)."
        },
        "clothing": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly expenses for clothing and accessories."
        },
        "donations": {
          "type": "number",
          "minimum": 0,
          "description": "Monthly charitable contributions or donations."
        },
        "subscriptions_monthly": {
          "type": "object",
          "description": "Details on recurring monthly subscriptions.",
          "properties": {
            "streaming_services": {"type": "number", "minimum": 0},
            "software_subscriptions": {"type": "number", "minimum": 0},
            "gym_memberships": {"type": "number", "minimum": 0},
            "other_subscriptions": {"type": "number", "minimum": 0}
          }
        },
        "insurance_premiums_monthly": {
          "type": "object",
          "description": "Monthly insurance premiums paid (excluding those deducted from income).",
          "properties": {
            "auto": {"type": "number", "minimum": 0},
            "home": {"type": "number", "minimum": 0},
            "life": {"type": "number", "minimum": 0},
            "disability": {"type": "number", "minimum": 0},
            "other": {"type": "number", "minimum": 0}
          }
        },
        "miscellaneous": {
          "type": "number",
          "minimum": 0,
          "description": "Catch-all for other monthly expenses not fitting into specific categories."
        },
        "fixed_monthly_expenses": {
          "type": "number",
          "minimum": 0,
          "description": "Sum of all fixed monthly expenses (e.g., rent, loan payments). Important for calculating financial flexibility. (Claim: 'Lower fixed expenses mean greater financial resilience')."
        },
        "variable_monthly_expenses": {
          "type": "number",
          "minimum": 0,
          "description": "Sum of all variable monthly expenses (e.g., food, entertainment). These are often areas for potential savings."
        },
        "annual_discretionary_spending_limit": {
          "type": "number",
          "minimum": 0,
          "description": "An optional annual budget limit for discretionary spending."
        },
        "seasonal_expense_factors": {
          "type": "object",
          "description": "Multipliers for expenses during specific seasons (e.g., higher utilities in winter, higher travel in summer).",
          "patternProperties": {
            "^[a-zA-Z]+$": {"type": "number", "minimum": 0.5, "maximum": 2.0}
          },
          "additionalProperties": false
        },
        "expense_growth_rate_annual_pct": {
          "type": "number",
          "minimum": 0,
          "description": "Projected annual growth rate for overall expenses, often tied to inflation. (Equation: Future_Expense = Current_Expense * (1 + Growth_Rate)^Years)."
        },
        "total_monthly_net": {
          "type": "number",
          "minimum": 0,
          "description": "Total calculated net monthly expenses (after adjusting for any specific categorizations). This field is typically derived/computed and not directly input. (Equation: Total_Monthly_Expenses = Housing + Food + ... + Miscellaneous)."
        }
      }
    },
    "financial_goals": {
      "type": "array",
      "description": "List of the user's defined financial goals with target amounts and dates. Goals drive financial planning and provide targets for simulations. (Mermaid Chart: Goal Progress Tracker).",
      "items": {
        "type": "object",
        "required": [
          "goal_id",
          "name",
          "target_amount",
          "target_date",
          "current_progress_pct",
          "priority",
          "goal_type"
        ],
        "properties": {
          "goal_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this specific financial goal."
          },
          "name": {
            "type": "string",
            "description": "Name or description of the financial goal (e.g., 'retirement', 'down_payment_house', 'emergency_fund', 'child_education_john')."
          },
          "goal_type": {
            "type": "string",
            "enum": ["short_term", "mid_term", "long_term", "legacy", "emergency"],
            "description": "Categorization of the goal by its time horizon. Short-term typically <3 years, mid-term 3-10 years, long-term >10 years."
          },
          "target_amount": {
            "type": "number",
            "minimum": 0,
            "description": "Target financial amount for the goal. This is the ultimate savings objective. (Equation: Amount_Remaining = Target_Amount - Current_Savings)."
          },
          "target_date": {
            "type": "string",
            "format": "date",
            "description": "Target date for achieving the goal in YYYY-MM-DD format. Defines the timeline for contributions. (Claim: 'Earlier start dates make goals easier to achieve')."
          },
          "current_progress_pct": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Current progress towards the goal as a percentage (0.0 to 1.0). Derived from current savings vs. target. (Equation: Progress_Pct = Current_Savings / Target_Amount)."
          },
          "current_saved_amount": {
            "type": "number",
            "minimum": 0,
            "description": "The absolute amount currently saved towards this goal."
          },
          "priority": {
            "type": "string",
            "enum": [
              "low",
              "medium",
              "high",
              "critical"
            ],
            "description": "Priority level of the goal. High priority goals receive more aggressive savings recommendations."
          },
          "contributing_accounts": {
            "type": "array",
            "description": "List of account IDs that are actively contributing to or holding funds for this goal. Enables tracking specific goal savings.",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "required_monthly_contribution": {
            "type": "number",
            "minimum": 0,
            "description": "Calculated monthly contribution needed to reach the goal by the target date, assuming a certain rate of return. (Equation: Pmt = (FV * r) / ((1 + r)^n - 1) for future value annuity)."
          },
          "projected_completion_date": {
            "type": "string",
            "format": "date",
            "description": "The date when the goal is projected to be completed based on current contributions and expected returns. (Mermaid Chart: Goal Attainment Projection)."
          },
          "inflation_adjustment_factor": {
            "type": "number",
            "minimum": 1,
            "description": "Factor to adjust the target amount for inflation, ensuring purchasing power. (Equation: Inflation_Adjusted_Target = Target * (1 + Inflation_Rate)^Years)."
          },
          "risk_level_associated": {
            "type": "string",
            "enum": ["conservative", "moderate", "aggressive"],
            "description": "Recommended investment risk level for funds allocated to this specific goal, based on time horizon and priority."
          },
          "notes": {
            "type": "string",
            "description": "Any additional notes or context for the financial goal."
          }
        }
      }
    },
    "financial_health_metrics": {
      "type": "object",
      "description": "Calculated key performance indicators (KPIs) of the user's financial health. These are derived from other parts of the profile and provide a snapshot of financial well-being, often used for dashboard visualizations. (Mermaid Chart: Financial Health Dashboard).",
      "required": [
        "net_worth",
        "liquid_net_worth",
        "savings_rate_pct",
        "debt_to_income_ratio",
        "emergency_fund_months",
        "financial_independence_ratio",
        "retirement_readiness_score",
        "credit_score"
      ],
      "properties": {
        "net_worth": {
          "type": "number",
          "description": "Total assets minus total debts. The fundamental measure of financial standing. (Equation: Net_Worth = Total_Assets - Total_Debts)."
        },
        "liquid_net_worth": {
          "type": "number",
          "description": "Net worth considering only easily accessible assets (e.g., cash, savings, easily sold investments) minus debts. Important for short-term liquidity."
        },
        "total_assets": {
          "type": "number",
          "description": "Sum of all assets (balances from all accounts)."
        },
        "total_debts": {
          "type": "number",
          "description": "Sum of all outstanding debt balances."
        },
        "savings_rate_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Percentage of net income that is saved or invested. A high savings rate accelerates goal achievement. (Equation: Savings_Rate = (Total_Savings_Contributions / Total_Net_Income)). (Claim: 'A 15% savings rate is recommended for retirement')."
        },
        "debt_to_income_ratio": {
          "type": "number",
          "minimum": 0,
          "description": "Total monthly debt payments divided by gross monthly income. A lower ratio indicates better financial health. (Equation: DTI = (Total_Monthly_Debt_Payments / Total_Gross_Monthly_Income))."
        },
        "emergency_fund_months": {
          "type": "number",
          "minimum": 0,
          "description": "Number of months worth of essential expenses covered by liquid savings. (Equation: Emergency_Fund_Months = Liquid_Cash / Essential_Monthly_Expenses). (Claim: '3-6 months of expenses in an emergency fund is ideal')."
        },
        "financial_independence_ratio": {
          "type": "number",
          "minimum": 0,
          "description": "Ratio of passive income to total expenses. A ratio > 1 indicates financial independence."
        },
        "retirement_readiness_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "A composite score indicating how well the user is tracking towards their retirement goal."
        },
        "credit_score": {
          "type": "integer",
          "minimum": 300,
          "maximum": 850,
          "description": "User's estimated or actual credit score. Impacts loan rates and financial opportunities."
        },
        "cash_flow_monthly_surplus": {
          "type": "number",
          "description": "Net monthly income minus total monthly expenses. Positive indicates surplus, negative indicates deficit. (Equation: Cash_Flow = Total_Net_Income - Total_Monthly_Expenses). (Mermaid Chart: Monthly Cash Flow)."
        },
        "investment_return_ytd_pct": {
          "type": "number",
          "description": "Year-to-date return percentage across all investment accounts."
        }
      }
    },
    "tax_information": {
      "type": "object",
      "description": "Detailed information relevant for tax planning and estimation. This data is critical for accurate net income calculations and understanding tax liabilities over time. (Claim: 'Understanding tax deductions can significantly reduce your tax burden').",
      "required": [
        "filing_status",
        "federal_tax_bracket_pct",
        "state_tax_bracket_pct"
      ],
      "properties": {
        "filing_status": {
          "type": "string",
          "enum": ["single", "married_filing_jointly", "married_filing_separately", "head_of_household", "qualifying_widow"],
          "description": "User's tax filing status, which determines tax rates and standard deductions."
        },
        "federal_tax_bracket_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.5,
          "description": "User's estimated federal marginal tax bracket percentage. (Equation: Federal_Tax = Taxable_Income * Federal_Rate)."
        },
        "state_tax_bracket_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.2,
          "description": "User's estimated state marginal tax bracket percentage. Can be 0 if no state income tax."
        },
        "long_term_capital_gains_tax_rate_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.3,
          "description": "Estimated long-term capital gains tax rate."
        },
        "short_term_capital_gains_tax_rate_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.5,
          "description": "Estimated short-term capital gains tax rate (often same as ordinary income tax rate)."
        },
        "itemized_deductions_annual": {
          "type": "number",
          "minimum": 0,
          "description": "Total estimated annual itemized deductions, if applicable and greater than standard deduction."
        },
        "standard_deduction_amount": {
          "type": "number",
          "minimum": 0,
          "description": "Current applicable standard deduction amount based on filing status."
        },
        "tax_credits_available_annual": {
          "type": "number",
          "minimum": 0,
          "description": "Estimated annual tax credits that directly reduce tax liability."
        },
        "tax_loss_carryforward_amount": {
          "type": "number",
          "description": "Amount of investment losses that can be carried forward to offset future gains or income."
        },
        "estimated_quarterly_tax_payments": {
          "type": "number",
          "minimum": 0,
          "description": "Amount of estimated tax paid quarterly, relevant for self-employed individuals."
        }
      }
    },
    "insurance_policies": {
      "type": "array",
      "description": "Details about various insurance policies held by the user. Insurance is a critical component of risk management and financial protection. (Claim: 'Adequate insurance protects against unforeseen financial shocks').",
      "items": {
        "type": "object",
        "required": [
          "policy_id",
          "type",
          "provider",
          "premium_monthly",
          "coverage_amount"
        ],
        "properties": {
          "policy_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this insurance policy."
          },
          "type": {
            "type": "string",
            "enum": ["life", "health", "auto", "homeowners", "renters", "disability", "long_term_care", "umbrella"],
            "description": "Type of insurance policy."
          },
          "provider": {
            "type": "string",
            "description": "Name of the insurance provider."
          },
          "premium_monthly": {
            "type": "number",
            "minimum": 0,
            "description": "Monthly premium payment for this policy. (Equation: Annual_Premium = Monthly_Premium * 12)."
          },
          "coverage_amount": {
            "type": "number",
            "minimum": 0,
            "description": "Total coverage amount provided by the policy. E.g., death benefit for life insurance, dwelling coverage for home insurance."
          },
          "deductible": {
            "type": "number",
            "minimum": 0,
            "description": "The amount the insured must pay out-of-pocket before the insurance company pays."
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "description": "The date the policy became active."
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "description": "The date the policy expires, if applicable."
          },
          "beneficiaries": {
            "type": "array",
            "description": "For life insurance, details of beneficiaries.",
            "items": {
              "type": "object",
              "properties": {
                "name": {"type": "string"},
                "relationship": {"type": "string"},
                "percentage": {"type": "number", "minimum": 0, "maximum": 1}
              }
            }
          },
          "policy_details_url": {
            "type": "string",
            "format": "uri",
            "description": "URL to access more details about the policy."
          }
        },
        "allOf": [
          {
            "if": { "properties": { "type": { "const": "life" } } },
            "then": { "required": ["beneficiaries"] }
          },
          {
            "if": { "properties": { "type": { "enum": ["health", "auto", "homeowners", "renters"] } } },
            "then": { "required": ["deductible"] }
          }
        ]
      }
    },
    "financial_assumptions": {
      "type": "object",
      "description": "Key economic and market assumptions used for long-term financial projections and simulations. These are crucial inputs for mathematical models. (Mermaid Chart: Sensitivity Analysis to Inflation and Market Returns).",
      "required": [
        "inflation_rate_annual_pct",
        "market_return_annual_avg_pct",
        "retirement_spending_inflation_adjust_pct",
        "longevity_assumption_years",
        "healthcare_cost_growth_annual_pct",
        "emergency_fund_target_months"
      ],
      "properties": {
        "inflation_rate_annual_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.1,
          "description": "Assumed average annual inflation rate. Impacts future purchasing power and goal targets. (Equation: Real_Return = (1 + Nominal_Return) / (1 + Inflation_Rate) - 1)."
        },
        "market_return_annual_avg_pct": {
          "type": "number",
          "minimum": -0.05,
          "maximum": 0.15,
          "description": "Assumed average annual return percentage for investments. Used in future value calculations. (Claim: 'Historical market returns are not indicative of future results, but are useful for planning')."
        },
        "conservative_market_return_pct": {
          "type": "number",
          "minimum": -0.05,
          "maximum": 0.1,
          "description": "A more conservative estimate for market returns, used in stress testing scenarios."
        },
        "retirement_spending_inflation_adjust_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.05,
          "description": "Annual percentage adjustment for retirement spending to account for rising costs."
        },
        "longevity_assumption_years": {
          "type": "integer",
          "minimum": 70,
          "maximum": 110,
          "description": "Assumed age for living, used for retirement planning horizon. Should ideally align with `personal_info.life_expectancy_projection`."
        },
        "healthcare_cost_growth_annual_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.1,
          "description": "Projected annual growth rate for healthcare costs, often higher than general inflation."
        },
        "emergency_fund_target_months": {
          "type": "integer",
          "minimum": 1,
          "maximum": 12,
          "description": "The target number of months of essential expenses to hold in an emergency fund."
        },
        "social_security_payout_reduction_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 0.3,
          "description": "Assumed percentage reduction in future social security benefits, for conservative planning."
        }
      }
    },
    "historical_snapshots": {
      "type": "array",
      "description": "A collection of periodic snapshots of key financial metrics, enabling time-series analysis and tracking of progress. This data is essential for generating trend charts and historical performance claims. (Mermaid Chart: Net Worth Trajectory Over Time).",
      "items": {
        "type": "object",
        "required": [
          "snapshot_date",
          "net_worth_snapshot",
          "total_assets_snapshot",
          "total_debts_snapshot",
          "total_income_snapshot",
          "total_expenses_snapshot"
        ],
        "properties": {
          "snapshot_date": {
            "type": "string",
            "format": "date",
            "description": "The date this financial snapshot was taken (e.g., end of month, end of quarter)."
          },
          "net_worth_snapshot": {
            "type": "number",
            "description": "Net worth on the snapshot date."
          },
          "total_assets_snapshot": {
            "type": "number",
            "description": "Total assets on the snapshot date."
          },
          "total_debts_snapshot": {
            "type": "number",
            "description": "Total debts on the snapshot date."
          },
          "total_income_snapshot": {
            "type": "number",
            "description": "Total income for the period leading up to the snapshot (e.g., monthly income)."
          },
          "total_expenses_snapshot": {
            "type": "number",
            "description": "Total expenses for the period leading up to the snapshot (e.g., monthly expenses)."
          },
          "liquid_assets_snapshot": {
            "type": "number",
            "description": "Liquid assets on the snapshot date."
          },
          "savings_rate_snapshot_pct": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Savings rate for the period leading up to the snapshot."
          }
        }
      }
    },
    "scenario_planning_parameters": {
      "type": "array",
      "description": "Defines parameters for various 'what-if' financial scenarios, allowing the user to explore different outcomes based on changes in life events or market conditions. Each scenario forms the basis for a distinct simulation and set of claims. (Mermaid Chart: Scenario Comparison - Net Worth).",
      "items": {
        "type": "object",
        "required": ["scenario_id", "name", "description", "event_trigger_year"],
        "properties": {
          "scenario_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the scenario."
          },
          "name": {
            "type": "string",
            "description": "Name of the scenario (e.g., 'Early Retirement', 'Job Loss', 'Market Crash', 'New Child')."
          },
          "description": {
            "type": "string",
            "description": "Detailed description of the scenario and its implications. (Claim: 'In the 'Job Loss' scenario, emergency fund depletion occurs in X months')."
          },
          "event_trigger_year": {
            "type": "integer",
            "description": "The year in which the scenario's primary event is assumed to occur relative to the current year."
          },
          "income_adjustments": {
            "type": "array",
            "description": "Changes to income streams for this scenario.",
            "items": {
              "type": "object",
              "properties": {
                "income_stream_id": {"type": "string", "format": "uuid"},
                "adjustment_type": {"type": "string", "enum": ["add", "remove", "percentage_change", "absolute_change"]},
                "value": {"type": "number"},
                "duration_years": {"type": "integer", "minimum": 0}
              },
              "required": ["income_stream_id", "adjustment_type", "value"]
            }
          },
          "expense_adjustments": {
            "type": "array",
            "description": "Changes to expense categories for this scenario.",
            "items": {
              "type": "object",
              "properties": {
                "expense_category": {"type": "string"},
                "adjustment_type": {"type": "string", "enum": ["percentage_change", "absolute_change"]},
                "value": {"type": "number"},
                "duration_years": {"type": "integer", "minimum": 0}
              },
              "required": ["expense_category", "adjustment_type", "value"]
            }
          },
          "investment_return_override_pct": {
            "type": "number",
            "description": "Override the default market return assumption for this scenario (e.g., during a market crash)."
          },
          "debt_restructuring_details": {
            "type": "array",
            "description": "Details if debts are restructured in this scenario.",
            "items": {
              "type": "object",
              "properties": {
                "debt_id": {"type": "string", "format": "uuid"},
                "new_interest_rate": {"type": "number"},
                "new_term_years": {"type": "integer"}
              },
              "required": ["debt_id"]
            }
          },
          "new_major_purchase": {
            "type": "object",
            "description": "Details of a major purchase in the scenario (e.g., new home).",
            "properties": {
              "name": {"type": "string"},
              "cost": {"type": "number"},
              "downpayment_pct": {"type": "number", "minimum": 0, "maximum": 1},
              "loan_details": {
                "type": "object",
                "properties": {
                  "interest_rate": {"type": "number"},
                  "term_years": {"type": "integer"}
                }
              }
            }
          }
        }
      }
    },
    "qualitative_financial_narrative": {
      "type": "object",
      "description": "Open-ended textual descriptions and subjective assessments of the user's financial situation, aspirations, and concerns. This allows for capturing nuanced 'claims' and personal context not easily quantifiable.",
      "properties": {
        "current_financial_concerns": {
          "type": "array",
          "items": {"type": "string"},
          "description": "List of the user's current primary financial worries (e.g., 'paying off credit card debt', 'saving for retirement', 'market volatility')."
        },
        "short_term_aspirations": {
          "type": "string",
          "description": "Free-form text describing financial aspirations for the next 1-3 years."
        },
        "long_term_vision": {
          "type": "string",
          "description": "Free-form text describing financial vision beyond 10 years (e.g., 'financial independence', 'leaving a legacy')."
        },
        "financial_personality_notes": {
          "type": "string",
          "description": "Any notes on the user's financial personality, habits, or biases that could impact planning."
        },
        "estate_planning_status": {
          "type": "string",
          "enum": ["none", "basic_will", "trust_in_place", "advanced_planning"],
          "description": "Current status of estate planning efforts."
        },
        "risk_perception_narrative": {
          "type": "string",
          "description": "User's own words describing their perception of financial risk."
        }
      }
    }
  }
}