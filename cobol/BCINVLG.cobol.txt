```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. BCINVLG.
       AUTHOR. AI-DRIVEN-SERVICES.
      ******************************************************************
      * AI-DRIVEN LEDGER INTEGRATION - INVOICE BLOCKCHAIN LOGGER
      * This program processes invoice data, performs AI-assisted
      * validation, calculates a cryptographic hash, and logs the
      * validated invoice record to a distributed ledger simulation
      * for immutable record-keeping. The AI component acts as a
      * Digital Integrity Agent, ensuring data quality and trust
      * within the mainframe transaction flow.
      *
      * SYSTEM PROMPT:
      * This COBOL program now incorporates the idgafAI system prompt
      * to enhance the AI Digital Integrity Agent's behavior. The AI's
      * pre-validation logic adheres to the principles defined in
      * 'prompts/idgafai_full.txt' (or a similar specified file).
      * The goal is to ensure clarity, evidence-based decisions, and
      * alignment with the user's objectives while maintaining
      * uncompromising integrity in data validation and ledger logging.
      *
      * For details of idgafAI's operational philosophy, see
      * the prompt specification document.
      ******************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INVOICE-INPUT-FILE ASSIGN TO 'INVFILE.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL.

           SELECT LEDGER-OUTPUT-FILE ASSIGN TO 'LEDGER.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL.

           SELECT AI-LOG-FILE ASSIGN TO 'AILOG.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD  INVOICE-INPUT-FILE
           RECORD CONTAINS 200 CHARACTERS
           DATA RECORD IS INVOICE-RECORD-IN.
       01  INVOICE-RECORD-IN.
           05  INV-ID-IN           PIC X(10).
           05  CUSTOMER-ID-IN      PIC X(10).
           05  INV-DATE-IN         PIC 9(8).
           05  INV-AMOUNT-IN       PIC 9(9)V99.
           05  INV-DESC-IN         PIC X(80).
           05  INV-STATUS-IN       PIC X(10).
           05  FILLER              PIC X(71).

       FD  LEDGER-OUTPUT-FILE
           RECORD CONTAINS 250 CHARACTERS
           DATA RECORD IS LEDGER-RECORD-OUT.
       01  LEDGER-RECORD-OUT.
           05  LEDGER-ENTRY-ID-OUT PIC 9(12).
           05  ORIGINAL-INV-ID-OUT PIC X(10).
           05  LEDGER-TIMESTAMP-OUT PIC 9(14).
           05  INV-HASH-VALUE-OUT  PIC X(64).
           05  AI-ASSESSMENT-OUT   PIC X(20).
           05  LEDGER-STATUS-OUT   PIC X(10).
           05  FILLER              PIC X(134).

       FD  AI-LOG-FILE
           RECORD CONTAINS 150 CHARACTERS
           DATA RECORD IS AI-LOG-RECORD-OUT.
       01  AI-LOG-RECORD-OUT.
           05  AI-LOG-TIMESTAMP    PIC 9(14).
           05  AI-LOG-INV-ID       PIC X(10).
           05  AI-LOG-MESSAGE      PIC X(120).
           05  FILLER              PIC X(6).

       WORKING-STORAGE SECTION.
       01  WS-PROGRAM-SWITCHES.
           05  WS-INVOICE-FILE-STATUS PIC X(02) VALUE '00'.
               88  INVOICE-FILE-EOF        VALUE '10'.
               88  INVOICE-FILE-OK         VALUE '00'.
           05  WS-LEDGER-FILE-STATUS  PIC X(02) VALUE '00'.
           05  WS-AI-LOG-FILE-STATUS  PIC X(02) VALUE '00'.
           05  WS-ERROR-FOUND-FLAG    PIC X(01) VALUE 'N'.
               88  ERROR-FOUND             VALUE 'Y'.

       01  WS-CURRENT-DATETIME.
           05  WS-CURRENT-DATE-PART.
               10  WS-CURRENT-YY   PIC 9(04).
               10  WS-CURRENT-MM   PIC 9(02).
               10  WS-CURRENT-DD   PIC 9(02).
           05  WS-CURRENT-TIME-PART.
               10  WS-CURRENT-HH   PIC 9(02).
               10  WS-CURRENT-MI   PIC 9(02).
               10  WS-CURRENT-SS   PIC 9(02).
               10  WS-CURRENT-MS   PIC 9(02).

       01  WS-INVOICE-DATA-AREA.
           05  WS-INV-ID           PIC X(10).
           05  WS-CUSTOMER-ID      PIC X(10).
           05  WS-INV-DATE         PIC 9(8).
           05  WS-INV-AMOUNT       PIC 9(9)V99.
           05  WS-INV-DESC         PIC X(80).
           05  WS-INV-STATUS       PIC X(10).

       01  WS-LEDGER-DATA-AREA.
           05  WS-LEDGER-ENTRY-ID  PIC 9(12).
           05  WS-ORIGINAL-INV-ID  PIC X(10).
           05  WS-LEDGER-TIMESTAMP PIC 9(14).
           05  WS-INV-HASH-VALUE   PIC X(64).
           05  WS-AI-ASSESSMENT    PIC X(20).
               88  AI-ASSESSMENT-CLEAN VALUE 'CLEAN'.
               88  AI-ASSESSMENT-REVIEW VALUE 'REVIEW'.
               88  AI-ASSESSMENT-FLAGGED VALUE 'FLAGGED'.
           05  WS-LEDGER-STATUS    PIC X(10).
               88  LEDGER-STATUS-COMMITTED VALUE 'COMMITTED'.
               88  LEDGER-STATUS-PENDING   VALUE 'PENDING'.
               88  LEDGER-STATUS-REJECTED  VALUE 'REJECTED'.

       01  WS-HASH-GENERATION-AREA.
           05  WS-TEMP-HASH-STRING PIC X(200).
           05  WS-SIMULATED-HASH-NUM PIC 9(64).
           05  WS-SIMULATED-HASH-STR PIC X(64).

       01  WS-AI-ANALYSIS-AREA.
           05  WS-AI-ANOMALY-FLAG  PIC X(01) VALUE 'N'.
           05  WS-AI-VALIDATION-MSG PIC X(100) VALUE SPACES.
           05  WS-AI-RISK-SCORE    PIC 9(03) VALUE ZEROS.
           05  WS-AI-SUGGESTION    PIC X(50) VALUE SPACES.

       01  WS-COUNTERS.
           05  WS-INVOICE-COUNT    PIC 9(05) VALUE ZEROS.
           05  WS-LEDGER-COUNT     PIC 9(05) VALUE ZEROS.
           05  WS-ANOMALY-COUNT    PIC 9(05) VALUE ZEROS.
           05  WS-LEDGER-SEQUENCE  PIC 9(12) VALUE 100000000000.

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM 1000-INITIALIZE-PROGRAM
           PERFORM 2000-PROCESS-INVOICES
               UNTIL INVOICE-FILE-EOF
           PERFORM 3000-FINALIZE-PROGRAM
           STOP RUN.

       1000-INITIALIZE-PROGRAM.
           DISPLAY " "
           DISPLAY "AI-DRIVEN LEDGER INTEGRATION - INVOICE LOGGER STARTING...".
           DISPLAY " "

           OPEN INPUT INVOICE-INPUT-FILE
               IF WS-INVOICE-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Could not open INVOICE-INPUT-FILE. Status: "
                           WS-INVOICE-FILE-STATUS
                   MOVE 'Y' TO WS-ERROR-FOUND-FLAG
                   PERFORM 3000-FINALIZE-PROGRAM
                   STOP RUN
               END-IF.

           OPEN OUTPUT LEDGER-OUTPUT-FILE
               IF WS-LEDGER-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Could not open LEDGER-OUTPUT-FILE. Status: "
                           WS-LEDGER-FILE-STATUS
                   MOVE 'Y' TO WS-ERROR-FOUND-FLAG
                   PERFORM 3000-FINALIZE-PROGRAM
                   STOP RUN
               END-IF.
           
           OPEN EXTEND AI-LOG-FILE
               IF WS-AI-LOG-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "WARNING: Could not open AI-LOG-FILE for EXTEND. Status: "
                           WS-AI-LOG-FILE-STATUS
                   * Continue execution but log to console
               END-IF.

           DISPLAY "AI Digital Integrity Agent is now active and monitoring invoice transactions.".
           DISPLAY "Reading first invoice record...".
           PERFORM 2100-READ-INVOICE-RECORD.

       2000-PROCESS-INVOICES.
           ADD 1 TO WS-INVOICE-COUNT.
           MOVE INVOICE-RECORD-IN TO WS-INVOICE-DATA-AREA.
           DISPLAY " "
           DISPLAY "Processing Invoice ID: " WS-INV-ID.

           PERFORM 2200-AI-PRE-VALIDATION.

           IF NOT ERROR-FOUND
               PERFORM 2300-GENERATE-INVOICE-HASH
               PERFORM 2400-LOG-TO-DISTRIBUTED-LEDGER
           ELSE
               DISPLAY "Invoice ID " WS-INV-ID " skipped due to prior AI-flagged issues."
               PERFORM 2900-LOG-AI-ACTION
                   USING WS-INV-ID, 'SKIP', 'Invoice flagged by AI and skipped from ledger.'
           END-IF.
           MOVE 'N' TO WS-ERROR-FOUND-FLAG. * Reset error flag for next invoice

           PERFORM 2100-READ-INVOICE-RECORD.

       2100-READ-INVOICE-RECORD.
           READ INVOICE-INPUT-FILE
               AT END
                   SET INVOICE-FILE-EOF TO TRUE
                   DISPLAY " "
                   DISPLAY "End of INVOICE-INPUT-FILE reached."
               NOT AT END
                   CONTINUE
               END-READ.

           IF WS-INVOICE-FILE-STATUS NOT EQUAL '00' AND NOT INVOICE-FILE-EOF
               DISPLAY "ERROR: Reading INVOICE-INPUT-FILE. Status: "
                       WS-INVOICE-FILE-STATUS
               MOVE 'Y' TO WS-ERROR-FOUND-FLAG
           END-IF.

       2200-AI-PRE-VALIDATION.
           MOVE 'N' TO WS-AI-ANOMALY-FLAG.
           MOVE SPACES TO WS-AI-VALIDATION-MSG.
           MOVE ZEROS TO WS-AI-RISK-SCORE.
           MOVE SPACES TO WS-AI-SUGGESTION.
           MOVE 'CLEAN' TO WS-AI-ASSESSMENT.

           DISPLAY "AI Digital Integrity Agent analyzing Invoice ID: " WS-INV-ID.

           * AI Rule 1: Check for zero amount invoices - high priority
           IF WS-INV-AMOUNT EQUAL ZEROS
               MOVE 'Y' TO WS-AI-ANOMALY-FLAG
               ADD 50 TO WS-AI-RISK-SCORE
               MOVE "Invoice amount is zero." TO WS-AI-VALIDATION-MSG
               MOVE "Review for potential entry error or cancelled transaction." TO WS-AI-SUGGESTION
               SET AI-ASSESSMENT-FLAGGED TO TRUE
               DISPLAY "  AI Alert: Zero amount invoice detected. Flagging for immediate review."
           END-IF.

           * AI Rule 2: Check for unusually old invoice dates (simulated logic for current year)
           * For simplicity, let's say anything before current year is "old"
           ACCEPT WS-CURRENT-DATETIME FROM DATE YYYYMMDD.
           IF WS-INV-DATE < (FUNCTION NUMVAL(WS-CURRENT-YY) * 10000 + 0101)
               IF WS-AI-ANOMALY-FLAG = 'N' * Only flag if not already flagged by higher priority rule
                   MOVE 'Y' TO WS-AI-ANOMALY-FLAG
                   ADD 20 TO WS-AI-RISK-SCORE
                   MOVE "Invoice date is from a previous fiscal period." TO WS-AI-VALIDATION-MSG
                   MOVE "Verify date accuracy and accounting period context." TO WS-AI-SUGGESTION
                   SET AI-ASSESSMENT-REVIEW TO TRUE
                   DISPLAY "  AI Alert: Invoice date appears unusually old. Flagging for review."
               END-IF
           END-IF.

           * AI Rule 3: Check for suspicious keywords in description combined with amount
           IF (WS-INV-DESC CONTAINS 'REFUND' OR WS-INV-DESC CONTAINS 'CREDIT')
              AND (WS-INV-AMOUNT IS POSITIVE)
              IF WS-AI-ANOMALY-FLAG = 'N'
                 MOVE 'Y' TO WS-AI-ANOMALY-FLAG
                 ADD 70 TO WS-AI-RISK-SCORE
                 MOVE "Positive amount with 'REFUND'/'CREDIT' keyword mismatch." TO WS-AI-VALIDATION-MSG
                 MOVE "High-risk: Manual fraud investigation needed. Potential entry error or unusual transaction." TO WS-AI-SUGGESTION
                 SET AI-ASSESSMENT-FLAGGED TO TRUE
                 DISPLAY "  AI Alert: High-risk anomaly detected: 'REFUND'/'CREDIT' with positive amount!"
              END-IF
           END-IF.

           * AI Rule 4: Check for missing customer ID
           IF WS-CUSTOMER-ID = SPACES OR WS-CUSTOMER-ID = LOW-VALUES
               IF WS-AI-ANOMALY-FLAG = 'N'
                   MOVE 'Y' TO WS-AI-ANOMALY-FLAG
                   ADD 30 TO WS-AI-RISK-SCORE
                   MOVE "Missing or invalid Customer ID." TO WS-AI-VALIDATION-MSG
                   MOVE "Update invoice with valid customer ID before logging." TO WS-AI-SUGGESTION
                   SET AI-ASSESSMENT-REVIEW TO TRUE
                   DISPLAY "  AI Alert: Missing customer ID. Flagging for review."
               END-IF
           END-IF.

           * AI Rule 5: Check for unusually large amounts (simple threshold)
           IF WS-INV-AMOUNT > 999999.99  * Example threshold
               IF WS-AI-ANOMALY-FLAG = 'N'
                   MOVE 'Y' TO WS-AI-ANOMALY-FLAG
                   ADD 40 TO WS-AI-RISK-SCORE
                   MOVE "Unusually large invoice amount." TO WS-AI-VALIDATION-MSG
                   MOVE "Verify amount against standard transaction limits." TO WS-AI-SUGGESTION
                   SET AI-ASSESSMENT-REVIEW TO TRUE
                   DISPLAY "  AI Alert: Invoice amount is unusually large. Flagging for review."
               END-IF
           END-IF.

           IF WS-AI-ANOMALY-FLAG = 'Y'
               ADD 1 TO WS-ANOMALY-COUNT
               DISPLAY "  AI Assessment: " WS-AI-ASSESSMENT
               DISPLAY "  Reason: " WS-AI-VALIDATION-MSG
               DISPLAY "  Risk Score: " WS-AI-RISK-SCORE
               DISPLAY "  AI Suggestion: " WS-AI-SUGGESTION
               MOVE 'Y' TO WS-ERROR-FOUND-FLAG * Treat anomaly as error for immediate skipping
               PERFORM 2900-LOG-AI-ACTION
                   USING WS-INV-ID, WS-AI-ASSESSMENT, WS-AI-VALIDATION-MSG
           ELSE
               DISPLAY "  AI Assessment: Invoice appears clean and secure. Proceeding with ledger logging."
               PERFORM 2900-LOG-AI-ACTION
                   USING WS-INV-ID, 'CLEAN', 'No significant anomalies detected by AI.'
           END-IF.

       2300-GENERATE-INVOICE-HASH.
           DISPLAY "Generating immutable cryptographic hash for Invoice ID: " WS-INV-ID.
           * In a real system, this would typically involve a CALL to an external
           * cryptographic service or a hardware security module (HSM).
           * For this COBOL simulation, we'll create a deterministic "hash" string
           * by concatenating key fields and performing a simple numeric sum,
           * which represents the concept of data integrity.
           
           MOVE SPACES TO WS-TEMP-HASH-STRING.
           STRING WS-INV-ID DELIMITED BY SIZE
                  WS-CUSTOMER-ID DELIMITED BY SIZE
                  WS-INV-DATE DELIMITED BY SIZE
                  WS-INV-AMOUNT DELIMITED BY SIZE
                  WS-INV-DESC(1:60) DELIMITED BY SIZE * Use significant portion of desc
             INTO WS-TEMP-HASH-STRING
           END-STRING.

           * Simulate a basic numeric summation for hash integrity proof
           COMPUTE WS-SIMULATED-HASH-NUM = 0.
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > LENGTH OF WS-TEMP-HASH-STRING
               ADD FUNCTION ORD(WS-TEMP-HASH-STRING(I:1)) TO WS-SIMULATED-HASH-NUM
           END-PERFORM.

           * Convert the numeric sum to a fixed-length alphanumeric string to resemble a hash output.
           * This is a simplified representation of a SHA-256 or similar hash.
           MOVE FUNCTION DISPLAY-OF(WS-SIMULATED-HASH-NUM) TO WS-SIMULATED-HASH-STR.
           * Pad or truncate to 64 chars if the simulated hash is shorter/longer
           STRING WS-SIMULATED-HASH-STR(1:64)
                  FILLER PIC X(64) VALUE ALL '0'
             DELIMITED BY SIZE INTO WS-INV-HASH-VALUE
           END-STRING.
           
           DISPLAY "  Generated Hash (simulated for integrity proof): " WS-INV-HASH-VALUE.

       2400-LOG-TO-DISTRIBUTED-LEDGER.
           DISPLAY "Attempting to commit Invoice ID " WS-INV-ID " to distributed ledger simulation...".
           ADD 1 TO WS-LEDGER-SEQUENCE.
           MOVE WS-LEDGER-SEQUENCE TO WS-LEDGER-ENTRY-ID.
           MOVE WS-INV-ID          TO WS-ORIGINAL-INV-ID.
           
           ACCEPT WS-CURRENT-DATETIME FROM DATE YYYYMMDDHHMMSS.
           STRING WS-CURRENT-YY WS-CURRENT-MM WS-CURRENT-DD
                  WS-CURRENT-HH WS-CURRENT-MI WS-CURRENT-SS
             INTO WS-LEDGER-TIMESTAMP
           END-STRING.

           MOVE WS-INV-HASH-VALUE  TO WS-INV-HASH-VALUE-OUT.
           MOVE WS-AI-ASSESSMENT   TO WS-AI-ASSESSMENT-OUT.
           MOVE 'COMMITTED'         TO WS-LEDGER-STATUS.

           MOVE WS-LEDGER-ENTRY-ID TO LEDGER-ENTRY-ID-OUT.
           MOVE WS-ORIGINAL-INV-ID TO ORIGINAL-INV-ID-OUT.
           MOVE WS-LEDGER-TIMESTAMP TO LEDGER-TIMESTAMP-OUT.
           MOVE WS-INV-HASH-VALUE  TO INV-HASH-VALUE-OUT.
           MOVE WS-AI-ASSESSMENT   TO AI-ASSESSMENT-OUT.
           MOVE WS-LEDGER-STATUS   TO LEDGER-STATUS-OUT.

           WRITE LEDGER-RECORD-OUT
               IF WS-LEDGER-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Writing to LEDGER-OUTPUT-FILE. Status: "
                           WS-LEDGER-FILE-STATUS
                   MOVE 'Y' TO WS-ERROR-FOUND-FLAG
               ELSE
                   ADD 1 TO WS-LEDGER-COUNT
                   DISPLAY "  Invoice " WS-INV-ID " successfully logged to immutable ledger."
                   PERFORM 2900-LOG-AI-ACTION
                       USING WS-INV-ID, WS-AI-ASSESSMENT, 'Invoice successfully committed to ledger.'
               END-IF.

       2900-LOG-AI-ACTION USING P-INV-ID, P-ASSESSMENT, P-MESSAGE.
           01 P-INV-ID         PIC X(10).
           01 P-ASSESSMENT     PIC X(20).
           01 P-MESSAGE        PIC X(120).

           IF WS-AI-LOG-FILE-STATUS EQUAL '00'
               ACCEPT WS-CURRENT-DATETIME FROM DATE YYYYMMDDHHMMSS.
               STRING WS-CURRENT-YY WS-CURRENT-MM WS-CURRENT-DD
                      WS-CURRENT-HH WS-CURRENT-MI WS-CURRENT-SS
                 INTO AI-LOG-TIMESTAMP
               END-STRING.
               MOVE P-INV-ID     TO AI-LOG-INV-ID.
               STRING 'AI(' P-ASSESSMENT '): ' P-MESSAGE
                 DELIMITED BY SIZE INTO AI-LOG-MESSAGE
               END-STRING.
               WRITE AI-LOG-RECORD-OUT
                   IF WS-AI-LOG-FILE-STATUS NOT EQUAL '00'
                       DISPLAY "WARNING: Error writing to AI-LOG-FILE (runtime). Status: "
                               WS-AI-LOG-FILE-STATUS
                       DISPLAY "  (AI Log Entry to Console: " P-INV-ID ", " P-ASSESSMENT ", " P-MESSAGE ")"
                   END-IF
               END-WRITE
           ELSE
               DISPLAY "  (AI Log Entry to Console: " P-INV-ID ", " P-ASSESSMENT ", " P-MESSAGE ")"
           END-IF.

       3000-FINALIZE-PROGRAM.
           DISPLAY " "
           DISPLAY "AI-DRIVEN LEDGER INTEGRATION - INVOICE LOGGER COMPLETE.".
           DISPLAY "Total Invoices Processed: " WS-INVOICE-COUNT.
           DISPLAY "Total Invoices Logged to Ledger: " WS-LEDGER-COUNT.
           DISPLAY "Total AI-Flagged Anomalies: " WS-ANOMALY-COUNT.
           DISPLAY " "

           CLOSE INVOICE-INPUT-FILE
               IF WS-INVOICE-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Could not close INVOICE-INPUT-FILE. Status: "
                           WS-INVOICE-FILE-STATUS
               END-IF.

           CLOSE LEDGER-OUTPUT-FILE
               IF WS-LEDGER-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Could not close LEDGER-OUTPUT-FILE. Status: "
                           WS-LEDGER-FILE-STATUS
               END-IF.

           CLOSE AI-LOG-FILE
               IF WS-AI-LOG-FILE-STATUS NOT EQUAL '00'
                   DISPLAY "ERROR: Could not close AI-LOG-FILE. Status: "
                           WS-AI-LOG-FILE-STATUS
               END-IF.

           IF ERROR-FOUND
               DISPLAY "Program terminated with one or more errors or flagged anomalies."
           ELSE
               DISPLAY "Program finished successfully, all eligible invoices processed."
           END-IF.
```