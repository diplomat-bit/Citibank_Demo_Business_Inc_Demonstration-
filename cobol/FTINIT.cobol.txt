
       IDENTIFICATION DIVISION.
       PROGRAM-ID. FTINIT.
       AUTHOR. LIVE-BANK-ARCHITECTS.
       DATE-WRITTEN. 1993-02-10.
      ******************************************************************
      * LIVE BANK - INITIATE FUNDS TRANSFER
      *
      * INITIATES A WIRE OR ACH TRANSFER, PERFORMS COMPLIANCE
      * CHECKS, AND LOGS TO THE LEDGER.
      ******************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT FUNDS-TRANSFER-FILE ASSIGN TO FTMAST
               ORGANIZATION IS INDEXED
               ACCESS MODE IS DYNAMIC
               RECORD KEY IS FT-TRANSACTION-ID
               FILE STATUS IS WS-FTMAST-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD FUNDS-TRANSFER-FILE.
       01 FT-FILE-RECORD         PIC X(200).

       WORKING-STORAGE SECTION.
       01 WS-PROGRAM-SWITCHES.
          05 WS-FTMAST-STATUS       PIC X(02).
             88 FTMAST-OK            VALUE '00'.

       COPY CPFT01 REPLACING ==FUNDS-TRANSFER-RECORD== BY
                             ==WS-FUNDS-TRANSFER==.

       PROCEDURE DIVISION.
       0000-MAIN-LOGIC.
           PERFORM 1000-INITIALIZATION.
           PERFORM 2000-ACCEPT-TRANSFER-DATA.
           PERFORM 3000-VALIDATE-ACCOUNTS.
           PERFORM 4000-COMPLIANCE-SCREEN.
           PERFORM 5000-WRITE-TRANSFER-RECORD.
           PERFORM 9999-TERMINATION.
           STOP RUN.

       1000-INITIALIZATION.
           DISPLAY " ".
           DISPLAY "INITIALIZING FTINIT - FUNDS TRANSFER INITIATION.".
           OPEN I-O FUNDS-TRANSFER-FILE.

       2000-ACCEPT-TRANSFER-DATA.
           DISPLAY "ENTER FROM ACCOUNT: ".
           ACCEPT FT-FROM-ACCOUNT OF WS-FUNDS-TRANSFER.
           DISPLAY "ENTER TO ACCOUNT: ".
           ACCEPT FT-TO-ACCOUNT OF WS-FUNDS-TRANSFER.
           DISPLAY "ENTER AMOUNT: ".
           ACCEPT FT-TRANSFER-AMOUNT OF WS-FUNDS-TRANSFER.

       3000-VALIDATE-ACCOUNTS.
           DISPLAY "VALIDATING ORIGINATOR AND BENEFICIARY ACCOUNTS...".
      *    (LOGIC TO READ DEPOSIT ACCOUNT FILE AND CHECK STATUS/FUNDS)
           DISPLAY "ACCOUNTS AND FUNDS VERIFIED.".

       4000-COMPLIANCE-SCREEN.
           DISPLAY "CALLING AI FOR 100-POINT COMPLIANCE SCREEN (AML/OFAC)".
           CALL "AI-INTEGRATION-LAYER" USING WS-FUNDS-TRANSFER
                                       GIVING FT-COMPLIANCE-FLAGS.
           DISPLAY "COMPLIANCE SCREEN PASSED.".

       5000-WRITE-TRANSFER-RECORD.
           MOVE "FT-2024-00001" TO FT-TRANSACTION-ID OF WS-FUNDS-TRANSFER.
           SET FT-PENDING OF WS-FUNDS-TRANSFER TO TRUE.
           WRITE FT-FILE-RECORD FROM WS-FUNDS-TRANSFER.
           IF FTMAST-OK
              DISPLAY "FUNDS TRANSFER INITIATED AND PENDING."
           ELSE
              DISPLAY "CRITICAL ERROR: FAILED TO LOG TRANSFER."
           END-IF.

       9999-TERMINATION.
           CLOSE FUNDS-TRANSFER-FILE.
           DISPLAY "FTINIT MODULE TERMINATED.".
           DISPLAY " ".
