
       IDENTIFICATION DIVISION.
       PROGRAM-ID. TMCLOSE.
       AUTHOR. LIVE-BANK-ARCHITECTS.
      ******************************************************************
      * LIVE BANK - TELLER CLOSE DRAWER
      ******************************************************************
       ENVIRONMENT DIVISION.
       FILE-CONTROL.
           SELECT TELLER-MASTER-FILE ASSIGN TO TELLMAST.
           SELECT DAILY-TRAN-LOG ASSIGN TO TRANLOG.

       DATA DIVISION.
       FILE SECTION.
       FD TELLER-MASTER-FILE.
       01 TELLER-FILE-RECORD PIC X(158).
       FD DAILY-TRAN-LOG.
       01 TRAN-RECORD          PIC X(80).

       WORKING-STORAGE SECTION.
       01 WS-INPUT-TELLER-ID     PIC X(08).
       01 WS-ENDING-CASH         PIC S9(9)V99.
       01 WS-CALCULATED-TOTALS   PIC S9(11)V99.
       COPY CPTM01.

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           DISPLAY "TMCLOSE - TELLER DRAWER CLOSING PROCEDURE.".
           OPEN I-O TELLER-MASTER-FILE.
           OPEN INPUT DAILY-TRAN-LOG.
           DISPLAY "ENTER TELLER ID TO CLOSE: ".
           ACCEPT WS-INPUT-TELLER-ID.
      *    (LOGIC TO READ TELLER-MASTER-FILE)
           IF DRAWER-CLOSED
              DISPLAY "ERROR: DRAWER ALREADY CLOSED."
           ELSE
              PERFORM CALCULATE-TOTALS
              DISPLAY "ENTER ENDING CASH AMOUNT: "
              ACCEPT WS-ENDING-CASH
      *       (LOGIC TO COMPARE ENDING-CASH TO CALCULATED TOTALS)
              DISPLAY "DRAWER BALANCED. 100% ACCURATE."
              SET DRAWER-CLOSED TO TRUE
      *       (LOGIC TO REWRITE TELLER-MASTER-FILE)
              DISPLAY "DRAWER CLOSED AND SECURED."
           END-IF.
           CLOSE TELLER-MASTER-FILE, DAILY-TRAN-LOG.
           STOP RUN.

       CALCULATE-TOTALS.
           DISPLAY "CALCULATING TOTALS FROM TRANSACTION LOG...".
      *    (LOGIC TO READ TRANLOG AND SUM TRANSACTIONS FOR TELLER)
           DISPLAY "TOTALS CALCULATED.".
