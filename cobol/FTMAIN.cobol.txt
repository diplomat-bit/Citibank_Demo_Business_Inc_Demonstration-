       IDENTIFICATION DIVISION.
       PROGRAM-ID. FTMAIN.
       AUTHOR. AI-PROGRAMMER.
       DATE-WRITTEN. 2024-07-27.
      ******************************************************************
      * FUNDS TRANSFER MAIN
      *
      * THIS IS THE SUB-MENU CONTROLLER FOR THE FUNDS TRANSFER
      * SYSTEM (FTS). IT PROVIDES ACCESS TO VARIOUS TRANSFER
      * FUNCTIONS AND INTEGRATES WITH INTELLIGENT ASSISTANCE MODULES.
      ******************************************************************
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-MENU-SWITCHES.
          05 WS-USER-CHOICE       PIC X(01).
             88 EXIT-FT-MENU      VALUE 'X'.
          05 WS-SUBPROGRAM-STATUS PIC X(02) VALUE SPACES.
             88 SUBPROGRAM-OKAY   VALUE 'OK'.
             88 SUBPROGRAM-ERROR  VALUE 'ER'.

       01 WS-MENU-SCREEN.
          05 FILLER PIC X(80) VALUE ALL "*".
          05 FILLER PIC X(80) VALUE
             "*        INTELLIGENT FUNDS TRANSFER SYSTEM (FTS)       *".
          05 FILLER PIC X(80) VALUE ALL "*".
          05 FILLER PIC X(80) VALUE "*   1. INITIATE NEW TRANSFER                       *".
          05 FILLER PIC X(80) VALUE "*   2. INQUIRE TRANSFER STATUS                     *".
          05 FILLER PIC X(80) VALUE "*   3. CANCEL PENDING TRANSFER                     *".
          05 FILLER PIC X(80) VALUE "*   4. VIEW TRANSFER HISTORY                       *".
          05 FILLER PIC X(80) VALUE "*   5. AI-POWERED FRAUD ANALYSIS                   *".
          05 FILLER PIC X(80) VALUE "*   6. GENERATE PREDICTIVE INSIGHTS                *".
          05 FILLER PIC X(80) VALUE "*                                                    *".
          05 FILLER PIC X(80) VALUE "*   X. EXIT TO MAIN MENU                           *".
          05 FILLER PIC X(80) VALUE ALL "*".

       01 WS-CURRENT-DATE-TIME.
          05 WS-CURRENT-DATE.
             10 WS-CURRENT-YEAR   PIC 9(04).
             10 WS-CURRENT-MONTH  PIC 9(02).
             10 WS-CURRENT-DAY    PIC 9(02).
          05 WS-CURRENT-TIME.
             10 WS-CURRENT-HOUR   PIC 9(02).
             10 WS-CURRENT-MINUTE PIC 9(02).
             10 WS-CURRENT-SECOND PIC 9(02).
             10 WS-CURRENT-MS     PIC 9(02).

       01 WS-DISPLAY-MESSAGE   PIC X(80).

       PROCEDURE DIVISION.
       0000-MAIN-LOGIC.
           PERFORM 1000-INITIALIZE-SYSTEM.
           PERFORM 2000-CONTROL-LOOP UNTIL EXIT-FT-MENU.
           PERFORM 3000-TERMINATE-SYSTEM.
           GOBACK.

       1000-INITIALIZE-SYSTEM.
           DISPLAY "Initializing Funds Transfer System...".
           MOVE 'OK' TO WS-SUBPROGRAM-STATUS.
           ACCEPT WS-CURRENT-DATE-TIME FROM DATE YYYYMMDD TIME.
           STRING "System started at "
                  WS-CURRENT-HOUR ":"
                  WS-CURRENT-MINUTE ":"
                  WS-CURRENT-SECOND
                  DELIMITED BY SIZE
                  INTO WS-DISPLAY-MESSAGE.
           DISPLAY WS-DISPLAY-MESSAGE.

       2000-CONTROL-LOOP.
           DISPLAY WS-MENU-SCREEN.
           DISPLAY "Enter your choice: " WITH NO ADVANCING.
           ACCEPT WS-USER-CHOICE.
           MOVE FUNCTION UPPER-CASE(WS-USER-CHOICE) TO WS-USER-CHOICE.

           EVALUATE WS-USER-CHOICE
               WHEN "1"
                   PERFORM 2100-INITIATE-TRANSFER
               WHEN "2"
                   PERFORM 2200-INQUIRE-STATUS
               WHEN "3"
                   PERFORM 2300-CANCEL-TRANSFER
               WHEN "4"
                   PERFORM 2400-VIEW-HISTORY
               WHEN "5"
                   PERFORM 2500-AI-FRAUD-ANALYSIS
               WHEN "6"
                   PERFORM 2600-PREDICTIVE-INSIGHTS
               WHEN "X"
                   DISPLAY "Preparing to exit Funds Transfer menu..."
               WHEN OTHER
                   DISPLAY "INVALID SELECTION. PLEASE CHOOSE FROM THE OPTIONS ABOVE."
           END-EVALUATE.
           IF NOT EXIT-FT-MENU
               DISPLAY SPACE
               DISPLAY "Press ENTER to continue..."
               ACCEPT WS-USER-CHOICE
           END-IF.

       2100-INITIATE-TRANSFER.
           DISPLAY "Calling FTINIT for new transfer initiation...".
           CALL "FTINIT" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "Error initiating transfer. Please check logs."
           ELSE
               DISPLAY "Transfer initiation module completed."
           END-IF.

       2200-INQUIRE-STATUS.
           DISPLAY "Calling FTSTAT for transfer status inquiry...".
           CALL "FTSTAT" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "Error inquiring status. Please check logs."
           ELSE
               DISPLAY "Transfer status inquiry module completed."
           END-IF.

       2300-CANCEL-TRANSFER.
           DISPLAY "Calling FTCNCL for pending transfer cancellation...".
           CALL "FTCNCL" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "Error cancelling transfer. Please check logs."
           ELSE
               DISPLAY "Transfer cancellation module completed."
           END-IF.

       2400-VIEW-HISTORY.
           DISPLAY "Calling FTHISTORY for viewing transfer history...".
           CALL "FTHISTORY" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "Error retrieving history. Please check logs."
           ELSE
               DISPLAY "Transfer history module completed."
           END-IF.

       2500-AI-FRAUD-ANALYSIS.
           DISPLAY "Accessing AI-Powered Fraud Analysis module...".
           DISPLAY "Calling FTAIFRAUD for intelligent fraud review...".
           CALL "FTAIFRAUD" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "AI Fraud Analysis encountered an issue."
           ELSE
               DISPLAY "AI Fraud Analysis completed successfully. Reviewing recent patterns."
           END-IF.

       2600-PREDICTIVE-INSIGHTS.
           DISPLAY "Accessing Predictive Insights module...".
           DISPLAY "Calling FTPREDICT for generating future transfer trends...".
           CALL "FTPREDICT" USING WS-SUBPROGRAM-STATUS.
           IF SUBPROGRAM-ERROR
               DISPLAY "Predictive Insights encountered an issue."
           ELSE
               DISPLAY "Predictive Insights generated. Awaiting user review."
           END-IF.

       3000-TERMINATE-SYSTEM.
           ACCEPT WS-CURRENT-DATE-TIME FROM DATE YYYYMMDD TIME.
           STRING "System shut down at "
                  WS-CURRENT-HOUR ":"
                  WS-CURRENT-MINUTE ":"
                  WS-CURRENT-SECOND
                  DELIMITED BY SIZE
                  INTO WS-DISPLAY-MESSAGE.
           DISPLAY WS-DISPLAY-MESSAGE.
           DISPLAY "Thank you for using the Intelligent Funds Transfer System.".