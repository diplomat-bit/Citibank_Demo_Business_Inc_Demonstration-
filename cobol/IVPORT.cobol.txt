```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. IVPORT.
       AUTHOR. A-I-FINANCIAL-SYSTEMS.
      ******************************************************************
      * MAINFRAME FINANCIAL - INVESTMENT PORTFOLIO ANALYZER
      *
      * This program processes investment holdings from the INVMAST file,
      * calculates current market value, gain/loss, and generates a
      * comprehensive report. It integrates simulated AI insights
      * for each investment position and provides an overall portfolio
      * sentiment and recommendation. The AI analysis is designed to be
      * story-like and non-controversial, focusing on trends and sentiment.
      *
      * All company names and specific financial details are fictional
      * and for demonstration purposes only. No sensitive or confidential
      * information is processed or generated.
      *
      * SYSTEM PROMPT:
      * This COBOL module uses a simplified, hardcoded AI simulation.
      * For a comprehensive, configurable AI system instruction,
      * see ./prompts/idgafai_full.txt (in a real-world application
      * where COBOL can interface with modern AI services).
      ******************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INVESTMENT-FILE ASSIGN TO INVMAST
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS IS SEQUENTIAL
               FILE STATUS IS WS-INV-FILE-STATUS.

           SELECT REPORT-FILE     ASSIGN TO RPTINV01
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS IS SEQUENTIAL
               FILE STATUS IS WS-RPT-FILE-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD INVESTMENT-FILE
           RECORD CONTAINS 94 CHARACTERS.
       01 INV-FILE-RECORD.
          05 INV-ASSET-ID          PIC X(10).   *> e.g., MSFT, GOOG
          05 INV-DESCRIPTION       PIC X(30).   *> Full name of asset
          05 INV-QUANTITY          PIC S9(10)V99. *> Number of shares/units
          05 INV-COST-PER-UNIT     PIC S9(09)V99. *> Original cost per unit
          05 INV-CURRENT-PRICE     PIC S9(09)V99. *> Current market price per unit
          05 INV-ACQUISITION-DATE  PIC 9(08).   *> YYYYMMDD
          05 INV-AI-INPUT-HINT     PIC X(14).   *> For future AI model input (simulated)

       FD REPORT-FILE
           RECORD CONTAINS 132 CHARACTERS.
       01 REPORT-LINE             PIC X(132).

       WORKING-STORAGE SECTION.
       01 WS-FILE-STATUS-CODES.
          05 WS-INV-FILE-STATUS      PIC X(02) VALUE SPACES.
          05 WS-RPT-FILE-STATUS      PIC X(02) VALUE SPACES.

       01 WS-EOF-FLAG PIC X(01) VALUE 'N'.
          88 END-OF-FILE VALUE 'Y'.

       01 WS-PROGRAM-CONTROL.
          05 WS-RETURN-CODE          PIC S9(04) COMP VALUE ZERO.
          05 WS-RECORD-COUNT         PIC S9(07) COMP VALUE ZERO.
          05 WS-PAGE-NUMBER          PIC S9(03) COMP VALUE ZERO.
          05 WS-LINE-COUNT           PIC S9(03) COMP VALUE ZERO.
          05 WS-LINES-PER-PAGE       PIC S9(03) COMP VALUE 50.

       01 WS-CURRENT-DATE-TIME.
          05 WS-DATE-TIME-FULL.
             10 WS-CURRENT-DATE-YYMMDD.
                15 WS-CURRENT-YEAR      PIC 9(04).
                15 WS-CURRENT-MONTH     PIC 9(02).
                15 WS-CURRENT-DAY       PIC 9(02).
             10 WS-CURRENT-TIME-HHMMSSFF.
                15 WS-CURRENT-HOUR      PIC 9(02).
                15 WS-CURRENT-MINUTE    PIC 9(02).
                15 WS-CURRENT-SECOND    PIC 9(02).
                15 WS-CURRENT-HUNDREDTH PIC 9(02).

       01 WS-TOTALS.
          05 WS-TOTAL-COST-BASIS     PIC S9(15)V99 COMP-3 VALUE ZERO.
          05 WS-TOTAL-MARKET-VAL     PIC S9(15)V99 COMP-3 VALUE ZERO.
          05 WS-TOTAL-GAIN-LOSS      PIC S9(15)V99 COMP-3 VALUE ZERO.
          05 WS-TOTAL-AI-SENTIMENT   PIC S9(15)V99 COMP-3 VALUE ZERO.

       01 WS-REPORT-DETAIL-CALCS.
          05 WS-CALC-COST-BASIS      PIC S9(13)V99 COMP-3.
          05 WS-CALC-MARKET-VAL      PIC S9(13)V99 COMP-3.
          05 WS-CALC-GAIN-LOSS       PIC S9(13)V99 COMP-3.
          05 WS-CALC-GAIN-LOSS-PCT   PIC S9(03)V99 COMP-3.

       01 WS-AI-SIMULATION-DATA.
          05 WS-AI-MODEL-STATUS      PIC X(10) VALUE 'INACTIVE'.
             88 AI-MODEL-ACTIVE      VALUE 'ACTIVE'.
          05 WS-AI-PORTFOLIO-SENTIMENT PIC S9(03)V99 COMP-3 VALUE ZERO. *> 0-100 average
          05 WS-AI-OVERALL-RECOMMEND PIC X(20) VALUE SPACES.
             88 AI-REC-MONITOR       VALUE 'MONITOR'.
             88 AI-REC-OPTIMAL       VALUE 'OPTIMAL'.
             88 AI-REC-REVIEW        VALUE 'REVIEW'.
             88 AI-REC-CAUTION       VALUE 'CAUTION'.
          05 WS-RANDOM-SEED          PIC 9(05) VALUE 12345. *> For simple AI simulation

       01 REPORT-HEADER-AREA.
          05 RH-LINE-1.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RH1-TITLE               PIC X(40) VALUE 'MAINFRAME FINANCIAL - INVESTMENT PORTFOLIO'.
             10 FILLER                  PIC X(40) VALUE SPACES.
             10 RH1-DATE-LABEL          PIC X(05) VALUE 'DATE:'.
             10 RH1-REPORT-DATE         PIC X(10).
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RH1-PAGE-LABEL          PIC X(05) VALUE 'PAGE:'.
             10 RH1-PAGE-NUMBER         PIC ZZ9.
             10 FILLER                  PIC X(19) VALUE SPACES.

          05 RH-LINE-2.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RH2-AI-STATUS-LABEL     PIC X(15) VALUE 'AI SYSTEM STATUS:'.
             10 RH2-AI-STATUS           PIC X(10).
             10 FILLER                  PIC X(102) VALUE SPACES.

          05 RH-COLUMN-HEADERS.
             10 FILLER                  PIC X(02) VALUE SPACES.
             10 CH-ASSET-ID             PIC X(10) VALUE 'ASSET ID'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-DESCRIPTION          PIC X(30) VALUE 'DESCRIPTION'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-QUANTITY             PIC X(10) VALUE 'QUANTITY'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-COST-BASIS           PIC X(12) VALUE 'COST BASIS'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-MARKET-VALUE         PIC X(13) VALUE 'MARKET VALUE'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-GAIN-LOSS            PIC X(10) VALUE 'GAIN/LOSS'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-AI-TREND             PIC X(08) VALUE 'AI TREND'.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 CH-AI-SENTIMENT         PIC X(10) VALUE 'AI SENTIMNT'.
             10 FILLER                  PIC X(16) VALUE SPACES.

       01 REPORT-DETAIL-LINE.
          05 FILLER                  PIC X(02) VALUE SPACES.
          05 DL-ASSET-ID             PIC X(10).
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-DESCRIPTION          PIC X(30).
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-QUANTITY             PIC ZZZ,ZZZ,ZZ9.99.
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-COST-BASIS           PIC ZZZ,ZZZ,ZZZ.99.
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-MARKET-VALUE         PIC ZZZ,ZZZ,ZZZ.99.
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-GAIN-LOSS            PIC ZZZ,ZZZ,ZZZ.99.
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-AI-TREND             PIC X(08).
          05 FILLER                  PIC X(01) VALUE SPACES.
          05 DL-AI-SENTIMENT         PIC Z(03).99. *> Display 0-100 score
          05 FILLER                  PIC X(16) VALUE SPACES.

       01 REPORT-FOOTER-AREA.
          05 RF-LINE-DIVIDER         PIC X(132).

          05 RF-TOTAL-LINE-1.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RTL1-LABEL              PIC X(20) VALUE 'TOTAL PORTFOLIO:'.
             10 FILLER                  PIC X(20) VALUE SPACES.
             10 RTL1-TOTAL-COST-BASIS   PIC $,ZZZ,ZZZ,ZZZ,ZZZ.99.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 RTL1-TOTAL-MARKET-VAL   PIC $,ZZZ,ZZZ,ZZZ,ZZZ.99.
             10 FILLER                  PIC X(01) VALUE SPACES.
             10 RTL1-TOTAL-GAIN-LOSS    PIC $,ZZZ,ZZZ,ZZZ,ZZZ.99.
             10 FILLER                  PIC X(36) VALUE SPACES.

          05 RF-TOTAL-LINE-2.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RTL2-LABEL              PIC X(20) VALUE 'RECORDS PROCESSED:'.
             10 RTL2-RECORD-COUNT       PIC ZZZ,ZZ9.
             10 FILLER                  PIC X(101) VALUE SPACES.

          05 RF-AI-SUMMARY-LINE-1.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RAIS1-LABEL             PIC X(25) VALUE 'AI PORTFOLIO SENTIMENT:'.
             10 RAIS1-SENTIMENT         PIC Z(03).99.
             10 FILLER                  PIC X(97) VALUE SPACES.

          05 RF-AI-SUMMARY-LINE-2.
             10 FILLER                  PIC X(05) VALUE SPACES.
             10 RAIS2-LABEL             PIC X(25) VALUE 'AI OVERALL RECOMMENDATION:'.
             10 RAIS2-RECOMMENDATION    PIC X(20).
             10 FILLER                  PIC X(82) VALUE SPACES.


       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM 100-INITIALIZE-PROGRAM.
           PERFORM 200-OPEN-FILES.
           PERFORM 300-INITIALIZE-AI-SYSTEM.
           PERFORM 400-WRITE-HEADER.
           PERFORM 500-PROCESS-POSITIONS
               UNTIL END-OF-FILE.
           PERFORM 600-GENERATE-AI-PORTFOLIO-SUMMARY.
           PERFORM 700-WRITE-FOOTER.
           PERFORM 800-CLOSE-FILES.
           PERFORM 900-TERMINATE-PROGRAM.

       100-INITIALIZE-PROGRAM.
           DISPLAY "IVPORT - Investment Portfolio Analyzer Started.".
           ACCEPT WS-DATE-TIME-FULL FROM DATE YYYYMMDDHHMMSSFF.
           MOVE WS-CURRENT-YEAR TO RH1-REPORT-DATE(1:4).
           MOVE WS-CURRENT-MONTH TO RH1-REPORT-DATE(5:2).
           MOVE WS-CURRENT-DAY TO RH1-REPORT-DATE(7:2).
           STRING WS-CURRENT-YEAR '-' WS-CURRENT-MONTH '-'
                  WS-CURRENT-DAY DELIMITED BY SIZE INTO RH1-REPORT-DATE.
           INITIALIZE WS-TOTALS.
           MOVE 'N' TO WS-EOF-FLAG.
           MOVE ZERO TO WS-RECORD-COUNT.
           MOVE ZERO TO WS-PAGE-NUMBER.
           MOVE ZERO TO WS-LINE-COUNT.
           MOVE 'ACTIVE' TO WS-AI-MODEL-STATUS.
           MOVE ALL '=' TO RF-LINE-DIVIDER.

       200-OPEN-FILES.
           OPEN INPUT INVESTMENT-FILE.
           IF WS-INV-FILE-STATUS NOT = '00'
               DISPLAY "ERROR: Could not open INVESTMENT-FILE. Status: "
                   WS-INV-FILE-STATUS
               MOVE 16 TO WS-RETURN-CODE
               PERFORM 900-TERMINATE-PROGRAM
           END-IF.
           OPEN OUTPUT REPORT-FILE.
           IF WS-RPT-FILE-STATUS NOT = '00'
               DISPLAY "ERROR: Could not open REPORT-FILE. Status: "
                   WS-RPT-FILE-STATUS
               MOVE 16 TO WS-RETURN-CODE
               PERFORM 800-CLOSE-FILES
               PERFORM 900-TERMINATE-PROGRAM
           END-IF.

       300-INITIALIZE-AI-SYSTEM.
           DISPLAY "Initializing AI analytics engine... Status: " WS-AI-MODEL-STATUS.
           MOVE WS-AI-MODEL-STATUS TO RH2-AI-STATUS.
           *> This paragraph simulates the setup of an AI system.
           *> In a real-world scenario, this might involve calling external
           *> AI microservices or loading pre-trained models.
           *> For this demonstration, we simply set an internal status.
           IF AI-MODEL-ACTIVE
               DISPLAY "AI system initialized successfully. Ready for analysis."
           ELSE
               DISPLAY "WARNING: AI system not fully active. Proceeding without full AI insights."
           END-IF.

       400-WRITE-HEADER.
           ADD 1 TO WS-PAGE-NUMBER.
           MOVE WS-PAGE-NUMBER TO RH1-PAGE-NUMBER.

           MOVE RH-LINE-1 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING PAGE.
           MOVE RH-LINE-2 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE. *> Blank line
           MOVE RH-COLUMN-HEADERS TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE ALL '-' TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE 6 TO WS-LINE-COUNT.

       500-PROCESS-POSITIONS.
           READ INVESTMENT-FILE
               AT END SET END-OF-FILE TO TRUE
           END-READ.

           IF NOT END-OF-FILE
               ADD 1 TO WS-RECORD-COUNT

               PERFORM 510-CALCULATE-POSITION-VALUES
               PERFORM 520-DETERMINE-AI-INSIGHTS-FOR-POSITION
               PERFORM 530-WRITE-DETAIL-LINE
           END-IF.

       510-CALCULATE-POSITION-VALUES.
           MOVE INV-QUANTITY       TO DL-QUANTITY
           MOVE INV-DESCRIPTION    TO DL-DESCRIPTION
           MOVE INV-ASSET-ID       TO DL-ASSET-ID

           COMPUTE WS-CALC-COST-BASIS = INV-QUANTITY * INV-COST-PER-UNIT
           COMPUTE WS-CALC-MARKET-VAL = INV-QUANTITY * INV-CURRENT-PRICE
           COMPUTE WS-CALC-GAIN-LOSS  = WS-CALC-MARKET-VAL - WS-CALC-COST-BASIS

           ADD WS-CALC-COST-BASIS TO WS-TOTAL-COST-BASIS
           ADD WS-CALC-MARKET-VAL TO WS-TOTAL-MARKET-VAL
           ADD WS-CALC-GAIN-LOSS  TO WS-TOTAL-GAIN-LOSS

           MOVE WS-CALC-COST-BASIS TO DL-COST-BASIS
           MOVE WS-CALC-MARKET-VAL TO DL-MARKET-VALUE
           MOVE WS-CALC-GAIN-LOSS  TO DL-GAIN-LOSS.

       520-DETERMINE-AI-INSIGHTS-FOR-POSITION.
           IF AI-MODEL-ACTIVE
               *> Simulate AI processing based on price movement
               *> This fictional AI analyzes current price against cost basis
               *> to provide a simple trend and sentiment score.
               *> For a comprehensive AI instruction, see ./prompts/idgafai_full.txt
               IF INV-CURRENT-PRICE > (INV-COST-PER-UNIT * 1.08)
                   MOVE 'UP' TO DL-AI-TREND
                   COMPUTE DL-AI-SENTIMENT = 80.00 + (FUNCTION RANDOM(WS-RANDOM-SEED) * 19.99)
               ELSE IF INV-CURRENT-PRICE > (INV-COST-PER-UNIT * 1.02)
                   MOVE 'STABLE+' TO DL-AI-TREND
                   COMPUTE DL-AI-SENTIMENT = 60.00 + (FUNCTION RANDOM(WS-RANDOM-SEED) * 19.99)
               ELSE IF INV-CURRENT-PRICE < (INV-COST-PER-UNIT * 0.92)
                   MOVE 'DOWN' TO DL-AI-TREND
                   COMPUTE DL-AI-SENTIMENT = 1.00 + (FUNCTION RANDOM(WS-RANDOM-SEED) * 19.99)
               ELSE IF INV-CURRENT-PRICE < (INV-COST-PER-UNIT * 0.98)
                   MOVE 'STABLE-' TO DL-AI-TREND
                   COMPUTE DL-AI-SENTIMENT = 20.00 + (FUNCTION RANDOM(WS-RANDOM-SEED) * 19.99)
               ELSE
                   MOVE 'STABLE' TO DL-AI-TREND
                   COMPUTE DL-AI-SENTIMENT = 40.00 + (FUNCTION RANDOM(WS-RANDOM-SEED) * 19.99)
               END-IF.
               ADD DL-AI-SENTIMENT TO WS-TOTAL-AI-SENTIMENT.
               COMPUTE WS-RANDOM-SEED = WS-RANDOM-SEED + 1. *> Advance seed for next random number
           ELSE
               MOVE 'N/A' TO DL-AI-TREND
               MOVE 0.00  TO DL-AI-SENTIMENT
           END-IF.

       530-WRITE-DETAIL-LINE.
           IF WS-LINE-COUNT >= WS-LINES-PER-PAGE
               PERFORM 400-WRITE-HEADER
           END-IF.
           MOVE REPORT-DETAIL-LINE TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           ADD 1 TO WS-LINE-COUNT.

       600-GENERATE-AI-PORTFOLIO-SUMMARY.
           IF WS-RECORD-COUNT > ZERO
               COMPUTE WS-AI-PORTFOLIO-SENTIMENT =
                   WS-TOTAL-AI-SENTIMENT / WS-RECORD-COUNT
           ELSE
               MOVE 0.00 TO WS-AI-PORTFOLIO-SENTIMENT
           END-IF.

           *> Determine overall portfolio recommendation based on AI sentiment
           IF WS-AI-PORTFOLIO-SENTIMENT > 80
               MOVE 'OPTIMAL - Strong Growth' TO WS-AI-OVERALL-RECOMMEND
           ELSE IF WS-AI-PORTFOLIO-SENTIMENT > 60
               MOVE 'MONITOR - Stable Growth' TO WS-AI-OVERALL-RECOMMEND
           ELSE IF WS-AI-PORTFOLIO-SENTIMENT > 40
               MOVE 'REVIEW - Needs Attention' TO WS-AI-OVERALL-RECOMMEND
           ELSE
               MOVE 'CAUTION - High Risk' TO WS-AI-OVERALL-RECOMMEND
           END-IF.

           DISPLAY "AI Portfolio Summary Generated. Sentiment: "
               WS-AI-PORTFOLIO-SENTIMENT
               " Recommendation: " WS-AI-OVERALL-RECOMMEND.

       700-WRITE-FOOTER.
           MOVE RF-LINE-DIVIDER TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.

           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE WS-TOTAL-COST-BASIS TO RTL1-TOTAL-COST-BASIS.
           MOVE WS-TOTAL-MARKET-VAL TO RTL1-TOTAL-MARKET-VAL.
           MOVE WS-TOTAL-GAIN-LOSS  TO RTL1-TOTAL-GAIN-LOSS.
           MOVE RF-TOTAL-LINE-1 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE WS-RECORD-COUNT TO RTL2-RECORD-COUNT.
           MOVE RF-TOTAL-LINE-2 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           *> AI Summary Footer
           MOVE WS-AI-PORTFOLIO-SENTIMENT TO RAIS1-SENTIMENT.
           MOVE RF-AI-SUMMARY-LINE-1 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE WS-AI-OVERALL-RECOMMEND TO RAIS2-RECOMMENDATION.
           MOVE RF-AI-SUMMARY-LINE-2 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE "--- End of Investment Portfolio Analyzer Report ---"
               TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

       800-CLOSE-FILES.
           CLOSE INVESTMENT-FILE.
           IF WS-INV-FILE-STATUS NOT = '00'
               DISPLAY "ERROR: Could not close INVESTMENT-FILE. Status: "
                   WS-INV-FILE-STATUS
               MOVE 16 TO WS-RETURN-CODE
           END-IF.
           CLOSE REPORT-FILE.
           IF WS-RPT-FILE-STATUS NOT = '00'
               DISPLAY "ERROR: Could not close REPORT-FILE. Status: "
                   WS-RPT-FILE-STATUS
               MOVE 16 TO WS-RETURN-CODE
           END-IF.

       900-TERMINATE-PROGRAM.
           DISPLAY "IVPORT - Report generation complete. Return code: "
               WS-RETURN-CODE.
           STOP RUN.
```