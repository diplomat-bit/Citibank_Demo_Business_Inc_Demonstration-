       IDENTIFICATION DIVISION.
       PROGRAM-ID. IVMAIN.
       AUTHOR. AI-DRIVEN-SYSTEMS.
      ******************************************************************
      * INVESTMENTS MAIN MODULE - CENTRAL HUB FOR INVESTMENT SERVICES
      * THIS PROGRAM PROVIDES A MENU-DRIVEN INTERFACE FOR USERS TO
      * ACCESS VARIOUS INVESTMENT-RELATED FUNCTIONS, INCLUDING TRADING,
      * PORTFOLIO MANAGEMENT, AND ADVANCED AI-POWERED ANALYTICS.
      *
      * KEY FEATURES:
      * - TRADING OPERATIONS (BUY/SELL)
      * - PORTFOLIO INQUIRY AND SUMMARY
      * - AI-DRIVEN OPTIMIZATION AND RECOMMENDATIONS
      * - MARKET TREND ANALYSIS UTILIZING ADVANCED ALGORITHMS
      * - RISK ASSESSMENT AND SCENARIO MODELING
      * - INTERACTIVE AI ADVISOR FOR USER QUERIES
      * - SYSTEM CONFIGURATION FOR PERSONALIZED SETTINGS
      *
      * THE INTEGRATION OF AI AIMS TO ENHANCE USER DECISION-MAKING
      * BY PROVIDING INTELLIGENT INSIGHTS AND AUTOMATED ASSISTANCE.
      ******************************************************************
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-MENU-SWITCHES.
          05 WS-USER-CHOICE       PIC X(01).
             88 EXIT-IV-MENU      VALUE 'X'.

       01 WS-SYSTEM-STATUS.
          05 WS-AI-MODULE-STATUS  PIC X(10) VALUE 'READY'.
          05 WS-LAST-UPDATE-TIME  PIC X(08).
          05 WS-LAST-UPDATE-DATE  PIC X(08).

       01 WS-TRANSACTION-DATA.
          05 WS-TRANS-ID          PIC 9(09).
          05 WS-ACCOUNT-NUMBER    PIC X(10).
          05 WS-SECURITY-SYMBOL   PIC X(05).
          05 WS-QUANTITY          PIC 9(08).
          05 WS-PRICE             PIC 9(07)V99.

       01 WS-AI-QUERY-PARAMS.
          05 WS-AI-QUERY-TYPE     PIC X(15).
          05 WS-AI-QUERY-DETAILS  PIC X(80).

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM 0010-INITIALIZE-SYSTEM.
           PERFORM 1000-CONTROL-LOOP UNTIL EXIT-IV-MENU.
           PERFORM 9000-TERMINATE-SYSTEM.
           GOBACK.

       0010-INITIALIZE-SYSTEM.
           DISPLAY "INITIALIZING INVESTMENT SERVICES SYSTEM..."
           MOVE FUNCTION CURRENT-DATE (9:8) TO WS-LAST-UPDATE-TIME
           MOVE FUNCTION CURRENT-DATE (1:8) TO WS-LAST-UPDATE-DATE
           DISPLAY "SYSTEM READY. AI MODULE STATUS: " WS-AI-MODULE-STATUS
           DISPLAY "LAST UPDATE: " WS-LAST-UPDATE-DATE " " WS-LAST-UPDATE-TIME
           .

       1000-CONTROL-LOOP.
           PERFORM 1100-DISPLAY-MENU.
           PERFORM 1200-ACCEPT-CHOICE.
           PERFORM 1300-PROCESS-CHOICE.
           .

       1100-DISPLAY-MENU.
           DISPLAY " ".
           DISPLAY "*************************************************".
           DISPLAY "*     INVESTMENT SERVICES SYSTEM (IVS)          *".
           DISPLAY "*************************************************".
           DISPLAY "*   1. EXECUTE BUY ORDER                        *".
           DISPLAY "*   2. EXECUTE SELL ORDER                       *".
           DISPLAY "*   3. INQUIRE POSITION                         *".
           DISPLAY "*   4. VIEW PORTFOLIO SUMMARY                   *".
           DISPLAY "*   5. AI-DRIVEN PORTFOLIO OPTIMIZATION         *".
           DISPLAY "*   6. REAL-TIME MARKET TREND ANALYSIS          *".
           DISPLAY "*   7. ADVANCED RISK ASSESSMENT                 *".
           DISPLAY "*   8. INTERACT WITH AI ADVISOR                 *".
           DISPLAY "*   9. SYSTEM CONFIGURATION & AI SETTINGS       *".
           DISPLAY "*   X. EXIT TO MAIN MENU                        *".
           DISPLAY "*************************************************".
           DISPLAY "AI STATUS: " WS-AI-MODULE-STATUS.
           DISPLAY "ENTER YOUR SELECTION: ".
           .

       1200-ACCEPT-CHOICE.
           ACCEPT WS-USER-CHOICE.
           MOVE FUNCTION UPPER-CASE(WS-USER-CHOICE) TO WS-USER-CHOICE.
           .

       1300-PROCESS-CHOICE.
           EVALUATE WS-USER-CHOICE
               WHEN "1"
                   DISPLAY "Initiating Buy Order process..."
                   CALL "IVBUY"
                       USING WS-TRANSACTION-DATA
                   DISPLAY "Buy Order module completed."
               WHEN "2"
                   DISPLAY "Initiating Sell Order process..."
                   CALL "IVSELL"
                       USING WS-TRANSACTION-DATA
                   DISPLAY "Sell Order module completed."
               WHEN "3"
                   DISPLAY "Initiating Position Inquiry..."
                   CALL "IVINQ"
                       USING WS-ACCOUNT-NUMBER, WS-SECURITY-SYMBOL
                   DISPLAY "Position Inquiry module completed."
               WHEN "4"
                   DISPLAY "Displaying Portfolio Summary..."
                   CALL "IVPORT"
                       USING WS-ACCOUNT-NUMBER
                   DISPLAY "Portfolio Summary module completed."
               WHEN "5"
                   DISPLAY "Initiating AI-Driven Portfolio Optimization..."
                   MOVE 'OPTIMIZE' TO WS-AI-QUERY-TYPE
                   MOVE 'CURRENT PORTFOLIO' TO WS-AI-QUERY-DETAILS
                   CALL "IVAIOPT"
                       USING WS-ACCOUNT-NUMBER, WS-AI-QUERY-PARAMS
                   DISPLAY "AI Optimization module completed."
                   MOVE 'READY' TO WS-AI-MODULE-STATUS
               WHEN "6"
                   DISPLAY "Accessing Real-Time Market Trend Analysis..."
                   MOVE 'TRENDS' TO WS-AI-QUERY-TYPE
                   MOVE 'GLOBAL MARKETS' TO WS-AI-QUERY-DETAILS
                   CALL "IVTREND"
                       USING WS-AI-QUERY-PARAMS
                   DISPLAY "Market Trend Analysis module completed."
                   MOVE 'READY' TO WS-AI-MODULE-STATUS
               WHEN "7"
                   DISPLAY "Performing Advanced Risk Assessment..."
                   MOVE 'RISK' TO WS-AI-QUERY-TYPE
                   MOVE 'PORTFOLIO STRESS TEST' TO WS-AI-QUERY-DETAILS
                   CALL "IVRISK"
                       USING WS-ACCOUNT-NUMBER, WS-AI-QUERY-PARAMS
                   DISPLAY "Risk Assessment module completed."
                   MOVE 'READY' TO WS-AI-MODULE-STATUS
               WHEN "8"
                   DISPLAY "Connecting to AI Advisor (IVCHAT)..."
                   MOVE 'ADVICE' TO WS-AI-QUERY-TYPE
                   MOVE 'GENERAL INQUIRY' TO WS-AI-QUERY-DETAILS
                   CALL "IVCHAT"
                       USING WS-ACCOUNT-NUMBER, WS-AI-QUERY-PARAMS
                   DISPLAY "AI Advisor session ended."
                   MOVE 'READY' TO WS-AI-MODULE-STATUS
               WHEN "9"
                   DISPLAY "Accessing System Configuration and AI Settings..."
                   CALL "IVCONF"
                   DISPLAY "Configuration module completed."
               WHEN "X"
                   DISPLAY "RETURNING TO MAIN MENU..."
               WHEN OTHER
                   DISPLAY "INVALID SELECTION. PLEASE TRY AGAIN."
           END-EVALUATE.
           .

       9000-TERMINATE-SYSTEM.
           DISPLAY "Investment Services System (IVS) is shutting down.".
           DISPLAY "Thank you for using our AI-enhanced services.".
           .