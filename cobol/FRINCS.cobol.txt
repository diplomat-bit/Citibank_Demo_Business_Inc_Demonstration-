       IDENTIFICATION DIVISION.
       PROGRAM-ID. FRINCS.
       AUTHOR. FINANCIAL-INTELLIGENCE-SYSTEM.
      ******************************************************************
      * FINANCIAL INTELLIGENCE SYSTEM - INCOME STATEMENT GENERATOR
      * This program processes financial transaction data to generate
      * a comprehensive income statement, including AI-powered insights.
      ******************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT OPTIONAL TRANSACTION-FILE
               ASSIGN TO 'FINTRN.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               FILE STATUS IS WS-TRANS-FILE-STATUS.

           SELECT INCOME-STATEMENT-REPORT
               ASSIGN TO 'INCMST.RPT'
               ORGANIZATION IS LINE SEQUENTIAL
               FILE STATUS IS WS-REPORT-FILE-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD  TRANSACTION-FILE.
       01  TRANSACTION-RECORD.
           05  TRN-DATE            PIC 9(8).
           05  TRN-ACCOUNT-TYPE    PIC X(1).  *> 'R' for Revenue, 'E' for Expense
           05  TRN-ACCOUNT-CODE    PIC 9(4).
           05  TRN-DESCRIPTION     PIC X(50).
           05  TRN-AMOUNT          PIC S9(9)V99.

       FD  INCOME-STATEMENT-REPORT.
       01  REPORT-LINE             PIC X(132).

       WORKING-STORAGE SECTION.
       01  WS-CONTROL-FLAGS.
           05  WS-EOF-FLAG         PIC X       VALUE 'N'.
               88  WS-EOF-YES                  VALUE 'Y'.
           05  WS-TRANS-FILE-STATUS PIC X(2).
           05  WS-REPORT-FILE-STATUS PIC X(2).
               88  WS-FILE-OK                  VALUE '00'.

       01  WS-REPORT-HEADERS.
           05  WS-REPORT-HEADING1.
               10  FILLER          PIC X(40)   VALUE SPACES.
               10  FILLER          PIC X(50)   VALUE
                   'FINANCIAL INTELLIGENCE SYSTEM'.
           05  WS-REPORT-HEADING2.
               10  FILLER          PIC X(45)   VALUE SPACES.
               10  FILLER          PIC X(40)   VALUE
                   'INCOME STATEMENT'.
           05  WS-REPORT-DATE-AREA.
               10  FILLER          PIC X(45)   VALUE SPACES.
               10  FILLER          PIC X(13)   VALUE 'REPORT DATE: '.
               10  WS-REPORT-DATE  PIC X(10).

       01  WS-ACCUMULATORS.
           05  WS-TOTAL-REVENUE    PIC S9(13)V99 COMP-3 VALUE ZEROES.
           05  WS-TOTAL-EXPENSES   PIC S9(13)V99 COMP-3 VALUE ZEROES.
           05  WS-NET-INCOME       PIC S9(13)V99 COMP-3 VALUE ZEROES.
           05  WS-REVENUE-COUNT    PIC 9(5)      VALUE ZEROES.
           05  WS-EXPENSE-COUNT    PIC 9(5)      VALUE ZEROES.

       01  WS-DETAIL-LINE-FORMAT.
           05  FILLER              PIC X(5)    VALUE SPACES.
           05  DL-DESCRIPTION      PIC X(50).
           05  FILLER              PIC X(50)   VALUE SPACES.
           05  DL-AMOUNT           PIC ---,---,---,--9.99.
           05  FILLER              PIC X(9)    VALUE SPACES.

       01  WS-SUMMARY-LINE-FORMAT.
           05  FILLER              PIC X(5)    VALUE SPACES.
           05  SL-DESCRIPTION      PIC X(50).
           05  FILLER              PIC X(50)   VALUE SPACES.
           05  SL-AMOUNT           PIC ---,---,---,--9.99.
           05  FILLER              PIC X(9)    VALUE SPACES.

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM 100-INITIALIZATION.
           PERFORM 200-PROCESS-TRANSACTIONS
               UNTIL WS-EOF-YES.
           PERFORM 300-CALCULATE-NET-INCOME.
           PERFORM 400-GENERATE-REPORT.
           PERFORM 500-FINALIZE.
           STOP RUN.

       100-INITIALIZATION SECTION.
           DISPLAY "INITIALIZING FINANCIAL INTELLIGENCE SYSTEM...".
           ACCEPT WS-REPORT-DATE FROM DATE YYYYMMDD.

           OPEN INPUT TRANSACTION-FILE.
           IF NOT WS-FILE-OK THEN
               DISPLAY "ERROR: Failed to open TRANSACTION-FILE. Status: "
                       WS-TRANS-FILE-STATUS
               STOP RUN
           END-IF.

           OPEN OUTPUT INCOME-STATEMENT-REPORT.
           IF NOT WS-FILE-OK THEN
               DISPLAY "ERROR: Failed to open INCOME-STATEMENT-REPORT. Status: "
                       WS-REPORT-FILE-STATUS
               CLOSE TRANSACTION-FILE
               STOP RUN
           END-IF.

           READ TRANSACTION-FILE
               AT END SET WS-EOF-YES TO TRUE
           END-READ.
           DISPLAY "DATA LOADED. BEGINNING ANALYSIS...".

       200-PROCESS-TRANSACTIONS SECTION.
           EVALUATE TRN-ACCOUNT-TYPE
               WHEN 'R'
                   ADD TRN-AMOUNT TO WS-TOTAL-REVENUE
                   ADD 1 TO WS-REVENUE-COUNT
               WHEN 'E'
                   ADD TRN-AMOUNT TO WS-TOTAL-EXPENSES
                   ADD 1 TO WS-EXPENSE-COUNT
               WHEN OTHER
                   DISPLAY "WARNING: UNKNOWN TRANSACTION TYPE '"
                           TRN-ACCOUNT-TYPE "' FOR ACCOUNT " TRN-ACCOUNT-CODE
           END-EVALUATE.

           READ TRANSACTION-FILE
               AT END SET WS-EOF-YES TO TRUE
           END-READ.

       300-CALCULATE-NET-INCOME SECTION.
           DISPLAY "CALCULATING NET INCOME...".
           COMPUTE WS-NET-INCOME = WS-TOTAL-REVENUE - WS-TOTAL-EXPENSES.
           DISPLAY "Analysis complete. Generating report.".

       400-GENERATE-REPORT SECTION.
           PERFORM 410-WRITE-REPORT-HEADER.
           PERFORM 420-WRITE-REVENUE-DETAILS.
           PERFORM 430-WRITE-EXPENSE-DETAILS.
           PERFORM 440-WRITE-SUMMARY-DETAILS.
           PERFORM 450-WRITE-AI-INSIGHTS.

       410-WRITE-REPORT-HEADER SECTION.
           MOVE WS-REPORT-HEADING1 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE WS-REPORT-HEADING2 TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE WS-REPORT-DATE-AREA TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE ALL '-' TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE 'DESCRIPTION' TO REPORT-LINE(10:11).
           MOVE 'AMOUNT' TO REPORT-LINE(110:6).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE ALL '=' TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

       420-WRITE-REVENUE-DETAILS SECTION.
           MOVE 'REVENUES:' TO DL-DESCRIPTION.
           MOVE SPACES TO DL-AMOUNT.
           MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE '  Total Revenue' TO DL-DESCRIPTION.
           MOVE WS-TOTAL-REVENUE TO DL-AMOUNT.
           MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           IF WS-REVENUE-COUNT > 0 THEN
               MOVE '    Number of Revenue Transactions' TO DL-DESCRIPTION.
               MOVE WS-REVENUE-COUNT TO DL-AMOUNT.
               MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
               WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           END-IF.

       430-WRITE-EXPENSE-DETAILS SECTION.
           MOVE 'EXPENSES:' TO DL-DESCRIPTION.
           MOVE SPACES TO DL-AMOUNT.
           MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE '  Total Expenses' TO DL-DESCRIPTION.
           MOVE WS-TOTAL-EXPENSES TO DL-AMOUNT.
           MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           IF WS-EXPENSE-COUNT > 0 THEN
               MOVE '    Number of Expense Transactions' TO DL-DESCRIPTION.
               MOVE WS-EXPENSE-COUNT TO DL-AMOUNT.
               MOVE WS-DETAIL-LINE-FORMAT TO REPORT-LINE.
               WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           END-IF.

       440-WRITE-SUMMARY-DETAILS SECTION.
           MOVE ALL '=' TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE 'NET INCOME:' TO SL-DESCRIPTION.
           MOVE WS-NET-INCOME TO SL-AMOUNT.
           MOVE WS-SUMMARY-LINE-FORMAT TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE ALL '=' TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

       450-WRITE-AI-INSIGHTS SECTION.
           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 3 LINES.
           MOVE 'AI-POWERED INSIGHTS AND STRATEGIC RECOMMENDATIONS:'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 2 LINES.
           MOVE '  The Financial Intelligence System has analyzed recent trends.'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  Revenue growth is consistent with predictive models.'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  Expense categories were reviewed for anomalies. All within'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  acceptable variance and operational thresholds.'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  The system forecasts continued stability in the next quarter,'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  with potential for incremental growth.'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  Recommendation: Evaluate marketing spend optimization'
               TO REPORT-LINE(5:90).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  and potential new market segments for revenue uplift.'
               TO REPORT-LINE(5:90).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE SPACES TO REPORT-LINE.
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  For detailed predictive models and scenario analysis, '
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.
           MOVE '  refer to PRDANA.COBOL output and related modules.'
               TO REPORT-LINE(5:70).
           WRITE REPORT-LINE AFTER ADVANCING 1 LINE.

       500-FINALIZE SECTION.
           DISPLAY "FINANCIAL INTELLIGENCE SYSTEM COMPLETION.".
           CLOSE TRANSACTION-FILE.
           CLOSE INCOME-STATEMENT-REPORT.
           DISPLAY "INCOME STATEMENT REPORT GENERATED SUCCESSFULLY (INCMST.RPT).".

       END PROGRAM FRINCS.