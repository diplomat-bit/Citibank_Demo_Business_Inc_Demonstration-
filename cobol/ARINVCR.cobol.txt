               IDENTIFICATION DIVISION.
       PROGRAM-ID. ARINVCR.
       AUTHOR. MAINFRAME SYSTEMS.
      ******************************************************************
      * ACCOUNTS RECEIVABLE INVOICE GENERATION WITH AUTOMATED ANALYSIS
      *
      * This program generates accounts receivable invoices. It
      * incorporates an analytical module to perform automated credit
      * risk assessment, payment prediction, and anomaly detection.
      * The module provides data-driven recommendations to optimize
      * AR operations by identifying high-risk transactions for
      * manual review.
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-MAINFRAME.
       OBJECT-COMPUTER. IBM-MAINFRAME.

       DATA DIVISION.
       WORKING-STORAGE SECTION.

      *================================================================*
      * 01. SYSTEM CONTROL AND STATUS FIELDS
      *================================================================*
       01  WS-PROGRAM-STATUS           PIC X(10) VALUE SPACES.
           88  PROGRAM-SUCCESS         VALUE 'SUCCESS'.
           88  PROGRAM-FAILURE         VALUE 'FAILURE'.
           88  PROCESSING-IN-PROGRESS  VALUE 'ACTIVE'.

       01  WS-CURRENT-DATE             PIC 9(08).
       01  WS-CURRENT-TIME             PIC 9(06).

      *================================================================*
      * 02. INVOICE RECORD STRUCTURE (Simulated)
      *================================================================*
       01  WS-INVOICE-RECORD.
           05  INV-HEADER.
               10  INV-NUMBER          PIC X(12).
               10  INV-CUSTOMER-ID     PIC X(08).
               10  INV-DATE            PIC 9(08).
               10  INV-DUE-DATE        PIC 9(08).
               10  INV-STATUS          PIC X(10) VALUE 'PENDING'.
                   88  INV-PAID        VALUE 'PAID'.
                   88  INV-OVERDUE     VALUE 'OVERDUE'.
                   88  INV-GENERATED   VALUE 'GENERATED'.
                   88  INV-REVIEW-FLAGGED VALUE 'REVIEW-FLAG'.
           05  INV-LINE-ITEMS OCCURS 10 TIMES.
               10  LINE-ITEM-CODE      PIC X(10).
               10  LINE-ITEM-DESC      PIC X(30).
               10  LINE-ITEM-QTY       PIC 9(03).
               10  LINE-ITEM-UNIT-PRICE PIC 9(05)V99.
               10  LINE-ITEM-AMOUNT    PIC 9(07)V99.
           05  INV-TOTAL-AMOUNT        PIC 9(09)V99.

      *================================================================*
      * 03. CUSTOMER MASTER DATA (Simulated for current customer)
      *================================================================*
       01  WS-CUSTOMER-MASTER.
           05  CUST-ID             PIC X(08).
           05  CUST-NAME           PIC X(30).
           05  CUST-ADDRESS        PIC X(50).
           05  CUST-CREDIT-LIMIT   PIC 9(09)V99.
           05  CUST-CURRENT-BALANCE PIC 9(09)V99.
           05  CUST-PAYMENT-HISTORY PIC 9(03) VALUE 0.
               88  CUST-EXCELLENT-PAYER VALUE 90 THRU 999.
               88  CUST-GOOD-PAYER      VALUE 60 THRU 89.
               88  CUST-AVERAGE-PAYER   VALUE 30 THRU 59.
               88  CUST-RISKY-PAYER     VALUE 00 THRU 29.
           05  CUST-LAST-PAYMENT-DAYS-LATE PIC 9(03) VALUE 0.

      *================================================================*
      * 04. AUTOMATED ANALYSIS RESULTS AND LOGS
      *================================================================*
       01  WS-ANALYSIS-RESULTS.
           05  ANALYSIS-RISK-SCORE     PIC 9(03) VALUE 0.
               88  ANALYSIS-RISK-LOW         VALUE 80 THRU 100.
               88  ANALYSIS-RISK-MEDIUM      VALUE 50 THRU 79.
               88  ANALYSIS-RISK-HIGH        VALUE 00 THRU 49.
           05  ANALYSIS-PAYMENT-PREDICTION   PIC X(30).
               88  PRED-PAY-EARLY        VALUE 'LIKELY EARLY'.
               88  PRED-PAY-ON-TIME      VALUE 'LIKELY ON-TIME'.
               88  PRED-PAY-SLIGHT-DELAY VALUE 'LIKELY SLIGHT DELAY'.
               88  PRED-PAY-MAJOR-DELAY  VALUE 'LIKELY MAJOR DELAY'.
           05  ANALYSIS-ANOMALY-SCORE  PIC 9(03) VALUE 0.
               88  ANOMALY-NONE     VALUE 00 THRU 10.
               88  ANOMALY-LOW      VALUE 11 THRU 30.
               88  ANOMALY-MEDIUM   VALUE 31 THRU 60.
               88  ANOMALY-HIGH     VALUE 61 THRU 100.
           05  ANALYSIS-RECOMMENDED-ACTION   PIC X(70).
           05  ANALYSIS-LOG-ENTRY            PIC X(200).
           05  ANALYSIS-ACTION-FLAG          PIC X(01) VALUE 'N'.
               88  ANALYSIS-ACTION-REQUIRED  VALUE 'Y'.

      *================================================================*
      * 05. TEMPORARY WORK FIELDS AND COUNTERS
      *================================================================*
       01  WS-LINE-ITEM-COUNT          PIC 9(02) VALUE 0.
       01  WS-ARRAY-IDX                PIC 9(02) VALUE 0.
       01  WS-INVOICE-SEQ-NUM          PIC 9(07) VALUE 1000001.
       01  WS-TEMP-DATE                PIC 9(08).
       01  WS-DAYS-TO-ADD              PIC 9(03).

      *================================================================*
      * 06. DISPLAY FORMATTING FIELDS
      *================================================================*
       01  WS-DISPLAY-AMOUNT           PIC $$$$,$$$,$$9.99.
       01  WS-DISPLAY-DATE             PIC 99/99/9999.


       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM 1000-INITIALIZE-SYSTEM.
           PERFORM 2000-RETRIEVE-ORDER-AND-CUSTOMER-DATA.
           PERFORM 3000-GENERATE-INVOICE-DETAILS.
           PERFORM 4000-AUTOMATED-ANALYSIS-PHASE.
           PERFORM 5000-FINALIZE-INVOICE-AND-LOG.
           PERFORM 6000-TERMINATE-SYSTEM.

           STOP RUN.

      *================================================================*
      * 1000-INITIALIZE-SYSTEM: Setup system variables and messages.
      *================================================================*
       1000-INITIALIZE-SYSTEM.
           DISPLAY " "
           DISPLAY "**************************************************"
           DISPLAY "* AR INVOICE GENERATION (AUTOMATED ANALYSIS)   *"
           DISPLAY "* Initializing AR invoice generation process.    *"
           DISPLAY "**************************************************"
           DISPLAY " "
           MOVE 'ACTIVE' TO WS-PROGRAM-STATUS.
           ACCEPT WS-CURRENT-DATE FROM DATE YYYYMMDD.
           ACCEPT WS-CURRENT-TIME FROM TIME.
           MOVE WS-CURRENT-DATE TO WS-TEMP-DATE.
           DISPLAY "SYSTEM INITIALIZED. CURRENT DATE: "
              WS-CURRENT-DATE(5:2) "/" WS-CURRENT-DATE(7:2) "/"
              WS-CURRENT-DATE(1:4).
           DISPLAY " "
           .

      *================================================================*
      * 2000-RETRIEVE-ORDER-AND-CUSTOMER-DATA: Simulate fetching raw
      *   order and customer data. In a real system, this would read
      *   from transactional files or databases.
      *================================================================*
       2000-RETRIEVE-ORDER-AND-CUSTOMER-DATA.
           DISPLAY "--- PHASE 1: DATA RETRIEVAL ---"
           DISPLAY "Retrieving customer and order data..."

           * Simulate Customer Data Retrieval
           * For this run, we'll use CUST001 with good history.
           * A future enhancement could involve reading multiple customer
           * profiles or specific scenarios.
           MOVE 'CUST001'           TO CUST-ID.
           MOVE 'GLOBAL ENTERPRISE LTD.' TO CUST-NAME.
           MOVE '123 AI Boulevard, Mainframe City, 90210'
                                   TO CUST-ADDRESS.
           MOVE 500000.00          TO CUST-CREDIT-LIMIT.
           MOVE 150000.00          TO CUST-CURRENT-BALANCE.
           MOVE 85                 TO CUST-PAYMENT-HISTORY. * Good payer
           MOVE 3                  TO CUST-LAST-PAYMENT-DAYS-LATE. * 3 days late

           DISPLAY "Customer Data retrieved for ID: " CUST-ID
           DISPLAY "Customer Name: " CUST-NAME
           DISPLAY "Customer Current Balance: " CUST-CURRENT-BALANCE
           DISPLAY "Customer Credit Limit: " CUST-CREDIT-LIMIT
           DISPLAY "Customer Payment History Score: " CUST-PAYMENT-HISTORY

           * Simulate Order Line Items Retrieval
           DISPLAY "Gathering associated order line items..."
           ADD 1 TO WS-LINE-ITEM-COUNT.
           MOVE 'PROD-A001'        TO LINE-ITEM-CODE(WS-LINE-ITEM-COUNT).
           MOVE 'AI Core Processor Unit'
                                   TO LINE-ITEM-DESC(WS-LINE-ITEM-COUNT).
           MOVE 2                  TO LINE-ITEM-QTY(WS-LINE-ITEM-COUNT).
           MOVE 25000.00           TO LINE-ITEM-UNIT-PRICE(WS-LINE-ITEM-COUNT).

           ADD 1 TO WS-LINE-ITEM-COUNT.
           MOVE 'SERV-S005'        TO LINE-ITEM-CODE(WS-LINE-ITEM-COUNT).
           MOVE 'Predictive Analytics License'
                                   TO LINE-ITEM-DESC(WS-LINE-ITEM-COUNT).
           MOVE 1                  TO LINE-ITEM-QTY(WS-LINE-ITEM-COUNT).
           MOVE 15000.00           TO LINE-ITEM-UNIT-PRICE(WS-LINE-ITEM-COUNT).

           ADD 1 TO WS-LINE-ITEM-COUNT.
           MOVE 'SUPP-M010'        TO LINE-ITEM-CODE(WS-LINE-ITEM-COUNT).
           MOVE '24/7 AI-Driven Support Contract'
                                   TO LINE-ITEM-DESC(WS-LINE-ITEM-COUNT).
           MOVE 1                  TO LINE-ITEM-QTY(WS-LINE-ITEM-COUNT).
           MOVE 10000.00           TO LINE-ITEM-UNIT-PRICE(WS-LINE-ITEM-COUNT).

           DISPLAY WS-LINE-ITEM-COUNT " Line Items identified for invoice."
           .

      *================================================================*
      * 3000-GENERATE-INVOICE-DETAILS: Create the invoice record.
      *================================================================*
       3000-GENERATE-INVOICE-DETAILS.
           DISPLAY " "
           DISPLAY "--- PHASE 2: INVOICE GENERATION ---"
           DISPLAY "Generating invoice document..."

           * Generate Unique Invoice Number
           MOVE WS-INVOICE-SEQ-NUM TO INV-NUMBER.
           ADD 1 TO WS-INVOICE-SEQ-NUM. * Increment for next invoice

           * Populate Header Details
           MOVE CUST-ID            TO INV-CUSTOMER-ID.
           MOVE WS-CURRENT-DATE    TO INV-DATE.

           * Default Due Date (30 days from invoice date)
           MOVE 30 TO WS-DAYS-TO-ADD.
           PERFORM 7000-CALCULATE-DUE-DATE.
           MOVE WS-TEMP-DATE       TO INV-DUE-DATE.

           MOVE 'GENERATED'        TO INV-STATUS.

           * Calculate Line Item Amounts and Grand Total
           MOVE 0 TO INV-TOTAL-AMOUNT.
           PERFORM VARYING WS-ARRAY-IDX FROM 1 BY 1
                   UNTIL WS-ARRAY-IDX > WS-LINE-ITEM-COUNT
               COMPUTE LINE-ITEM-AMOUNT(WS-ARRAY-IDX) =
                   LINE-ITEM-QTY(WS-ARRAY-IDX) *
                   LINE-ITEM-UNIT-PRICE(WS-ARRAY-IDX)
               ADD LINE-ITEM-AMOUNT(WS-ARRAY-IDX) TO INV-TOTAL-AMOUNT
           END-PERFORM.

           DISPLAY "Invoice Number: " INV-NUMBER " generated for Customer: " INV-CUSTOMER-ID
           MOVE INV-TOTAL-AMOUNT TO WS-DISPLAY-AMOUNT.
           DISPLAY "Preliminary Invoice Total: " WS-DISPLAY-AMOUNT
           .

      *================================================================*
      * 4000-AUTOMATED-ANALYSIS-PHASE: Execute analysis modules.
      *================================================================*
       4000-AUTOMATED-ANALYSIS-PHASE.
           DISPLAY " "
           DISPLAY "--- PHASE 3: AUTOMATED ANALYSIS ---"
           DISPLAY "Performing automated analysis: risk, payment, anomaly..."

           PERFORM 4100-ASSESS-CREDIT-RISK.
           PERFORM 4200-PREDICT-PAYMENT-BEHAVIOR.
           PERFORM 4300-DETECT-ANOMALIES.
           PERFORM 4400-GENERATE-RECOMMENDATION.

           DISPLAY "Analysis complete. Results generated."
           .

      * 4100-ASSESS-CREDIT-RISK: Calculate risk score based on
      *   customer history and current financial standing.
       4100-ASSESS-CREDIT-RISK.
           DISPLAY "  Executing credit risk assessment..."
           * Logic: Higher payment history -> Lower risk score.
           * Also consider current balance vs. credit limit.
           * For simulation, a simple rule:
           IF CUST-EXCELLENT-PAYER
               MOVE 95 TO ANALYSIS-RISK-SCORE
           ELSE IF CUST-GOOD-PAYER
               MOVE 70 TO ANALYSIS-RISK-SCORE
           ELSE IF CUST-AVERAGE-PAYER
               MOVE 45 TO ANALYSIS-RISK-SCORE
           ELSE
               MOVE 20 TO ANALYSIS-RISK-SCORE
           END-IF.

           * Adjust based on current balance vs. potential new invoice total
           IF (CUST-CURRENT-BALANCE + INV-TOTAL-AMOUNT) > CUST-CREDIT-LIMIT
               COMPUTE ANALYSIS-RISK-SCORE = ANALYSIS-RISK-SCORE / 2
               DISPLAY "  NOTE: Credit limit proximity affects risk score."
           END-IF.

           DISPLAY "  Risk Score: " ANALYSIS-RISK-SCORE.
           IF ANALYSIS-RISK-LOW
               DISPLAY "    (Result: Low Risk - Strong payment history.)"
           ELSE IF ANALYSIS-RISK-MEDIUM
               DISPLAY "    (Result: Medium Risk - Requires monitoring based on payment trends.)"
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           ELSE
               DISPLAY "    (Result: High Risk - High probability of delayed or non-payment.)"
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           END-IF.
           .

      * 4200-PREDICT-PAYMENT-BEHAVIOR: Predict payment speed based on
      *   risk, history, and invoice amount.
       4200-PREDICT-PAYMENT-BEHAVIOR.
           DISPLAY "  Executing payment behavior prediction..."
           * Logic: Predict payment speed based on risk, history, and amount.
           IF ANALYSIS-RISK-LOW AND CUST-LAST-PAYMENT-DAYS-LATE < 1
               MOVE 'LIKELY EARLY' TO ANALYSIS-PAYMENT-PREDICTION
           ELSE IF ANALYSIS-RISK-LOW OR CUST-GOOD-PAYER
               MOVE 'LIKELY ON-TIME' TO ANALYSIS-PAYMENT-PREDICTION
           ELSE IF ANALYSIS-RISK-MEDIUM OR CUST-AVERAGE-PAYER
               MOVE 'LIKELY SLIGHT DELAY' TO ANALYSIS-PAYMENT-PREDICTION
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           ELSE
               MOVE 'LIKELY MAJOR DELAY' TO ANALYSIS-PAYMENT-PREDICTION
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           END-IF.
           DISPLAY "  Prediction: " ANALYSIS-PAYMENT-PREDICTION.
           .

      * 4300-DETECT-ANOMALIES: Scan for unusual patterns in invoice details.
       4300-DETECT-ANOMALIES.
           DISPLAY "  Scanning for transactional anomalies..."
           MOVE 0 TO ANALYSIS-ANOMALY-SCORE.

           * Check for unusually large single invoice for new/risky customer
           IF INV-TOTAL-AMOUNT > 75000.00 AND (ANALYSIS-RISK-HIGH OR CUST-PAYMENT-HISTORY < 20)
               ADD 50 TO ANALYSIS-ANOMALY-SCORE
               DISPLAY "  FLAG: Large invoice amount for high-risk customer."
           END-IF.

           * Check for unusual line item quantities (e.g., extremely high qty for high-value item)
           PERFORM VARYING WS-ARRAY-IDX FROM 1 BY 1
                   UNTIL WS-ARRAY-IDX > WS-LINE-ITEM-COUNT
               IF LINE-ITEM-QTY(WS-ARRAY-IDX) > 10 AND
                  LINE-ITEM-UNIT-PRICE(WS-ARRAY-IDX) > 5000.00
                   ADD 30 TO ANALYSIS-ANOMALY-SCORE
                   DISPLAY "  FLAG: High quantity for high-value item."
               END-IF
           END-PERFORM.

           * Check for consistency in order patterns (simplified: for this example, our standard bundle is fine)
           * If more complex data, AI would compare to historical order profiles.
           IF WS-LINE-ITEM-COUNT NOT = 3 OR
              (LINE-ITEM-CODE(1) NOT = 'PROD-A001' AND
               LINE-ITEM-CODE(2) NOT = 'SERV-S005' AND
               LINE-ITEM-CODE(3) NOT = 'SUPP-M010')
              ADD 15 TO ANALYSIS-ANOMALY-SCORE
              DISPLAY "  FLAG: Order deviates from typical customer profile."
           END-IF.


           DISPLAY "  Anomaly Score: " ANALYSIS-ANOMALY-SCORE.
           IF ANOMALY-NONE
               DISPLAY "    (Result: No significant anomalies detected.)"
           ELSE IF ANOMALY-LOW
               DISPLAY "    (Result: Low anomaly score. Minor deviation noted.)"
           ELSE IF ANOMALY-MEDIUM
               DISPLAY "    (Result: Medium anomaly score. Manual review recommended.)"
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           ELSE
               DISPLAY "    (Result: HIGH ANOMALY SCORE. IMMEDIATE MANUAL REVIEW REQUIRED.)"
               SET ANALYSIS-ACTION-REQUIRED TO TRUE
           END-IF.
           .

      * 4400-GENERATE-RECOMMENDATION: Synthesize analysis into an action.
      *   This guides human operators or downstream automated processes.
       4400-GENERATE-RECOMMENDATION.
           DISPLAY "  Generating action recommendation..."
           MOVE SPACES TO ANALYSIS-RECOMMENDED-ACTION.

           IF ANALYSIS-ACTION-REQUIRED
               IF ANOMALY-HIGH
                   STRING "URGENT: Halt processing, immediate manual review "
                          "for potential fraud/error on " INV-NUMBER
                          DELIMITED BY SIZE INTO ANALYSIS-RECOMMENDED-ACTION
                   SET INV-REVIEW-FLAGGED TO TRUE
               ELSE IF ANOMALY-MEDIUM
                   STRING "Review Invoice " INV-NUMBER " for anomalies. "
                          "Verify order details before dispatch."
                          DELIMITED BY SIZE INTO ANALYSIS-RECOMMENDED-ACTION
                   SET INV-REVIEW-FLAGGED TO TRUE
               ELSE IF ANALYSIS-RISK-HIGH OR PRED-PAY-MAJOR-DELAY
                   STRING "Prioritize manual follow-up for " INV-NUMBER
                          ". Consider stricter payment terms next time."
                          DELIMITED BY SIZE INTO ANALYSIS-RECOMMENDED-ACTION
                   SET INV-REVIEW-FLAGGED TO TRUE
               END-IF
           END-IF.

           IF ANALYSIS-RECOMMENDED-ACTION = SPACES
               IF PRED-PAY-EARLY
                   MOVE 'Process invoice, encourage auto-pay for future efficiency.'
                                       TO ANALYSIS-RECOMMENDED-ACTION
               ELSE
                   MOVE 'Process invoice normally. Monitor payment. Standard follow-up.'
                                       TO ANALYSIS-RECOMMENDED-ACTION
               END-IF
           END-IF.
           DISPLAY "  Recommendation: " ANALYSIS-RECOMMENDED-ACTION.
           .

      *================================================================*
      * 5000-FINALIZE-INVOICE-AND-LOG: Store invoice and analysis.
      *================================================================*
       5000-FINALIZE-INVOICE-AND-LOG.
           DISPLAY " "
           DISPLAY "--- PHASE 4: FINALIZATION AND LOGGING ---"
           DISPLAY "Finalizing invoice and logging analysis results."

           * Update Invoice Status based on AI recommendations
           IF INV-REVIEW-FLAGGED
               MOVE 'REVIEW-FLAG' TO INV-STATUS
               DISPLAY "Invoice " INV-NUMBER " status set to 'REVIEW-FLAG' based on analysis."
           ELSE
               MOVE 'GENERATED' TO INV-STATUS
               DISPLAY "Invoice " INV-NUMBER " status set to 'GENERATED'."
           END-IF.

           * Simulate Writing Invoice Record
           DISPLAY " "
           DISPLAY "--------------------------------------------------"
           DISPLAY "      ACCOUNTS RECEIVABLE INVOICE SUMMARY         "
           DISPLAY "--------------------------------------------------"
           DISPLAY "INVOICE NO.: " INV-NUMBER
           DISPLAY "CUSTOMER ID: " INV-CUSTOMER-ID
           DISPLAY "CUSTOMER NAME: " CUST-NAME
           MOVE INV-DATE TO WS-DISPLAY-DATE.
           DISPLAY "INVOICE DATE: " WS-DISPLAY-DATE
           MOVE INV-DUE-DATE TO WS-DISPLAY-DATE.
           DISPLAY "DUE DATE: " WS-DISPLAY-DATE
           DISPLAY "STATUS: " INV-STATUS
           DISPLAY " "
           DISPLAY "LINE ITEMS:"
           PERFORM VARYING WS-ARRAY-IDX FROM 1 BY 1
                   UNTIL WS-ARRAY-IDX > WS-LINE-ITEM-COUNT
               MOVE LINE-ITEM-AMOUNT(WS-ARRAY-IDX) TO WS-DISPLAY-AMOUNT
               DISPLAY "  " LINE-ITEM-CODE(WS-ARRAY-IDX) " - "
                       LINE-ITEM-DESC(WS-ARRAY-IDX) (1:20)
                       " QTY: " LINE-ITEM-QTY(WS-ARRAY-IDX)
                       " UNIT: " LINE-ITEM-UNIT-PRICE(WS-ARRAY-IDX)
                       " TOTAL: " WS-DISPLAY-AMOUNT
           END-PERFORM.
           DISPLAY " "
           MOVE INV-TOTAL-AMOUNT TO WS-DISPLAY-AMOUNT.
           DISPLAY "GROSS TOTAL AMOUNT: " WS-DISPLAY-AMOUNT
           DISPLAY "--------------------------------------------------"

           * Log AI Decisions
           DISPLAY " "
           DISPLAY "ANALYSIS LOG:"
           STRING "INV: " INV-NUMBER
                  ", CUST: " CUST-ID
                  ", TOTAL: " WS-DISPLAY-AMOUNT
                  ", RISK: " ANALYSIS-RISK-SCORE
                  ", PRED: " ANALYSIS-PAYMENT-PREDICTION
                  ", ANOMALY: " ANALYSIS-ANOMALY-SCORE
                  ", REC: " ANALYSIS-RECOMMENDED-ACTION
                  DELIMITED BY SIZE INTO ANALYSIS-LOG-ENTRY
           DISPLAY ANALYSIS-LOG-ENTRY.
           DISPLAY " "
           DISPLAY "Invoice record and analysis log for " INV-NUMBER
                   " have been processed and archived (simulated)."
           .

      *================================================================*
      * 6000-TERMINATE-SYSTEM: Cleanup and exit.
      *================================================================*
       6000-TERMINATE-SYSTEM.
           DISPLAY " "
           DISPLAY "**************************************************"
           DISPLAY "* AR INVOICE SYSTEM SHUTDOWN                     *"
           DISPLAY "* Processing complete. System terminating.       *"
           DISPLAY "*                                                *"
           DISPLAY "**************************************************"
           DISPLAY " "
           MOVE 'SUCCESS' TO WS-PROGRAM-STATUS.
           .

      *================================================================*
      * 7000-CALCULATE-DUE-DATE: Adds days to WS-TEMP-DATE.
      *   This is a simplified date calculation.
      *================================================================*
       7000-CALCULATE-DUE-DATE.
           COMPUTE WS-TEMP-DATE = FUNCTION DATE-OF-INTEGER(
                                  FUNCTION INTEGER-OF-DATE(WS-TEMP-DATE)
                                  + WS-DAYS-TO-ADD).
           .