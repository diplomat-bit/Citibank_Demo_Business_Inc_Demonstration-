```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. RPYR.
       AUTHOR. ENTERPRISE-SYSTEMS-TEAM.
       DATE-WRITTEN. 1994-01-04.
      ******************************************************************
      * ENTERPRISE YEAR-END FINANCIAL REPORT GENERATION SYSTEM
      *
      * MASTER CONTROL PROGRAM FOR ALL YEAR-END CLOSE PROCEDURES.
      * ORCHESTRATES THE GENERATION OF FINAL, AUDIT-READY FINANCIAL
      * STATEMENTS, INCORPORATING ADVANCED ANALYTICS FOR VALIDATION.
      ******************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT ANNUAL-REPORT-FILE ASSIGN TO RPTYR01.
           SELECT GL-CLOSING-LOG-FILE ASSIGN TO GLCSELG.
           SELECT AI-INSIGHTS-FILE    ASSIGN TO AIINSPT.

       DATA DIVISION.
       FILE SECTION.
       FD ANNUAL-REPORT-FILE.
       01 REPORT-RECORD.
          05 RPT-LINE            PIC X(132).

       FD GL-CLOSING-LOG-FILE.
       01 GL-LOG-RECORD.
          05 GL-LOG-DATE         PIC 9(08).
          05 FILLER              PIC X(02) VALUE SPACES.
          05 GL-LOG-TIME         PIC 9(06).
          05 FILLER              PIC X(02) VALUE SPACES.
          05 GL-LOG-MESSAGE      PIC X(114).

       FD AI-INSIGHTS-FILE.
       01 AI-INSIGHT-RECORD.
          05 AI-INSIGHT-TYPE     PIC X(10).
          05 AI-INSIGHT-DETAILS  PIC X(122).

       WORKING-STORAGE SECTION.
       01 WS-CONTROL-FLAGS.
          05 WS-CURRENT-YEAR      PIC 9(04).
          05 WS-PROGRAM-STATUS    PIC X(10) VALUE 'INIT'.
          05 WS-GL-CLOSE-SUCCESS  PIC X(01) VALUE 'N'.
             88 GL-CLOSED-OK               VALUE 'Y'.
          05 WS-REPORT-GEN-SUCCESS PIC X(01) VALUE 'N'.
             88 REPORT-GENERATED-OK        VALUE 'Y'.
          05 WS-AI-ANALYSIS-STATUS PIC X(01) VALUE 'N'.
             88 AI-ANALYSIS-COMPLETE       VALUE 'Y'.
          05 WS-ANOMALY-FOUND     PIC X(01) VALUE 'N'.
             88 ANOMALY-DETECTED           VALUE 'Y'.

       01 WS-REPORT-COUNTERS.
          05 WS-LINES-WRITTEN     PIC 9(05) VALUE ZEROS.
          05 WS-REPORT-PAGE-NUM   PIC 9(03) VALUE 1.

       01 WS-DATE-TIME.
          05 WS-DATE-YYYYMMDD     PIC 9(08).
          05 WS-TIME-HHMMSS       PIC 9(06).

       01 WS-AI-DATA.
          05 WS-AI-ANOMALY-COUNT  PIC 9(03) VALUE ZEROS.
          05 WS-AI-RISK-SCORE     PIC 9(03) VALUE ZEROS.
          05 WS-AI-SUMMARY-STATUS PIC X(20) VALUE SPACES.
          05 WS-AI-RECOMMENDATION PIC X(80) VALUE SPACES.

       01 WS-REPORT-HEADERS.
          05 WS-ANNUAL-HEADER-1   PIC X(132) VALUE
             "*** ANNUAL FINANCIAL REPORT - DETAILED STATEMENTS ***".
          05 WS-ANNUAL-HEADER-2   PIC X(132).
          05 WS-INCOME-STATEMENT  PIC X(132) VALUE
             "--- INCOME STATEMENT ---".
          05 WS-BALANCE-SHEET     PIC X(132) VALUE
             "--- BALANCE SHEET ---".
          05 WS-CASH-FLOW         PIC X(132) VALUE
             "--- STATEMENT OF CASH FLOWS ---".
          05 WS-NOTES-FOOTER      PIC X(132) VALUE
             "--- NOTES TO FINANCIAL STATEMENTS ---".
          05 WS-AI-REVIEW-HEADER  PIC X(132) VALUE
             "--- AI-POWERED ANALYTICS SUMMARY ---".

       PROCEDURE DIVISION.
       0000-MAIN-LOGIC.
      * SYSTEM PROMPT: See prompts/idgafai_full.txt
           DISPLAY " ".
           DISPLAY "*************************************************".
           DISPLAY "*   RPYR - YEAR-END CLOSE & REPORTING - STARTED   *".
           DISPLAY "*************************************************".
           MOVE FUNCTION CURRENT-DATE (1:8) TO WS-DATE-YYYYMMDD.
           MOVE FUNCTION CURRENT-DATE (9:6) TO WS-TIME-HHMMSS.

           ACCEPT WS-CURRENT-YEAR FROM DATE YYYYMMDD.
           SUBTRACT 1 FROM WS-CURRENT-YEAR.
           DISPLAY "PROCESSING FOR FISCAL YEAR: " WS-CURRENT-YEAR.

           PERFORM 1000-RUN-FINAL-QUARTER-REPORT.
           PERFORM 2000-CLOSE-GENERAL-LEDGER.
           PERFORM 3000-GENERATE-ANNUAL-STATEMENTS.
           PERFORM 5000-AI-DRIVEN-ANALYSIS.
           PERFORM 4000-LOG-FOR-AUDIT.
           PERFORM 6000-FINAL-REVIEW-AND-DISTRIBUTION.

           DISPLAY "*************************************************".
           DISPLAY "*   RPYR - YEAR-END PROCESSING - COMPLETE       *".
           DISPLAY "*************************************************".
           DISPLAY " ".
           STOP RUN.

       1000-RUN-FINAL-QUARTER-REPORT.
           MOVE 'Q4-REPORT' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 1: GENERATING FINAL Q4 REPORT...".
           CALL "RPQTR" USING WS-CURRENT-YEAR.
           DISPLAY "FINAL Q4 REPORT GENERATION REQUESTED.".
           DISPLAY "CHECK RPQTR LOGS FOR COMPLETION STATUS.".

       2000-CLOSE-GENERAL-LEDGER.
           MOVE 'GL-CLOSE' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 2: CLOSING GENERAL LEDGER FOR FISCAL YEAR "
                   WS-CURRENT-YEAR "...".

           OPEN EXTEND GL-CLOSING-LOG-FILE.
           MOVE WS-DATE-YYYYMMDD TO GL-LOG-DATE.
           MOVE WS-TIME-HHMMSS TO GL-LOG-TIME.
           STRING "Initiating General Ledger Close for " WS-CURRENT-YEAR
                  "..." INTO GL-LOG-MESSAGE.
           WRITE GL-LOG-RECORD.

           DISPLAY "   2.1: Posting adjusting and accrual entries...".
           CALL "ADJENTR" USING WS-CURRENT-YEAR.
           MOVE WS-DATE-YYYYMMDD TO GL-LOG-DATE.
           MOVE WS-TIME-HHMMSS TO GL-LOG-TIME.
           STRING "Adjusting Entries Posted." INTO GL-LOG-MESSAGE.
           WRITE GL-LOG-RECORD.

           DISPLAY "   2.2: Calculating and posting retained earnings...".
           CALL "RETCALC" USING WS-CURRENT-YEAR.
           MOVE WS-DATE-YYYYMMDD TO GL-LOG-DATE.
           MOVE WS-TIME-HHMMSS TO GL-LOG-TIME.
           STRING "Retained Earnings Calculated and Posted."
                  INTO GL-LOG-MESSAGE.
           WRITE GL-LOG-RECORD.

           DISPLAY "   2.3: Rolling forward balances for new fiscal year...".
           CALL "ROLLFWD" USING WS-CURRENT-YEAR.
           MOVE WS-DATE-YYYYMMDD TO GL-LOG-DATE.
           MOVE WS-TIME-HHMMSS TO GL-LOG-TIME.
           STRING "Balances Rolled Forward to New Fiscal Year."
                  INTO GL-LOG-MESSAGE.
           WRITE GL-LOG-RECORD.

           CLOSE GL-CLOSING-LOG-FILE.
           SET GL-CLOSED-OK TO TRUE.
           DISPLAY "GENERAL LEDGER CLOSED SUCCESSFULLY FOR " WS-CURRENT-YEAR ".".

       3000-GENERATE-ANNUAL-STATEMENTS.
           MOVE 'REPORT-GEN' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 3: GENERATING COMPREHENSIVE ANNUAL FINANCIAL STATEMENTS...".

           OPEN OUTPUT ANNUAL-REPORT-FILE.
           IF NOT GL-CLOSED-OK THEN
               DISPLAY "WARNING: GL not successfully closed. Reports may be incomplete."
               MOVE "Report Gen Failed - GL Not Closed" TO RPT-LINE
               WRITE REPORT-RECORD
               GO TO 3900-GENERATE-ANNUAL-EXIT
           END-IF.

           STRING "Fiscal Year: " WS-CURRENT-YEAR
                  "  Date: " WS-DATE-YYYYMMDD
                  "  Page: " WS-REPORT-PAGE-NUM
                  DELIMITED BY SIZE INTO WS-ANNUAL-HEADER-2.

           MOVE WS-ANNUAL-HEADER-1 TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           MOVE WS-ANNUAL-HEADER-2 TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           MOVE ALL '-' TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.

           DISPLAY "   3.1: Generating Income Statement...".
           MOVE WS-INCOME-STATEMENT TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           CALL "INCSTMNT" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE,
                                 BY REFERENCE WS-LINES-WRITTEN,
                                 BY REFERENCE WS-REPORT-PAGE-NUM.
           DISPLAY "   Income Statement generated. Lines: " WS-LINES-WRITTEN.

           DISPLAY "   3.2: Generating Balance Sheet...".
           MOVE WS-BALANCE-SHEET TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           CALL "BALSHET" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE,
                                BY REFERENCE WS-LINES-WRITTEN,
                                BY REFERENCE WS-REPORT-PAGE-NUM.
           DISPLAY "   Balance Sheet generated. Lines: " WS-LINES-WRITTEN.

           DISPLAY "   3.3: Generating Statement of Cash Flows...".
           MOVE WS-CASH-FLOW TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           CALL "CASHFLOW" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE,
                                 BY REFERENCE WS-LINES-WRITTEN,
                                 BY REFERENCE WS-REPORT-PAGE-NUM.
           DISPLAY "   Cash Flow Statement generated. Lines: " WS-LINES-WRITTEN.

           DISPLAY "   3.4: Appending Notes to Financial Statements...".
           MOVE WS-NOTES-FOOTER TO RPT-LINE.
           WRITE REPORT-RECORD.
           ADD 1 TO WS-LINES-WRITTEN.
           CALL "NOTESFIN" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE,
                                 BY REFERENCE WS-LINES-WRITTEN,
                                 BY REFERENCE WS-REPORT-PAGE-NUM.
           DISPLAY "   Notes to Financial Statements appended.".

           CLOSE ANNUAL-REPORT-FILE.
           SET REPORT-GENERATED-OK TO TRUE.
           DISPLAY "ANNUAL STATEMENTS GENERATED. Total lines: " WS-LINES-WRITTEN.

       3900-GENERATE-ANNUAL-EXIT.
           EXIT.

       4000-LOG-FOR-AUDIT.
           MOVE 'AUDIT-LOG' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 4: CREATING FINAL AUDIT TRAIL...".
           CALL "AUTRAIL" USING "YEAR-END-CLOSE" WS-CURRENT-YEAR.
           DISPLAY "SYSTEM AUDIT TRAIL IS NOW UPDATED FOR ANNUAL REVIEW.".

       5000-AI-DRIVEN-ANALYSIS.
           MOVE 'AI-ANALYZE' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 5: INITIATING AI-POWERED FINANCIAL STATEMENT ANALYSIS...".
           DISPLAY "   The Analytical Insight Engine (AIE) is reviewing generated reports.".

           OPEN OUTPUT AI-INSIGHTS-FILE.
           MOVE WS-AI-REVIEW-HEADER TO RPT-LINE.
           OPEN EXTEND ANNUAL-REPORT-FILE.
           WRITE REPORT-RECORD FROM RPT-LINE.
           CLOSE ANNUAL-REPORT-FILE.

           IF NOT REPORT-GENERATED-OK THEN
               DISPLAY "WARNING: Reports not successfully generated. AI analysis skipped."
               MOVE "AI-STATUS" TO AI-INSIGHT-TYPE
               MOVE "AI Analysis Skipped - Reports Not Generated" TO AI-INSIGHT-DETAILS
               WRITE AI-INSIGHT-RECORD
               GO TO 5900-AI-DRIVEN-EXIT
           END-IF.

           CALL "AIANLYS" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE,
                                 BY REFERENCE WS-AI-ANOMALY-COUNT,
                                 BY REFERENCE WS-AI-RISK-SCORE,
                                 BY REFERENCE WS-AI-SUMMARY-STATUS,
                                 BY REFERENCE WS-AI-RECOMMENDATION.

           SET AI-ANALYSIS-COMPLETE TO TRUE.
           DISPLAY "   AI analysis complete.".
           STRING "AI-STATUS" INTO AI-INSIGHT-TYPE.
           STRING "Analysis Complete. Risk Score: " WS-AI-RISK-SCORE
                  " Anomaly Count: " WS-AI-ANOMALY-COUNT
                  INTO AI-INSIGHT-DETAILS.
           WRITE AI-INSIGHT-RECORD.

           IF WS-AI-ANOMALY-COUNT > ZEROS THEN
               SET ANOMALY-DETECTED TO TRUE.
               DISPLAY "   *** CRITICAL: AI DETECTED " WS-AI-ANOMALY-COUNT
                       " POTENTIAL ANOMALIES IN THE FINANCIALS! ***".
               DISPLAY "   AI Summary: " WS-AI-SUMMARY-STATUS.
               DISPLAY "   AI Recommendation: " WS-AI-RECOMMENDATION.
               STRING "ANOMALY" INTO AI-INSIGHT-TYPE.
               STRING WS-AI-SUMMARY-STATUS DELIMITED BY SPACE
                      " - " WS-AI-RECOMMENDATION DELIMITED BY SPACE
                      INTO AI-INSIGHT-DETAILS.
               WRITE AI-INSIGHT-RECORD.
           ELSE
               DISPLAY "   AI reports no significant anomalies. Risk Score: "
                       WS-AI-RISK-SCORE " (Low)".
               STRING "SUMMARY" INTO AI-INSIGHT-TYPE.
               STRING "No significant anomalies detected. "
                      WS-AI-SUMMARY-STATUS DELIMITED BY SPACE
                      INTO AI-INSIGHT-DETAILS.
               WRITE AI-INSIGHT-RECORD.
           END-IF.

           OPEN EXTEND ANNUAL-REPORT-FILE.
           MOVE ALL '-' TO RPT-LINE.
           WRITE REPORT-RECORD.
           STRING "AI Analysis Results:" INTO RPT-LINE.
           WRITE REPORT-RECORD.
           STRING "  Anomaly Count: " WS-AI-ANOMALY-COUNT
                  "  Risk Score: " WS-AI-RISK-SCORE
                  INTO RPT-LINE.
           WRITE REPORT-RECORD.
           STRING "  AI Summary: " WS-AI-SUMMARY-STATUS
                  INTO RPT-LINE.
           WRITE REPORT-RECORD.
           IF ANOMALY-DETECTED THEN
               STRING "  AI Recommendation: " WS-AI-RECOMMENDATION
                      INTO RPT-LINE.
               WRITE REPORT-RECORD.
           END-IF.
           MOVE ALL '-' TO RPT-LINE.
           WRITE REPORT-RECORD.
           CLOSE ANNUAL-REPORT-FILE.
           CLOSE AI-INSIGHTS-FILE.

       5900-AI-DRIVEN-EXIT.
           EXIT.

       6000-FINAL-REVIEW-AND-DISTRIBUTION.
           MOVE 'DISTRIBUTE' TO WS-PROGRAM-STATUS.
           DISPLAY "STEP 6: FINAL REVIEW, DIGITAL SIGNATURE, AND DISTRIBUTION...".

           IF ANOMALY-DETECTED THEN
               DISPLAY "   *** WARNING: ANOMALIES DETECTED. MANUAL REVIEW REQUIRED BEFORE FINALIZATION. ***".
               DISPLAY "   Distribution paused until anomalies resolved.".
               STRING "MANUAL-REVIEW-REQUIRED: Anomalies detected by AI. Review AIINSPT for details."
                      INTO RPT-LINE.
               OPEN EXTEND ANNUAL-REPORT-FILE.
               WRITE REPORT-RECORD FROM RPT-LINE.
               CLOSE ANNUAL-REPORT-FILE.
               GO TO 6900-DISTRIBUTION-EXIT.
           END-IF.

           DISPLAY "   6.1: Performing final internal consistency checks...".
           CALL "CONSCHK" USING WS-CURRENT-YEAR.
           DISPLAY "   Consistency checks passed.".

           DISPLAY "   6.2: Applying digital signature to annual report...".
           CALL "SIGNRPT" USING WS-CURRENT-YEAR, ANNUAL-REPORT-FILE.
           DISPLAY "   Digital signature applied. Report integrity verified.".

           DISPLAY "   6.3: Packaging reports for secure distribution...".
           CALL "PKGARCH" USING WS-CURRENT-YEAR.
           DISPLAY "   Reports packaged and archived.".

           DISPLAY "   6.4: Notifying stakeholders of report availability...".
           CALL "NOTIFY" USING WS-CURRENT-YEAR, "ANNUAL-REPORT-READY".
           DISPLAY "   Stakeholders notified. Year-end reporting cycle complete.".

       6900-DISTRIBUTION-EXIT.
           EXIT.
```