```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. APVNDBL.
       AUTHOR. JAMES BURVEL OCALLAGHAN III.
      ******************************************************************
      * APVNDBL - Vendor Bill Processing Module
      * This program facilitates the entry of new vendor bills into the
      * system, leveraging advanced analytics and AI for efficiency
      * and robust validation.
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. MAINFRAME-A.
       OBJECT-COMPUTER. MAINFRAME-A.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT AP-BILL-FILE ASSIGN TO 'APBILL.DAT'
               ORGANIZATION IS SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS AP-BILL-FILE-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD  AP-BILL-FILE
           RECORD CONTAINS 200 CHARACTERS
           DATA RECORD IS AP-BILL-RECORD.
       01  AP-BILL-RECORD.
           05  APR-VENDOR-ID           PIC X(10).
           05  APR-INVOICE-NO          PIC X(15).
           05  APR-INVOICE-DATE        PIC 9(08).  *> YYYYMMDD
           05  APR-DUE-DATE            PIC 9(08).  *> YYYYMMDD
           05  APR-TOTAL-AMOUNT        PIC S9(11)V99.
           05  APR-CURRENCY            PIC X(03).
           05  APR-DESCRIPTION         PIC X(50).
           05  APR-STATUS              PIC X(10).
           05  APR-FILLER              PIC X(81).  *> Pads record to 200 chars

       WORKING-STORAGE SECTION.

      * --- File Status Variable ---
       01  AP-BILL-FILE-STATUS     PIC X(02) VALUE '00'.

      * --- Vendor Bill Data Structure ---
       01  WS-VENDOR-BILL-DATA.
           05  WVB-VENDOR-ID           PIC X(10).
           05  WVB-INVOICE-NO          PIC X(15).
           05  WVB-INVOICE-DATE        PIC 9(08).  *> YYYYMMDD
           05  WVB-DUE-DATE            PIC 9(08).  *> YYYYMMDD
           05  WVB-TOTAL-AMOUNT        PIC S9(11)V99 COMP-3.
           05  WVB-CURRENCY            PIC X(03) VALUE 'USD'.
           05  WVB-DESCRIPTION         PIC X(50).
           05  WVB-STATUS              PIC X(10) VALUE 'PENDING'.
           05  WVB-LINE-ITEM-COUNT     PIC 9(02).
           05  WVB-LINE-ITEMS OCCURS 10 TIMES.
               10  WVB-ITEM-DESC       PIC X(30).
               10  WVB-ITEM-AMOUNT     PIC S9(09)V99 COMP-3.
               10  WVB-GL-ACCOUNT      PIC X(10).

      * --- Input Fields ---
       01  WS-INPUT-FIELDS.
           05  WSI-VENDOR-ID           PIC X(10).
           05  WSI-INVOICE-NO          PIC X(15).
           05  WSI-INVOICE-DATE-STR    PIC X(08).
           05  WSI-DUE-DATE-STR        PIC X(08).
           05  WSI-DESCRIPTION         PIC X(50).
           05  WSI-LINE-ITEM-INPUT.
               10  WSI-ITEM-DESC       PIC X(30).
               10  WSI-ITEM-AMOUNT-STR PIC X(15).

      * --- Program Control Flags ---
       01  WS-PROGRAM-FLAGS.
           05  WSF-VALID-INPUT         PIC X(01) VALUE 'Y'.
           05  WSF-EXIT-FLAG           PIC X(01) VALUE 'N'.
           05  WSF-LINE-ITEM-END       PIC X(01) VALUE 'N'.

      * --- Temporary Fields for Validation Sub-Paragraphs ---
       01  WS-TEMP-AMOUNT-FIELDS.
           05  WSTA-INPUT-AMOUNT-STR   PIC X(15).
           05  WSTA-OUTPUT-NUM-AMOUNT  PIC S9(11)V99 COMP-3.
           05  WSTA-VALID-FLAG         PIC X(01). *> 'Y' or 'N' for amount validation

       01  WS-TEMP-DATE-FIELDS.
           05  WSTD-DATE-TO-CHECK-NUM  PIC 9(08).
           05  WSTD-DATE-TO-CHECK-STR REDEFINES WSTD-DATE-TO-CHECK-NUM.
               10  WSTD-YEAR           PIC 9(04).
               10  WSTD-MONTH          PIC 9(02).
               10  WSTD-DAY            PIC 9(02).
           05  WSTD-VALID-FLAG         PIC X(01). *> 'Y' or 'N' for date validation

      * --- AI Core Communication Area ---
       01  WS-AI-REQUEST-AREA.
           05  AI-REQ-VENDOR-ID        PIC X(10).
           05  AI-REQ-INVOICE-NO       PIC X(15).
           05  AI-REQ-INVOICE-DATE     PIC 9(08).
           05  AI-REQ-TOTAL-AMOUNT     PIC S9(11)V99 COMP-3.
           05  AI-REQ-DESCRIPTION      PIC X(50).
           05  AI-REQ-LINE-ITEM-COUNT  PIC 9(02).
           05  AI-REQ-LINE-ITEMS OCCURS 10 TIMES.
               10  AI-REQ-ITEM-DESC    PIC X(30).
               10  AI-REQ-ITEM-AMOUNT  PIC S9(09)V99 COMP-3.

       01  WS-AI-RESPONSE-AREA.
           05  AI-RESP-OVERALL-SCORE   PIC 9(03).  *> 000-100
           05  AI-RESP-DUPLICATE-FLAG  PIC X(01).  *> 'Y' or 'N'
           05  AI-RESP-ANOMALY-FLAG    PIC X(01).  *> 'Y' or 'N'
           05  AI-RESP-ANOMALY-REASON  PIC X(80).
           05  AI-RESP-SUGGESTED-GL    PIC X(10).
           05  AI-RESP-PAYMENT-ADVICE  PIC X(80).
           05  AI-RESP-FRAUD-RISK      PIC X(10).  *> 'LOW', 'MEDIUM', 'HIGH'
           05  AI-RESP-NARRATIVE       PIC X(200).
           05  AI-RESP-STATUS-CODE     PIC X(04).  *> '0000' for success

      * --- Counters ---
       01  WS-COUNTER              PIC 9(02).

       PROCEDURE DIVISION.
       MAIN-LOGIC SECTION.
           PERFORM INITIALIZE-PROGRAM.
           PERFORM GET-BILL-DETAILS
               UNTIL WSF-EXIT-FLAG = 'Y'.
           PERFORM VALIDATE-BILL-DATA.

           IF WSF-VALID-INPUT = 'Y' THEN
               PERFORM CALL-COGNITIVE-CORE
               PERFORM PROCESS-AI-RECOMMENDATIONS
               PERFORM STORE-VENDOR-BILL
               PERFORM CONFIRM-ENTRY
           ELSE
               DISPLAY "ERROR: Bill data is invalid. Please review.".
           END-IF.

           PERFORM TERMINATE-PROGRAM.
           STOP RUN.

       INITIALIZE-PROGRAM SECTION.
           DISPLAY "APVNDBL: Starting Vendor Bill Entry Module.".
           MOVE SPACES TO WS-VENDOR-BILL-DATA.
           MOVE SPACES TO WS-INPUT-FIELDS.
           MOVE 'Y' TO WSF-VALID-INPUT.
           MOVE 'N' TO WSF-EXIT-FLAG.
           MOVE 0 TO WVB-TOTAL-AMOUNT.
           MOVE 0 TO WVB-LINE-ITEM-COUNT.
           MOVE 'USD' TO WVB-CURRENCY.
           MOVE 'PENDING' TO WVB-STATUS.
           EXIT.

       GET-BILL-DETAILS SECTION.
           DISPLAY " ".
           DISPLAY "--- Enter Vendor Bill Details ---".
           DISPLAY "Enter Vendor ID (10 chars, or 'END' to exit): ".
           ACCEPT WSI-VENDOR-ID.

           IF WSI-VENDOR-ID = 'END' THEN
               MOVE 'Y' TO WSF-EXIT-FLAG
               EXIT SECTION
           END-IF.

           MOVE WSI-VENDOR-ID TO WVB-VENDOR-ID.

           DISPLAY "Enter Invoice Number (15 chars): ".
           ACCEPT WSI-INVOICE-NO.
           MOVE WSI-INVOICE-NO TO WVB-INVOICE-NO.

           DISPLAY "Enter Invoice Date (YYYYMMDD): ".
           ACCEPT WSI-INVOICE-DATE-STR.
           MOVE WSI-INVOICE-DATE-STR TO WVB-INVOICE-DATE.

           DISPLAY "Enter Due Date (YYYYMMDD): ".
           ACCEPT WSI-DUE-DATE-STR.
           MOVE WSI-DUE-DATE-STR TO WVB-DUE-DATE.

           DISPLAY "Enter Bill Description (50 chars): ".
           ACCEPT WSI-DESCRIPTION.
           MOVE WSI-DESCRIPTION TO WVB-DESCRIPTION.

           PERFORM GET-LINE-ITEMS.

           COMPUTE WVB-TOTAL-AMOUNT = 0.
           PERFORM VARYING WS-COUNTER FROM 1 BY 1
               UNTIL WS-COUNTER > WVB-LINE-ITEM-COUNT
               ADD WVB-ITEM-AMOUNT(WS-COUNTER) TO WVB-TOTAL-AMOUNT
           END-PERFORM.

           DISPLAY "Calculated Total Bill Amount: " WVB-TOTAL-AMOUNT.
           DISPLAY " ".
           MOVE 'Y' TO WSF-EXIT-FLAG. *> For now, exit after one bill entry
           EXIT.

       GET-LINE-ITEMS SECTION.
           MOVE 0 TO WVB-LINE-ITEM-COUNT.
           MOVE 'N' TO WSF-LINE-ITEM-END.
           PERFORM UNTIL WSF-LINE-ITEM-END = 'Y'
               ADD 1 TO WVB-LINE-ITEM-COUNT
               IF WVB-LINE-ITEM-COUNT > 10 THEN
                   DISPLAY "Maximum 10 line items reached. Finishing line item entry."
                   MOVE 'Y' TO WSF-LINE-ITEM-END
                   SUBTRACT 1 FROM WVB-LINE-ITEM-COUNT *> Don't count the over-limit increment
                   CONTINUE
               END-IF

               DISPLAY "--- Line Item " WVB-LINE-ITEM-COUNT " ---"
               DISPLAY "Enter Item Description (30 chars, or 'END' to finish): ".
               ACCEPT WSI-ITEM-DESC

               IF WSI-ITEM-DESC = 'END' THEN
                   MOVE 'Y' TO WSF-LINE-ITEM-END
                   SUBTRACT 1 FROM WVB-LINE-ITEM-COUNT *> Don't count the 'END' entry
                   CONTINUE
               END-IF

               MOVE WSI-ITEM-DESC TO WVB-ITEM-DESC(WVB-LINE-ITEM-COUNT)

               DISPLAY "Enter Item Amount (e.g., 1234.56): ".
               ACCEPT WSI-ITEM-AMOUNT-STR
               MOVE WSI-ITEM-AMOUNT-STR TO WSTA-INPUT-AMOUNT-STR
               PERFORM VALIDATE-AND-CONVERT-AMOUNT

               IF WSTA-VALID-FLAG = 'N' THEN
                   DISPLAY "Invalid amount for line item. Please re-enter this line."
                   MOVE 'N' TO WSF-VALID-INPUT *> Propagate the validation failure
                   SUBTRACT 1 FROM WVB-LINE-ITEM-COUNT
                   CONTINUE
               ELSE
                   MOVE WSTA-OUTPUT-NUM-AMOUNT TO WVB-ITEM-AMOUNT(WVB-LINE-ITEM-COUNT)
               END-IF
           END-PERFORM.
           EXIT.

       VALIDATE-AND-CONVERT-AMOUNT SECTION.
           *> This paragraph expects WSTA-INPUT-AMOUNT-STR to be pre-filled
           *> and will populate WSTA-OUTPUT-NUM-AMOUNT and WSTA-VALID-FLAG.
           MOVE 'Y' TO WSTA-VALID-FLAG.
           INSPECT WSTA-INPUT-AMOUNT-STR REPLACING ALL ',' BY SPACE.
           INSPECT WSTA-INPUT-AMOUNT-STR REPLACING ALL ' ' BY ZEROS FOR LEADING.

           IF FUNCTION TEST-NUMVAL-C(WSTA-INPUT-AMOUNT-STR) THEN
               COMPUTE WSTA-OUTPUT-NUM-AMOUNT = FUNCTION NUMVAL-C(WSTA-INPUT-AMOUNT-STR)
               IF WSTA-OUTPUT-NUM-AMOUNT < 0 THEN
                   DISPLAY "Amount cannot be negative."
                   MOVE 'N' TO WSTA-VALID-FLAG
               END-IF
           ELSE
               DISPLAY "Invalid amount format: " WSTA-INPUT-AMOUNT-STR
               MOVE 'N' TO WSTA-VALID-FLAG
           END-IF.
           EXIT.

       VALIDATE-BILL-DATA SECTION.
           MOVE 'Y' TO WSF-VALID-INPUT.
           DISPLAY "Validating bill data...".

           IF WVB-VENDOR-ID IS NOT ALPHANUMERIC OR WVB-VENDOR-ID = SPACES THEN
               DISPLAY "ERROR: Vendor ID is invalid or blank."
               MOVE 'N' TO WSF-VALID-INPUT
           END-IF.

           IF WVB-INVOICE-NO IS NOT ALPHANUMERIC OR WVB-INVOICE-NO = SPACES THEN
               DISPLAY "ERROR: Invoice Number is invalid or blank."
               MOVE 'N' TO WSF-VALID-INPUT
           END-IF.

           IF NOT (WVB-INVOICE-DATE IS NUMERIC AND WVB-INVOICE-DATE > 0) THEN
               DISPLAY "ERROR: Invoice Date is invalid (must be YYYYMMDD numeric)."
               MOVE 'N' TO WSF-VALID-INPUT
           ELSE
               MOVE WVB-INVOICE-DATE TO WSTD-DATE-TO-CHECK-NUM
               PERFORM VALIDATE-DATE-FORMAT
               IF WSTD-VALID-FLAG = 'N' THEN
                   DISPLAY "ERROR: Invoice Date format or value is incorrect."
                   MOVE 'N' TO WSF-VALID-INPUT
               END-IF
           END-IF.

           IF NOT (WVB-DUE-DATE IS NUMERIC AND WVB-DUE-DATE > 0) THEN
               DISPLAY "ERROR: Due Date is invalid (must be YYYYMMDD numeric)."
               MOVE 'N' TO WSF-VALID-INPUT
           ELSE
               MOVE WVB-DUE-DATE TO WSTD-DATE-TO-CHECK-NUM
               PERFORM VALIDATE-DATE-FORMAT
               IF WSTD-VALID-FLAG = 'N' THEN
                   DISPLAY "ERROR: Due Date format or value is incorrect."
                   MOVE 'N' TO WSF-VALID-INPUT
               END-IF
           END-IF.

           IF WVB-TOTAL-AMOUNT <= 0 THEN
               DISPLAY "ERROR: Total amount must be greater than zero."
               MOVE 'N' TO WSF-VALID-INPUT
           END-IF.

           IF WVB-LINE-ITEM-COUNT = 0 THEN
               DISPLAY "ERROR: At least one line item is required."
               MOVE 'N' TO WSF-VALID-INPUT
           END-IF.

           PERFORM VARYING WS-COUNTER FROM 1 BY 1
               UNTIL WS-COUNTER > WVB-LINE-ITEM-COUNT
               IF WVB-ITEM-AMOUNT(WS-COUNTER) <= 0 THEN
                   DISPLAY "ERROR: Line item " WS-COUNTER " amount must be positive."
                   MOVE 'N' TO WSF-VALID-INPUT
               END-IF
               IF WVB-ITEM-DESC(WS-COUNTER) = SPACES THEN
                   DISPLAY "ERROR: Line item " WS-COUNTER " description cannot be blank."
                   MOVE 'N' TO WSF-VALID-INPUT
               END-IF
           END-PERFORM.

           IF WSF-VALID-INPUT = 'Y' THEN
               DISPLAY "Bill data validation successful."
           ELSE
               DISPLAY "Bill data validation failed. Please correct errors."
           END-IF.
           EXIT.

       VALIDATE-DATE-FORMAT SECTION.
           *> This paragraph expects WSTD-DATE-TO-CHECK-NUM to be pre-filled
           *> and will populate WSTD-VALID-FLAG.
           MOVE 'Y' TO WSTD-VALID-FLAG.

           IF FUNCTION TEST-DATE-YYYYMMDD(WSTD-DATE-TO-CHECK-NUM) = 0 THEN
               MOVE 'N' TO WSTD-VALID-FLAG
           END-IF.
           EXIT.

       CALL-COGNITIVE-CORE SECTION.
           DISPLAY " ".
           DISPLAY "Connecting to Quantum Cognitive-Core for advanced analysis...".

           MOVE WVB-VENDOR-ID      TO AI-REQ-VENDOR-ID.
           MOVE WVB-INVOICE-NO     TO AI-REQ-INVOICE-NO.
           MOVE WVB-INVOICE-DATE   TO AI-REQ-INVOICE-DATE.
           MOVE WVB-TOTAL-AMOUNT   TO AI-REQ-TOTAL-AMOUNT.
           MOVE WVB-DESCRIPTION    TO AI-REQ-DESCRIPTION.
           MOVE WVB-LINE-ITEM-COUNT TO AI-REQ-LINE-ITEM-COUNT.

           PERFORM VARYING WS-COUNTER FROM 1 BY 1
               UNTIL WS-COUNTER > WVB-LINE-ITEM-COUNT
               MOVE WVB-ITEM-DESC(WS-COUNTER)   TO AI-REQ-ITEM-DESC(WS-COUNTER)
               MOVE WVB-ITEM-AMOUNT(WS-COUNTER) TO AI-REQ-ITEM-AMOUNT(WS-COUNTER)
           END-PERFORM.

           *> In a real system, this would be a CALL to a separate AI microservice
           *> or a specialized mainframe AI component 'QCCAPIAI'.
           *> For this example, we simulate a response.
           *> CALL 'QCCAPIAI' USING WS-AI-REQUEST-AREA, WS-AI-RESPONSE-AREA.

           *> --- Simulate AI Response ---
           MOVE '0000' TO AI-RESP-STATUS-CODE.
           IF WVB-INVOICE-NO = 'DUPLICATE123' THEN
               MOVE 'Y' TO AI-RESP-DUPLICATE-FLAG
               MOVE 50 TO AI-RESP-OVERALL-SCORE
           ELSE
               MOVE 'N' TO AI-RESP-DUPLICATE-FLAG
               MOVE 95 TO AI-RESP-OVERALL-SCORE
           END-IF.

           IF WVB-TOTAL-AMOUNT > 100000 THEN
               MOVE 'Y' TO AI-RESP-ANOMALY-FLAG
               MOVE 'Unusually high invoice amount for this vendor.' TO AI-RESP-ANOMALY-REASON
               MOVE 'HIGH' TO AI-RESP-FRAUD-RISK
               MOVE 'Recommend splitting payment or managerial approval.' TO AI-RESP-PAYMENT-ADVICE
               MOVE 'Potential high value transaction anomaly detected. Requires detailed review.' TO AI-RESP-NARRATIVE
           ELSE IF WVB-VENDOR-ID = 'FRDVNDR' THEN
               MOVE 'Y' TO AI-RESP-ANOMALY-FLAG
               MOVE 'Vendor flagged in previous fraud reports.' TO AI-RESP-ANOMALY-REASON
               MOVE 'HIGH' TO AI-RESP-FRAUD-RISK
               MOVE 'Immediate payment hold and investigation.' TO AI-RESP-PAYMENT-ADVICE
               MOVE 'Vendor linked to prior suspicious activities. Flagged for fraud investigation.' TO AI-RESP-NARRATIVE
           ELSE
               MOVE 'N' TO AI-RESP-ANOMALY-FLAG
               MOVE SPACES TO AI-RESP-ANOMALY-REASON
               MOVE 'LOW' TO AI-RESP-FRAUD-RISK
               MOVE 'Consider early payment for 2% discount if terms allow.' TO AI-RESP-PAYMENT-ADVICE
               MOVE 'This bill aligns with historical patterns and appears normal.' TO AI-RESP-NARRATIVE
           END-IF.

           IF WVB-DESCRIPTION CONTAINS 'SOFTWARE' OR WVB-DESCRIPTION CONTAINS 'LICENSE' THEN
               MOVE 'GL-SW001' TO AI-RESP-SUGGESTED-GL
           ELSE IF WVB-DESCRIPTION CONTAINS 'CONSULTING' OR WVB-DESCRIPTION CONTAINS 'SERVICES' THEN
               MOVE 'GL-SVC002' TO AI-RESP-SUGGESTED-GL
           ELSE
               MOVE 'GL-GEN003' TO AI-RESP-SUGGESTED-GL
           END-IF.
           *> --- End Simulate AI Response ---

           IF AI-RESP-STATUS-CODE = '0000' THEN
               DISPLAY "Quantum Cognitive-Core analysis complete. Insights received."
           ELSE
               DISPLAY "Quantum Cognitive-Core call failed with status: " AI-RESP-STATUS-CODE
               MOVE 'N' TO WSF-VALID-INPUT
           END-IF.
           EXIT.

       PROCESS-AI-RECOMMENDATIONS SECTION.
           DISPLAY " ".
           DISPLAY "--- Quantum Cognitive-Core Analysis Report ---".
           DISPLAY "Overall Bill AI Score: " AI-RESP-OVERALL-SCORE.

           IF AI-RESP-DUPLICATE-FLAG = 'Y' THEN
               DISPLAY "WARNING: Potential Duplicate Invoice Detected!"
               DISPLAY "         Further review is strongly recommended before payment."
               MOVE 'ALERT' TO WVB-STATUS
           END-IF.

           IF AI-RESP-ANOMALY-FLAG = 'Y' THEN
               DISPLAY "ALERT: Anomaly Detected: " AI-RESP-ANOMALY-REASON
               DISPLAY "       This bill deviates from usual patterns. Investigate immediately!"
               MOVE 'ALERT' TO WVB-STATUS
           END-IF.

           IF AI-RESP-FRAUD-RISK = 'HIGH' THEN
               DISPLAY "CRITICAL: High Fraud Risk Indicated!"
               DISPLAY "          Payment halted. Immediate investigation required by finance security."
               MOVE 'FROZEN' TO WVB-STATUS
           ELSE IF AI-RESP-FRAUD-RISK = 'MEDIUM' THEN
               DISPLAY "WARNING: Medium Fraud Risk. Proceed with caution and manager review."
               MOVE 'REVIEW' TO WVB-STATUS
           END-IF.

           IF AI-RESP-SUGGESTED-GL NOT = SPACES THEN
               DISPLAY "AI Suggestion for GL Account: " AI-RESP-SUGGESTED-GL
               *> For simplicity, auto-apply to the first line item if not already set.
               *> In a multi-line scenario, a more complex logic or user interaction would be needed.
               IF WVB-LINE-ITEM-COUNT > 0 AND WVB-GL-ACCOUNT(1) = SPACES THEN
                   MOVE AI-RESP-SUGGESTED-GL TO WVB-GL-ACCOUNT(1)
                   DISPLAY "      Automatically applied to first line item. Please verify for accuracy."
               ELSE IF WVB-LINE-ITEM-COUNT > 0 THEN
                   DISPLAY "      GL Account for first line item already set: " WVB-GL-ACCOUNT(1)
               END-IF
           END-IF.

           IF AI-RESP-PAYMENT-ADVICE NOT = SPACES THEN
               DISPLAY "Payment Optimization Advice: " AI-RESP-PAYMENT-ADVICE
               *> Logic could be added here to adjust due dates or flag for early payment.
           END-IF.

           DISPLAY "AI Narrative Summary: " AI-RESP-NARRATIVE.
           DISPLAY "---------------------------------------".
           EXIT.

       STORE-VENDOR-BILL SECTION.
           DISPLAY " ".
           IF WVB-STATUS = 'FROZEN' OR WVB-STATUS = 'ALERT' THEN
               DISPLAY "Bill entry postponed due to critical AI findings or alerts. Current Status: " WVB-STATUS
               EXIT.
           END-IF.

           DISPLAY "Opening AP_BILL_FILE for storage...".
           OPEN EXTEND AP-BILL-FILE.
           IF AP-BILL-FILE-STATUS NOT = '00' THEN
               DISPLAY "ERROR: Could not open AP_BILL_FILE. Status: " AP-BILL-FILE-STATUS
               MOVE 'N' TO WSF-VALID-INPUT
               CLOSE AP-BILL-FILE
               EXIT.
           END-IF.

           MOVE WVB-VENDOR-ID      TO APR-VENDOR-ID.
           MOVE WVB-INVOICE-NO     TO APR-INVOICE-NO.
           MOVE WVB-INVOICE-DATE   TO APR-INVOICE-DATE.
           MOVE WVB-DUE-DATE       TO APR-DUE-DATE.
           MOVE WVB-TOTAL-AMOUNT   TO APR-TOTAL-AMOUNT.
           MOVE WVB-CURRENCY       TO APR-CURRENCY.
           MOVE WVB-DESCRIPTION    TO APR-DESCRIPTION.
           MOVE WVB-STATUS         TO APR-STATUS.
           MOVE SPACES             TO APR-FILLER.

           WRITE AP-BILL-RECORD.
           IF AP-BILL-FILE-STATUS NOT = '00' THEN
               DISPLAY "ERROR: Could not write to AP_BILL_FILE. Status: " AP-BILL-FILE-STATUS
               MOVE 'N' TO WSF-VALID-INPUT
           ELSE
               DISPLAY "Bill successfully written to AP_BILL_FILE.".
           END-IF.
           CLOSE AP-BILL-FILE.

           *> Simulate updating a vendor master file (e.g., last invoice date, aggregated spend)
           DISPLAY "Simulating update to VENDOR_MASTER for " WVB-VENDOR-ID.
           DISPLAY "Bill successfully recorded with initial status: " WVB-STATUS.
           EXIT.

       CONFIRM-ENTRY SECTION.
           DISPLAY " ".
           DISPLAY "Vendor Bill Entry Process Complete.".
           DISPLAY "Invoice Number: " WVB-INVOICE-NO.
           DISPLAY "Vendor ID: " WVB-VENDOR-ID.
           DISPLAY "Total Amount: " WVB-TOTAL-AMOUNT.
           DISPLAY "Current Status: " WVB-STATUS.
           DISPLAY "The system will now process this bill according to its designated status.".
           EXIT.

       TERMINATE-PROGRAM SECTION.
           DISPLAY "APVNDBL Program Concluded. Thank you.".
           EXIT.
```