```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. APVNDPY.
       AUTHOR. JAMES BURVEL OCALLAGHAN III.
      ******************************************************************
      * VENDOR PAYMENT AUTOMATION MODULE
      * This program processes vendor bills, leveraging an integrated AI
      * co-processor to optimize payment timing for cash flow, early
      * payment discounts, and urgency, ensuring efficient financial
      * operations.
      ******************************************************************

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT VENDOR-BILL-FILE ASSIGN TO 'VNDRBILL.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-VENDOR-BILL-FILE-STATUS.

           SELECT PAYMENT-LOG-FILE ASSIGN TO 'PAYLOG.DAT'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-PAYMENT-LOG-FILE-STATUS.

           SELECT AUDIT-REPORT-FILE ASSIGN TO 'AUDITRPT.LST'
               ORGANIZATION IS LINE SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-AUDIT-REPORT-FILE-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD  VENDOR-BILL-FILE
           RECORD CONTAINS 100 CHARACTERS.
       01  VENDOR-BILL-RECORD.
           05  VBR-VENDOR-ID       PIC X(10).
           05  VBR-INVOICE-NO      PIC X(15).
           05  VBR-INVOICE-DATE    PIC 9(08).
           05  VBR-DUE-DATE        PIC 9(08).
           05  VBR-AMOUNT          PIC S9(10)V99.
           05  VBR-DISCOUNT-TERMS  PIC X(20). (* E.g., '2%10NET30' or 'NONE' *)
           05  VBR-STATUS          PIC X(10). (* PENDING, PAID, SCHEDULED, REJECTED *)
           05  VBR-FILLER          PIC X(20).

       FD  PAYMENT-LOG-FILE
           RECORD CONTAINS 100 CHARACTERS.
       01  PAYMENT-LOG-RECORD.
           05  PLR-VENDOR-ID       PIC X(10).
           05  PLR-INVOICE-NO      PIC X(15).
           05  PLR-PAYMENT-DATE    PIC 9(08).
           05  PLR-AMOUNT-PAID     PIC S9(10)V99.
           05  PLR-OPTIMIZER-FLAG  PIC X(01).
               88  OPTIMIZED-PAYMENT   VALUE 'Y'.
               88  STANDARD-PAYMENT    VALUE 'N'.
           05  PLR-OPTIMIZER-PRIORITY PIC 9(01). (* 1=High, 2=Medium, 3=Low *)
           05  PLR-OPTIMIZER-REASON PIC X(05). (* E.g., DISC, CFLOW, URGNT, DEFPC *)
           05  PLR-NOTES           PIC X(30).

       FD  AUDIT-REPORT-FILE
           RECORD CONTAINS 132 CHARACTERS.
       01  AUDIT-REPORT-RECORD     PIC X(132).

       WORKING-STORAGE SECTION.
       01  WS-PROGRAM-FLAGS.
           05  WS-END-OF-FILE      PIC X(01) VALUE 'N'.
               88  END-OF-BILL-FILE    VALUE 'Y'.
           05  WS-PAYMENT-PROCESSED PIC X(01) VALUE 'N'.
           05  WS-PROCESS-ABORTED  PIC X(01) VALUE 'N'.
               88  ABORT-FLAG-ON       VALUE 'Y'.

       01  WS-FILE-STATUS-CODES.
           05  WS-VENDOR-BILL-FILE-STATUS PIC X(02).
           05  WS-PAYMENT-LOG-FILE-STATUS PIC X(02).
           05  WS-AUDIT-REPORT-FILE-STATUS PIC X(02).

       01  WS-CURRENT-DATE-DATA.
           05  WS-CURRENT-DATE         PIC 9(08) VALUE ZEROS.
           05  WS-CURRENT-YYYYMMDD.
               10  WS-CURRENT-YEAR     PIC 9(04).
               10  WS-CURRENT-MONTH    PIC 9(02).
               10  WS-CURRENT-DAY      PIC 9(02).

       01  WS-OPTIMIZATION-PARAMS.
           05  WS-OPTIMIZED-PAY-DATE   PIC 9(08) VALUE ZEROS.
           05  WS-OPTIMIZED-PRIORITY   PIC 9(01) VALUE 0.
               88  HIGH-PRIORITY       VALUE 1.
               88  MEDIUM-PRIORITY     VALUE 2.
               88  LOW-PRIORITY        VALUE 3.

       01  WS-AI-INPUT-DATA.
           05  AI-IN-VENDOR-ID       PIC X(10).
           05  AI-IN-INVOICE-NO      PIC X(15).
           05  AI-IN-DUE-DATE        PIC 9(08).
           05  AI-IN-AMOUNT          PIC S9(10)V99.
           05  AI-IN-DISCOUNT-TERMS  PIC X(20).
           05  AI-IN-CURRENT-CASH    PIC S9(15)V99 COMP-3.
           05  AI-IN-VENDOR-RATING   PIC 9(01). (* 1-5, simulated vendor credit/relationship rating *)

       01  WS-AI-OUTPUT-DATA.
           05  AI-OUT-SUGGESTED-DATE PIC 9(08).
           05  AI-OUT-PRIORITY       PIC 9(01).
           05  AI-OUT-REASON-CODE    PIC X(05). (* DISC, CFLOW, URGNT, VDRTG, DEFPC *)
           05  AI-OUT-CONFIDENCE     PIC 9(03)V99. (* AI confidence level, 0-100 *)

       01  WS-TOTALS.
           05  WS-BILLS-READ       PIC 9(05) VALUE ZEROS.
           05  WS-BILLS-PROCESSED  PIC 9(05) VALUE ZEROS.
           05  WS-BILLS-PAID       PIC 9(05) VALUE ZEROS.
           05  WS-BILLS-SCHEDULED  PIC 9(05) VALUE ZEROS.
           05  WS-TOTAL-PAID-AMOUNT PIC S9(15)V99 VALUE ZEROS.

       01  WS-REPORT-HEADERS.
           05  RH-TITLE.
               10 FILLER             PIC X(45) VALUE SPACES.
               10 FILLER             PIC X(42) VALUE "VENDOR PAYMENT OPTIMIZATION AUDIT REPORT".
               10 FILLER             PIC X(45) VALUE SPACES.
           05  RH-DATE.
               10 FILLER             PIC X(55) VALUE "Run Date: ".
               10 RH-DATE-FLD        PIC 9(08).
               10 FILLER             PIC X(69) VALUE SPACES.
           05  RH-COL-HEADERS.
               10 FILLER             PIC X(03) VALUE "VEN".
               10 FILLER             PIC X(07) VALUE " ID".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(06) VALUE "INVOIC".
               10 FILLER             PIC X(09) VALUE "E NO.".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(08) VALUE "DUE DATE".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(06) VALUE "AMOUNT".
               10 FILLER             PIC X(05) VALUE SPACES.
               10 FILLER             PIC X(08) VALUE "PAY DATE".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(08) VALUE "PRIORITY".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(07) VALUE "AI REAS".
               10 FILLER             PIC X(08) VALUE "ON CODE".
               10 FILLER             PIC X(03) VALUE SPACES.
               10 FILLER             PIC X(06) VALUE "STATUS".
               10 FILLER             PIC X(18) VALUE SPACES.

       01  WS-DETAIL-LINE.
           05  DL-VENDOR-ID        PIC X(10).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-INVOICE-NO       PIC X(15).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-DUE-DATE         PIC 9(08).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-AMOUNT           PIC Z(09).99.
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-PAY-DATE         PIC 9(08).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-PRIORITY         PIC X(08).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-AI-REASON        PIC X(05).
           05  FILLER              PIC X(03) VALUE SPACES.
           05  DL-STATUS           PIC X(10).
           05  FILLER              PIC X(20) VALUE SPACES.

       01  WS-REPORT-FOOTERS.
           05  RF-TOTAL-LINE.
               10 FILLER             PIC X(05) VALUE "TOTAL:".
               10 FILLER             PIC X(15) VALUE "Bills Read: ".
               10 RF-BILLS-READ      PIC Z(05)9.
               10 FILLER             PIC X(15) VALUE "Bills Paid: ".
               10 RF-BILLS-PAID      PIC Z(05)9.
               10 FILLER             PIC X(15) VALUE "Scheduled: ".
               10 RF-BILLS-SCHEDULED PIC Z(05)9.
               10 FILLER             PIC X(15) VALUE "Amount Paid: ".
               10 RF-AMOUNT-PAID     PIC $Z,ZZZ,ZZZ,ZZ9.99.
               10 FILLER             PIC X(05) VALUE SPACES.

       PROCEDURE DIVISION.
       MAIN-LOGIC SECTION.
           PERFORM 1000-INITIALIZE-PROGRAM.
           PERFORM 2000-OPEN-FILES.
           IF NOT ABORT-FLAG-ON
               PERFORM 3000-READ-VENDOR-BILL
               PERFORM 4000-PROCESS-BILLS-LOOP UNTIL END-OF-BILL-FILE
           END-IF.
           PERFORM 5000-FINALIZE-PROGRAM.
           PERFORM 6000-CLOSE-FILES.
           STOP RUN.

       1000-INITIALIZE-PROGRAM SECTION.
           DISPLAY "APVNDPY - Vendor Payment Automation Module Starting...".
           MOVE FUNCTION CURRENT-DATE (1:8) TO WS-CURRENT-DATE.
           MOVE WS-CURRENT-DATE TO WS-CURRENT-YYYYMMDD.
           DISPLAY "Current System Date: " WS-CURRENT-DATE.

           (* Simulate initial cash position for AI consideration *)
           MOVE 50000000.00 TO AI-IN-CURRENT-CASH.
           DISPLAY "Initial Cash Flow Snapshot for AI: " AI-IN-CURRENT-CASH.
           DISPLAY "AI systems calibrating for optimal payment strategy...".
           INITIALIZE WS-AI-OUTPUT-DATA.
           INITIALIZE WS-TOTALS.
           INITIALIZE WS-PROGRAM-FLAGS.
           MOVE 'N' TO WS-PROCESS-ABORTED.
           MOVE WS-CURRENT-DATE TO RH-DATE-FLD.

       1000-INITIALIZE-PROGRAM-EXIT.
           EXIT.

       2000-OPEN-FILES SECTION.
           OPEN INPUT VENDOR-BILL-FILE.
           IF WS-VENDOR-BILL-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not open VENDOR-BILL-FILE. Status: "
                       WS-VENDOR-BILL-FILE-STATUS
               SET ABORT-FLAG-ON TO TRUE
               PERFORM 9000-ABORT-PROGRAM
           END-IF.

           OPEN OUTPUT PAYMENT-LOG-FILE.
           IF WS-PAYMENT-LOG-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not open PAYMENT-LOG-FILE. Status: "
                       WS-PAYMENT-LOG-FILE-STATUS
               SET ABORT-FLAG-ON TO TRUE
               PERFORM 9000-ABORT-PROGRAM
           END-IF.

           OPEN OUTPUT AUDIT-REPORT-FILE.
           IF WS-AUDIT-REPORT-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not open AUDIT-REPORT-FILE. Status: "
                       WS-AUDIT-REPORT-FILE-STATUS
               SET ABORT-FLAG-ON TO TRUE
               PERFORM 9000-ABORT-PROGRAM
           END-IF.

           IF NOT ABORT-FLAG-ON
               DISPLAY "All required files opened successfully.".
               PERFORM 2100-WRITE-REPORT-HEADERS.
           END-IF.

       2000-OPEN-FILES-EXIT.
           EXIT.

       2100-WRITE-REPORT-HEADERS SECTION.
           MOVE RH-TITLE TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE SPACES TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE RH-DATE TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE SPACES TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE RH-COL-HEADERS TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE SPACES TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.

       2100-WRITE-REPORT-HEADERS-EXIT.
           EXIT.

       3000-READ-VENDOR-BILL SECTION.
           READ VENDOR-BILL-FILE
               AT END
                   SET END-OF-BILL-FILE TO TRUE
                   DISPLAY "INFO: End of Vendor Bill File reached."
               NOT AT END
                   ADD 1 TO WS-BILLS-READ
                   DISPLAY "INFO: Reading Bill " VBR-INVOICE-NO
                           " for Vendor " VBR-VENDOR-ID
           END-READ.

       3000-READ-VENDOR-BILL-EXIT.
           EXIT.

       4000-PROCESS-BILLS-LOOP SECTION.
           PERFORM 4100-PROCESS-SINGLE-BILL.
           PERFORM 3000-READ-VENDOR-BILL.

       4000-PROCESS-BILLS-LOOP-EXIT.
           EXIT.

       4100-PROCESS-SINGLE-BILL SECTION.
           DISPLAY "--------------------------------------------------".
           ADD 1 TO WS-BILLS-PROCESSED.
           DISPLAY "ACTION: Processing Bill: " VBR-INVOICE-NO
                   " (Vendor: " VBR-VENDOR-ID ") Amount: " VBR-AMOUNT.

           IF VBR-STATUS = "PENDING"
               PERFORM 4200-PREPARE-AI-INPUT
               PERFORM 4300-CALL-AI-OPTIMIZER
               PERFORM 4400-EVALUATE-AI-RECOMMENDATION
               PERFORM 4500-ISSUE-PAYMENT-OR-SCHEDULE
               PERFORM 4600-LOG-PAYMENT-ACTIVITY
           ELSE
               DISPLAY "INFO: Bill " VBR-INVOICE-NO " not PENDING. Status: "
                       VBR-STATUS ". Skipping optimization."
               MOVE "SKIPPED" TO PLR-NOTES
               MOVE VBR-INVOICE-NO TO PLR-INVOICE-NO
               MOVE VBR-VENDOR-ID TO PLR-VENDOR-ID
               MOVE WS-CURRENT-DATE TO PLR-PAYMENT-DATE
               MOVE VBR-AMOUNT TO PLR-AMOUNT-PAID
               MOVE 'S' TO PLR-OPTIMIZER-FLAG (* 'S' for skipped *)
               MOVE 0 TO PLR-OPTIMIZER-PRIORITY
               MOVE 'SKIP' TO PLR-OPTIMIZER-REASON
               PERFORM 4600-LOG-PAYMENT-ACTIVITY
           END-IF.
           PERFORM 4700-WRITE-AUDIT-DETAIL.
           DISPLAY "--------------------------------------------------".

       4100-PROCESS-SINGLE-BILL-EXIT.
           EXIT.

       4200-PREPARE-AI-INPUT SECTION.
           MOVE VBR-VENDOR-ID TO AI-IN-VENDOR-ID.
           MOVE VBR-INVOICE-NO TO AI-IN-INVOICE-NO.
           MOVE VBR-DUE-DATE TO AI-IN-DUE-DATE.
           MOVE VBR-AMOUNT TO AI-IN-AMOUNT.
           MOVE VBR-DISCOUNT-TERMS TO AI-IN-DISCOUNT-TERMS.
           (* For demo, Vendor Rating is simulated, in reality it'd come from a CRM/Vendor Master *)
           IF VBR-VENDOR-ID = "PREFERREDV"
               MOVE 5 TO AI-IN-VENDOR-RATING
           ELSE IF VBR-VENDOR-ID = "CRITICALVT"
               MOVE 4 TO AI-IN-VENDOR-RATING
           ELSE
               MOVE 3 TO AI-IN-VENDOR-RATING
           END-IF.

           DISPLAY "INFO: AI Input Prepared for Bill " AI-IN-INVOICE-NO
                   " (Current Cash: " AI-IN-CURRENT-CASH ")".

       4200-PREPARE-AI-INPUT-EXIT.
           EXIT.

       4300-CALL-AI-OPTIMIZER SECTION.
           DISPLAY "AI CO-PROCESSOR: Initiating optimal payment timing analysis...".
           (* This simulates a complex AI model's decision-making process *)
           (* In a real mainframe, this might be a 'CALL' to an external AI service
           (* or a deep integration with a specialized analytics module. *)

           (* Default AI outputs *)
           MOVE WS-CURRENT-DATE TO AI-OUT-SUGGESTED-DATE.
           MOVE 2 TO AI-OUT-PRIORITY. (* Medium priority default *)
           MOVE 'DEFPC' TO AI-OUT-REASON-CODE. (* Default Payment Consideration *)
           MOVE 70.00 TO AI-OUT-CONFIDENCE.

           (* AI Logic Simulation: Prioritize based on several factors *)
           (* 1. Early Payment Discounts *)
           IF VBR-DISCOUNT-TERMS NOT = SPACES AND VBR-DISCOUNT-TERMS NOT = 'NONE'
               (* Assuming a simple 10-day discount window from invoice date *)
               COMPUTE WS-TEMP-DATE = VBR-INVOICE-DATE + 10
               IF WS-TEMP-DATE >= WS-CURRENT-DATE AND AI-IN-CURRENT-CASH >= VBR-AMOUNT
                   MOVE WS-TEMP-DATE TO AI-OUT-SUGGESTED-DATE
                   MOVE 1 TO AI-OUT-PRIORITY (* High Priority *)
                   MOVE 'DISC' TO AI-OUT-REASON-CODE
                   MOVE 98.00 TO AI-OUT-CONFIDENCE
                   DISPLAY "AI: Recommended for Early Payment Discount."
               END-IF
           END-IF.

           (* 2. Urgency due to Due Date *)
           COMPUTE WS-DAYS-TO-DUE = VBR-DUE-DATE - WS-CURRENT-DATE.
           IF WS-DAYS-TO-DUE <= 7 AND WS-DAYS-TO-DUE >= 0 (* Due within a week *)
               MOVE VBR-DUE-DATE TO AI-OUT-SUGGESTED-DATE
               IF AI-OUT-PRIORITY > 1 (* Only elevate if not already high for discount *)
                   MOVE 1 TO AI-OUT-PRIORITY
                   MOVE 'URGNT' TO AI-OUT-REASON-CODE
                   MOVE 92.00 TO AI-OUT-CONFIDENCE
                   DISPLAY "AI: Recommended for Urgency (Due soon)."
               END-IF
           END-IF.

           (* 3. Cash Flow Availability - If ample cash, accelerate payment for good vendor rating *)
           IF AI-IN-CURRENT-CASH >= (VBR-AMOUNT * 2) AND AI-IN-VENDOR-RATING >= 4
               AND AI-OUT-PRIORITY > 1 (* Only if not already high priority *)
               MOVE WS-CURRENT-DATE TO AI-OUT-SUGGESTED-DATE
               MOVE 1 TO AI-OUT-PRIORITY
               MOVE 'CFLOW' TO AI-OUT-REASON-CODE
               MOVE 90.00 TO AI-OUT-CONFIDENCE
               DISPLAY "AI: Recommended for ample cash & preferred vendor."
           END-IF.

           (* 4. Standard Payment Scheduling - Pay a week before due if not high priority *)
           IF AI-OUT-PRIORITY = 2 OR AI-OUT-PRIORITY = 3
               COMPUTE WS-TEMP-DATE = VBR-DUE-DATE - 7
               IF WS-TEMP-DATE < WS-CURRENT-DATE
                   MOVE WS-CURRENT-DATE TO AI-OUT-SUGGESTED-DATE
               ELSE
                   MOVE WS-TEMP-DATE TO AI-OUT-SUGGESTED-DATE
               END-IF
               MOVE 2 TO AI-OUT-PRIORITY (* Medium priority *)
               MOVE 'DEFPC' TO AI-OUT-REASON-CODE
               MOVE 75.00 TO AI-OUT-CONFIDENCE
               DISPLAY "AI: Recommended for standard payment scheduling."
           END-IF.

           DISPLAY "AI Co-processor Output -> Suggested Payment Date: " AI-OUT-SUGGESTED-DATE
                   ", Priority: " AI-OUT-PRIORITY
                   ", Reason: " AI-OUT-REASON-CODE
                   ", Confidence: " AI-OUT-CONFIDENCE.

           MOVE AI-OUT-SUGGESTED-DATE TO WS-OPTIMIZED-PAY-DATE.
           MOVE AI-OUT-PRIORITY TO WS-OPTIMIZED-PRIORITY.

       4300-CALL-AI-OPTIMIZER-EXIT.
           EXIT.

       4400-EVALUATE-AI-RECOMMENDATION SECTION.
           DISPLAY "SYSTEM: Evaluating AI recommendation for Bill " VBR-INVOICE-NO "...".
           (* This step allows for human oversight or a system-defined policy engine
           (* to accept, reject, or modify the AI's recommendation.
           (* For this simulation, we'll auto-accept if AI confidence is high,
           (* otherwise, it defaults to a standard approach. *)

           IF AI-OUT-CONFIDENCE >= 85.00
               DISPLAY "SYSTEM: AI recommendation accepted due to high confidence (" AI-OUT-CONFIDENCE "%)".
               SET OPTIMIZED-PAYMENT TO TRUE OF PAYMENT-LOG-RECORD
           ELSE
               DISPLAY "SYSTEM: AI confidence low (" AI-OUT-CONFIDENCE
                       "%), falling back to standard policy (pay 3 days before due date)."
               COMPUTE WS-OPTIMIZED-PAY-DATE = VBR-DUE-DATE - 3
               IF WS-OPTIMIZED-PAY-DATE < WS-CURRENT-DATE
                   MOVE WS-CURRENT-DATE TO WS-OPTIMIZED-PAY-DATE
               END-IF.
               MOVE 2 TO WS-OPTIMIZED-PRIORITY (* Default to medium *)
               MOVE 'FALLB' TO AI-OUT-REASON-CODE
               SET STANDARD-PAYMENT TO TRUE OF PAYMENT-LOG-RECORD
           END-IF.

           MOVE WS-OPTIMIZED-PRIORITY TO PLR-OPTIMIZER-PRIORITY.
           MOVE AI-OUT-REASON-CODE TO PLR-OPTIMIZER-REASON.

       4400-EVALUATE-AI-RECOMMENDATION-EXIT.
           EXIT.

       4500-ISSUE-PAYMENT-OR-SCHEDULE SECTION.
           IF WS-OPTIMIZED-PAY-DATE <= WS-CURRENT-DATE AND HIGH-PRIORITY
               DISPLAY "ACTION: Issuing immediate payment for Bill " VBR-INVOICE-NO
                       " on " WS-CURRENT-DATE " (Priority: HIGH, Reason: " AI-OUT-REASON-CODE ")".
               PERFORM 4510-PROCESS-PAYMENT
               MOVE "PAID" TO VBR-STATUS
               ADD VBR-AMOUNT TO WS-TOTAL-PAID-AMOUNT
               ADD 1 TO WS-BILLS-PAID
               MOVE "Payment Issued (AI)" TO PLR-NOTES
           ELSE IF WS-OPTIMIZED-PAY-DATE <= WS-CURRENT-DATE
               DISPLAY "ACTION: Issuing today's payment for Bill " VBR-INVOICE-NO
                       " on " WS-CURRENT-DATE " (Priority: " WS-OPTIMIZED-PRIORITY
                       ", Reason: " AI-OUT-REASON-CODE ")".
               PERFORM 4510-PROCESS-PAYMENT
               MOVE "PAID" TO VBR-STATUS
               ADD VBR-AMOUNT TO WS-TOTAL-PAID-AMOUNT
               ADD 1 TO WS-BILLS-PAID
               MOVE "Payment Issued (AI)" TO PLR-NOTES
           ELSE
               DISPLAY "ACTION: Scheduling future payment for Bill " VBR-INVOICE-NO
                       " on " WS-OPTIMIZED-PAY-DATE " (Priority: " WS-OPTIMIZED-PRIORITY
                       ", Reason: " AI-OUT-REASON-CODE ")".
               MOVE "SCHEDULED" TO VBR-STATUS
               ADD 1 TO WS-BILLS-SCHEDULED
               MOVE "Payment Scheduled (AI)" TO PLR-NOTES
           END-IF.

       4500-ISSUE-PAYMENT-OR-SCHEDULE-EXIT.
           EXIT.

       4510-PROCESS-PAYMENT SECTION.
           (* This paragraph would contain actual interfaces to financial systems,
           (* like an Electronic Funds Transfer (EFT) module or a Treasury system.
           (* For this simulation, we indicate the transaction. *)
           DISPLAY "FINANCE: Initiating payment transaction for " VBR-AMOUNT
                   " to Vendor " VBR-VENDOR-ID " for Invoice " VBR-INVOICE-NO.
           (* Simulate cash flow reduction based on actual payment *)
           SUBTRACT VBR-AMOUNT FROM AI-IN-CURRENT-CASH.
           DISPLAY "FINANCE: Updated Cash Flow Snapshot: " AI-IN-CURRENT-CASH.
           SET WS-PAYMENT-PROCESSED TO TRUE.

       4510-PROCESS-PAYMENT-EXIT.
           EXIT.

       4600-LOG-PAYMENT-ACTIVITY SECTION.
           MOVE VBR-VENDOR-ID TO PLR-VENDOR-ID.
           MOVE VBR-INVOICE-NO TO PLR-INVOICE-NO.
           MOVE WS-OPTIMIZED-PAY-DATE TO PLR-PAYMENT-DATE.
           MOVE VBR-AMOUNT TO PLR-AMOUNT-PAID.
           (* PLR-OPTIMIZER-FLAG, PLR-OPTIMIZER-PRIORITY, PLR-OPTIMIZER-REASON
           (* are set in 4400-EVALUATE-AI-RECOMMENDATION *)

           WRITE PAYMENT-LOG-RECORD.
           IF WS-PAYMENT-LOG-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not write to PAYMENT-LOG-FILE. Status: "
                       WS-PAYMENT-LOG-FILE-STATUS
           ELSE
               DISPLAY "INFO: Payment activity logged for " VBR-INVOICE-NO " Status: " VBR-STATUS.
           END-IF.

       4600-LOG-PAYMENT-ACTIVITY-EXIT.
           EXIT.

       4700-WRITE-AUDIT-DETAIL SECTION.
           MOVE VBR-VENDOR-ID TO DL-VENDOR-ID.
           MOVE VBR-INVOICE-NO TO DL-INVOICE-NO.
           MOVE VBR-DUE-DATE TO DL-DUE-DATE.
           MOVE VBR-AMOUNT TO DL-AMOUNT.
           MOVE WS-OPTIMIZED-PAY-DATE TO DL-PAY-DATE.
           IF HIGH-PRIORITY OF WS-OPTIMIZATION-PARAMS
               MOVE "HIGH" TO DL-PRIORITY
           ELSE IF MEDIUM-PRIORITY OF WS-OPTIMIZATION-PARAMS
               MOVE "MEDIUM" TO DL-PRIORITY
           ELSE IF LOW-PRIORITY OF WS-OPTIMIZATION-PARAMS
               MOVE "LOW" TO DL-PRIORITY
           ELSE
               MOVE "N/A" TO DL-PRIORITY (* For skipped bills *)
           END-IF.
           MOVE PLR-OPTIMIZER-REASON TO DL-AI-REASON.
           MOVE VBR-STATUS TO DL-STATUS.
           MOVE WS-DETAIL-LINE TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           IF WS-AUDIT-REPORT-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not write audit detail. Status: "
                       WS-AUDIT-REPORT-FILE-STATUS
           END-IF.

       4700-WRITE-AUDIT-DETAIL-EXIT.
           EXIT.

       5000-FINALIZE-PROGRAM SECTION.
           DISPLAY "APVNDPY - Vendor Payment Automation Module Completed.".
           MOVE SPACES TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           MOVE WS-BILLS-READ TO RF-BILLS-READ.
           MOVE WS-BILLS-PAID TO RF-BILLS-PAID.
           MOVE WS-BILLS-SCHEDULED TO RF-BILLS-SCHEDULED.
           MOVE WS-TOTAL-PAID-AMOUNT TO RF-AMOUNT-PAID.
           MOVE RF-TOTAL-LINE TO AUDIT-REPORT-RECORD.
           WRITE AUDIT-REPORT-RECORD.
           DISPLAY "Summary Report:".
           DISPLAY "Total Bills Read: " WS-BILLS-READ.
           DISPLAY "Total Bills Paid Immediately: " WS-BILLS-PAID.
           DISPLAY "Total Bills Scheduled for Future: " WS-BILLS-SCHEDULED.
           DISPLAY "Total Amount Paid (Immediate): " WS-TOTAL-PAID-AMOUNT.
           DISPLAY "Final Cash Flow Snapshot: " AI-IN-CURRENT-CASH.

       5000-FINALIZE-PROGRAM-EXIT.
           EXIT.

       6000-CLOSE-FILES SECTION.
           CLOSE VENDOR-BILL-FILE.
           IF WS-VENDOR-BILL-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not close VENDOR-BILL-FILE. Status: "
                       WS-VENDOR-BILL-FILE-STATUS
           END-IF.
           CLOSE PAYMENT-LOG-FILE.
           IF WS-PAYMENT-LOG-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not close PAYMENT-LOG-FILE. Status: "
                       WS-PAYMENT-LOG-FILE-STATUS
           END-IF.
           CLOSE AUDIT-REPORT-FILE.
           IF WS-AUDIT-REPORT-FILE-STATUS NOT = "00"
               DISPLAY "ERROR: Could not close AUDIT-REPORT-FILE. Status: "
                       WS-AUDIT-REPORT-FILE-STATUS
           END-IF.
           DISPLAY "All files closed successfully.".

       6000-CLOSE-FILES-EXIT.
           EXIT.

       9000-ABORT-PROGRAM SECTION.
           DISPLAY "CRITICAL: Program aborted due to unrecoverable error.".
           PERFORM 6000-CLOSE-FILES.
           STOP RUN.

       9000-ABORT-PROGRAM-EXIT.
           EXIT.
```