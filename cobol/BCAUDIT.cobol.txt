```cobol
               IDENTIFICATION DIVISION.
       PROGRAM-ID. BCAUDIT.
       AUTHOR. AI-ASSISTED-FINANCE.
      ******************************************************************
      * MAINFRAME AI FINANCIAL SYSTEM - BLOCKCHAIN AUDIT TRAIL
      * This program facilitates an audit of financial transactions
      * recorded on a simulated blockchain ledger. It leverages AI
      * capabilities to enhance integrity verification and anomaly
      * detection, providing a comprehensive audit report.
      * The AI acts as an assistant, offering insights and flagging
      * potential issues for human review, ensuring the highest level
      * of financial integrity and compliance.
      *
      * SYSTEM PROMPT: see prompts/idgafai_full.txt
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. MAINFRAME-SERVER.
       OBJECT-COMPUTER. MAINFRAME-SERVER.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
      *----------------------------------------------------------------*
      * Input/Output Variables                                         *
      *----------------------------------------------------------------*
       01 WS-INPUT-ID              PIC X(20).
       01 WS-TRANSACTION-ID-KEY    PIC X(20).
       01 WS-AUDIT-STATUS          PIC X(30) VALUE SPACES.
       01 WS-ANOMALY-FLAG          PIC X(03) VALUE 'NO'.
          88 ANOMALY-DETECTED      VALUE 'YES'.
          88 NO-ANOMALY-DETECTED   VALUE 'NO'.

      *----------------------------------------------------------------*
      * Simulated Blockchain Transaction Data                          *
      * This would typically come from an external data source or DB   *
      * representing the distributed ledger. For this simulation,      *
      * data is hardcoded for illustrative purposes.                   *
      *----------------------------------------------------------------*
       01 WS-TRANSACTION-RECORD.
          05 WS-TR-ID              PIC X(20).
          05 WS-TR-TYPE            PIC X(10).
          05 WS-TR-DATE            PIC 9(08).
          05 WS-TR-AMOUNT          PIC 9(12)V99.
          05 WS-TR-SENDER          PIC X(30).
          05 WS-TR-RECEIVER        PIC X(30).
          05 WS-TR-HASH            PIC X(64).
          05 WS-TR-PREV-HASH       PIC X(64).
          05 WS-TR-TIMESTAMP       PIC 9(14).

      *----------------------------------------------------------------*
      * AI Analysis Results                                            *
      * These variables store the insights and scores generated by     *
      * the AI component, reflecting its evaluation of the transaction.
      *----------------------------------------------------------------*
       01 WS-AI-ANALYSIS-DATA.
          05 WS-AI-CONFIDENCE-SCORE PIC 9(03) VALUE ZEROS.
             88 AI-HIGH-CONFIDENCE  VALUE 90 THRU 99.
             88 AI-MEDIUM-CONFIDENCE VALUE 70 THRU 89.
             88 AI-LOW-CONFIDENCE   VALUE 00 THRU 69.
          05 WS-AI-ANOMALY-SCORE    PIC 9(03) VALUE ZEROS.
             88 AI-CRITICAL-ANOMALY VALUE 80 THRU 99.
             88 AI-MINOR-ANOMALY    VALUE 50 THRU 79.
             88 AI-NO-ANOMALY-SCORE VALUE 00 THRU 49.
          05 WS-AI-INSIGHTS         PIC X(100) VALUE SPACES.

      *----------------------------------------------------------------*
      * System Date/Time for Logging and Reporting                     *
      *----------------------------------------------------------------*
       01 WS-CURRENT-DATETIME.
          05 WS-CURRENT-DATE.
             10 WS-CURRENT-YEAR    PIC 9(04).
             10 WS-CURRENT-MONTH   PIC 9(02).
             10 WS-CURRENT-DAY     PIC 9(02).
          05 WS-CURRENT-TIME.
             10 WS-CURRENT-HOUR    PIC 9(02).
             10 WS-CURRENT-MINUTE  PIC 9(02).
             10 WS-CURRENT-SECOND  PIC 9(02).
             10 WS-CURRENT-MS      PIC 9(02).

      *----------------------------------------------------------------*
      * Constants/Messages for User Interaction and Reporting          *
      *----------------------------------------------------------------*
       01 WS-MESSAGES.
          05 MSG-PROMPT-ID         PIC X(80) VALUE
             "ENTER INVOICE/PAYMENT ID FOR BLOCKCHAIN AUDIT: ".
          05 MSG-RETRIEVING        PIC X(80) VALUE
             "AI ASSISTANT: RETRIEVING ON-CHAIN TRANSACTION HISTORY...".
          05 MSG-VERIFYING         PIC X(80) VALUE
             "AI ASSISTANT: VERIFYING HASH INTEGRITY...".
          05 MSG-AI-ANALYZING      PIC X(80) VALUE
             "AI ASSISTANT: PERFORMING ADVANCED TRANSACTION ANALYSIS...".
          05 MSG-AUDIT-COMPLETE    PIC X(80) VALUE
             "AI ASSISTANT: AUDIT TRAIL VERIFIED AND REPORT GENERATED.".
          05 MSG-ID-NOT-FOUND      PIC X(80) VALUE
             "AI ASSISTANT: TRANSACTION ID NOT FOUND IN LEDGER.".
          05 MSG-HASH-MISMATCH     PIC X(80) VALUE
             "AI ASSISTANT: CRITICAL - HASH INTEGRITY MISMATCH DETECTED!".
          05 MSG-HASH-OK           PIC X(80) VALUE
             "AI ASSISTANT: HASH INTEGRITY VERIFIED (100% OK).".
          05 MSG-ANOMALY-REPORT    PIC X(80) VALUE
             "AI ASSISTANT: POTENTIAL ANOMALY DETECTED!".
          05 MSG-NO-ANOMALY-REPORT PIC X(80) VALUE
             "AI ASSISTANT: NO SIGNIFICANT ANOMALIES DETECTED.".


       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM INITIALIZE-PROGRAM.
           PERFORM ACCEPT-TRANSACTION-ID.
           PERFORM RETRIEVE-BLOCKCHAIN-DATA.
           IF WS-TR-ID IS NOT EQUAL TO SPACES
               PERFORM PERFORM-HASH-VERIFICATION
               PERFORM AI-ANALYZE-TRAIL
               PERFORM GENERATE-AUDIT-REPORT
           ELSE
               DISPLAY MSG-ID-NOT-FOUND
           END-IF.
           PERFORM LOG-AUDIT-EVENT.
           PERFORM TERMINATE-PROGRAM.

       INITIALIZE-PROGRAM.
           DISPLAY "=".
           DISPLAY "AI-DRIVEN BLOCKCHAIN AUDIT SYSTEM".
           DISPLAY "=".
           MOVE SPACES TO WS-INPUT-ID.
           MOVE SPACES TO WS-TRANSACTION-RECORD.
           MOVE SPACES TO WS-AUDIT-STATUS.
           MOVE 'NO' TO WS-ANOMALY-FLAG.
           MOVE ZEROS TO WS-AI-CONFIDENCE-SCORE.
           MOVE ZEROS TO WS-AI-ANOMALY-SCORE.
           MOVE SPACES TO WS-AI-INSIGHTS.
           ACCEPT WS-CURRENT-DATETIME FROM DATE YYYYMMDD.
           ACCEPT WS-CURRENT-TIME FROM TIME.
           DISPLAY "AI ASSISTANT: System initialized.".

       ACCEPT-TRANSACTION-ID.
           DISPLAY MSG-PROMPT-ID WITH NO ADVANCING.
           ACCEPT WS-INPUT-ID.
           MOVE WS-INPUT-ID TO WS-TRANSACTION-ID-KEY.
           DISPLAY "AI ASSISTANT: User requested audit for ID: "
               WS-TRANSACTION-ID-KEY.

       RETRIEVE-BLOCKCHAIN-DATA.
           DISPLAY MSG-RETRIEVING.
           * In a real system, this would involve a secure call to a
           * blockchain API or a distributed ledger database to fetch
           * the transaction details associated with WS-TRANSACTION-ID-KEY.
           * For this simulation, we'll hardcode a few scenarios to
           * demonstrate different audit outcomes, including an anomaly.
           IF WS-TRANSACTION-ID-KEY = "INV00123" THEN
               MOVE "INV00123" TO WS-TR-ID
               MOVE "INVOICE" TO WS-TR-TYPE
               MOVE 20241026 TO WS-TR-DATE
               MOVE 1500.75 TO WS-TR-AMOUNT
               MOVE "SUPPLIER-X" TO WS-TR-SENDER
               MOVE "CLIENT-Y" TO WS-TR-RECEIVER
               MOVE "ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345" TO WS-TR-HASH
               MOVE "PREVHASH00000000000000000000000000000000000000000000000000000000000000" TO WS-TR-PREV-HASH
               MOVE 20241026103000 TO WS-TR-TIMESTAMP
           ELSE IF WS-TRANSACTION-ID-KEY = "PAY98765" THEN
               MOVE "PAY98765" TO WS-TR-ID
               MOVE "PAYMENT" TO WS-TR-TYPE
               MOVE 20241027 TO WS-TR-DATE
               MOVE 1500.75 TO WS-TR-AMOUNT
               MOVE "CLIENT-Y" TO WS-TR-SENDER
               MOVE "SUPPLIER-X" TO WS-TR-RECEIVER
               MOVE "FGHIJ67890FGHIJ67890FGHIJ67890FGHIJ67890FGHIJ67890FGHIJ67890FGHIJ67890" TO WS-TR-HASH
               MOVE "ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345ABCDE12345" TO WS-TR-PREV-HASH
               MOVE 20241027144500 TO WS-TR-TIMESTAMP
           ELSE IF WS-TRANSACTION-ID-KEY = "ANOMALY001" THEN
               * Simulate a transaction with a hash mismatch and unusual characteristics
               MOVE "ANOMALY001" TO WS-TR-ID
               MOVE "TRANSFER" TO WS-TR-TYPE
               MOVE 20241028 TO WS-TR-DATE
               MOVE 50000.00 TO WS-TR-AMOUNT
               MOVE "HIGH-RISK-ENTITY" TO WS-TR-SENDER
               MOVE "UNKNOWN-ACCOUNT" TO WS-TR-RECEIVER
               MOVE "BADHASH12345BADHASH12345BADHASH12345BADHASH12345BADHASH12345BADHASH12345" TO WS-TR-HASH
               MOVE "GOODHASH00000000000000000000000000000000000000000000000000000000000000" TO WS-TR-PREV-HASH
               MOVE 20241028091500 TO WS-TR-TIMESTAMP
           ELSE
               MOVE SPACES TO WS-TR-ID
           END-IF.
           IF WS-TR-ID IS NOT EQUAL TO SPACES
               DISPLAY "AI ASSISTANT: Transaction " WS-TR-ID " retrieved successfully."
           END-IF.

       PERFORM-HASH-VERIFICATION.
           DISPLAY MSG-VERIFYING.
           * In a production blockchain system, this step would involve
           * cryptographically re-hashing the transaction data and comparing
           * the generated hash with the `WS-TR-HASH` stored on the ledger.
           * Any discrepancy indicates data tampering or corruption.
           * For this simulation, we'll use a simplified check.
           IF WS-TRANSACTION-ID-KEY = "ANOMALY001" THEN
               DISPLAY MSG-HASH-MISMATCH
               MOVE "HASH MISMATCH" TO WS-AUDIT-STATUS
           ELSE
               DISPLAY MSG-HASH-OK
               MOVE "HASH VERIFIED" TO WS-AUDIT-STATUS
           END-IF.

       AI-ANALYZE-TRAIL.
           DISPLAY MSG-AI-ANALYZING.
           * This crucial section simulates the AI's advanced analytical capabilities.
           * The AI reviews the transaction against various models and historical data.
           * Potential AI functions include:
           * - **Pattern Recognition**: Identifying unusual transaction amounts, frequencies,
           *   or counterparties for a given entity.
           * - **Risk Scoring**: Assessing the sender/receiver entities against known risk
           *   profiles or watchlists.
           * - **Contextual Analysis**: Checking transaction timing, location (if available),
           *   and links to other related transactions for inconsistencies.
           * - **Predictive Analytics**: Forecasting potential future risks based on current patterns.

           * Simulate AI confidence and anomaly scores based on transaction type/amount
           IF WS-TR-ID = "INV00123" THEN
               MOVE 95 TO WS-AI-CONFIDENCE-SCORE
               MOVE 10 TO WS-AI-ANOMALY-SCORE
               MOVE "AI: Invoice transaction aligns with historical patterns. Low risk." TO WS-AI-INSIGHTS
           ELSE IF WS-TR-ID = "PAY98765" THEN
               MOVE 98 TO WS-AI-CONFIDENCE-SCORE
               MOVE 05 TO WS-AI-ANOMALY-SCORE
               MOVE "AI: Payment transaction shows high integrity and expected flow. Very low risk." TO WS-AI-INSIGHTS
           ELSE IF WS-TR-ID = "ANOMALY001" THEN
               SET ANOMALY-DETECTED TO TRUE
               MOVE 60 TO WS-AI-CONFIDENCE-SCORE
               MOVE 85 TO WS-AI-ANOMALY-SCORE
               MOVE "AI: Detected high anomaly score due to sender/receiver and amount. Flagged for human review." TO WS-AI-INSIGHTS
           ELSE
               * Default analysis for unknown or less specific cases
               MOVE 80 TO WS-AI-CONFIDENCE-SCORE
               MOVE 30 TO WS-AI-ANOMALY-SCORE
               MOVE "AI: Transaction analyzed, no immediate high-risk patterns identified based on current models." TO WS-AI-INSIGHTS
           END-IF.

           IF ANOMALY-DETECTED THEN
               DISPLAY MSG-ANOMALY-REPORT
               DISPLAY "AI ASSISTANT: Recommended action: Escalate to compliance officer for manual review."
           ELSE
               DISPLAY MSG-NO-ANOMALY-REPORT
           END-IF.

       GENERATE-AUDIT-REPORT.
           DISPLAY "=".
           DISPLAY "AI-ASSISTED BLOCKCHAIN AUDIT REPORT".
           DISPLAY "AUDIT DATE : " WS-CURRENT-DATE(1:4) "/" WS-CURRENT-DATE(5:2) "/" WS-CURRENT-DATE(7:2).
           DISPLAY "AUDIT TIME : " WS-CURRENT-TIME(1:2) ":" WS-CURRENT-TIME(3:2) ":" WS-CURRENT-TIME(5:2).
           DISPLAY "--------------------------------------------------".
           DISPLAY "TRANSACTION ID   : " WS-TR-ID.
           DISPLAY "TRANSACTION TYPE : " WS-TR-TYPE.
           DISPLAY "TRANSACTION DATE : " WS-TR-DATE.
           DISPLAY "TRANSACTION AMOUNT: " WS-TR-AMOUNT.
           DISPLAY "SENDER           : " WS-TR-SENDER.
           DISPLAY "RECEIVER         : " WS-TR-RECEIVER.
           DISPLAY "RECORDED HASH    : " WS-TR-HASH.
           DISPLAY "PREVIOUS HASH    : " WS-TR-PREV-HASH.
           DISPLAY "TIMESTAMP (UTC)  : " WS-TR-TIMESTAMP.
           DISPLAY "--------------------------------------------------".
           DISPLAY "AUDIT STATUS     : " WS-AUDIT-STATUS.
           DISPLAY "AI CONFIDENCE    : " WS-AI-CONFIDENCE-SCORE "%".
           DISPLAY "AI ANOMALY SCORE : " WS-AI-ANOMALY-SCORE "%".
           DISPLAY "AI INSIGHTS      : " WS-AI-INSIGHTS.
           DISPLAY "ANOMALY FLAG     : " WS-ANOMALY-FLAG.
           DISPLAY "--------------------------------------------------".
           DISPLAY MSG-AUDIT-COMPLETE.
           DISPLAY "=".

       LOG-AUDIT-EVENT.
           * In a production environment, this would write a detailed log
           * entry to a secure, immutable audit log file or database,
           * ensuring a complete record of all audit activities and AI insights.
           DISPLAY "AI ASSISTANT: Logging audit event for ID " WS-TR-ID " at "
               WS-CURRENT-DATE(1:4) "/" WS-CURRENT-DATE(5:2) "/" WS-CURRENT-DATE(7:2) " "
               WS-CURRENT-TIME(1:2) ":" WS-CURRENT-TIME(3:2) ":" WS-CURRENT-TIME(5:2).
           * Example log entry (simplified for display)
           DISPLAY "LOG: AUDIT;ID=" WS-TR-ID ";STATUS=" WS-AUDIT-STATUS
                   ";AI-CONF=" WS-AI-CONFIDENCE-SCORE ";AI-ANOMALY=" WS-AI-ANOMALY-SCORE
                   ";ANOMALY-FLAG=" WS-ANOMALY-FLAG ";INSIGHTS=" WS-AI-INSIGHTS.

       TERMINATE-PROGRAM.
           DISPLAY "AI ASSISTANT: Audit process completed. Thank you.".
           STOP RUN.
```